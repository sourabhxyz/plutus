<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Scoped</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>Scoped</h1>
    <section>
      <pre class="Agda"><a id="40" class="Keyword">module</a> <a id="47" href="Scoped.html" class="Module">Scoped</a> <a id="54" class="Keyword">where</a>
</pre>
<pre class="Agda"><a id="69" class="Keyword">open</a> <a id="74" class="Keyword">import</a> <a id="81" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="90" class="Keyword">using</a> <a id="96" class="Symbol">(</a><a id="97" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="98" class="Symbol">;</a><a id="99" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="103" class="Symbol">;</a><a id="104" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="107" class="Symbol">;</a><a id="108" href="Data.Nat.Base.html#3546" class="Function Operator">∣_-_∣</a><a id="113" class="Symbol">)</a>
<a id="115" class="Keyword">open</a> <a id="120" class="Keyword">import</a> <a id="127" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="136" class="Keyword">using</a> <a id="142" class="Symbol">(</a><a id="143" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a><a id="146" class="Symbol">;</a><a id="147" href="Data.Fin.Base.html#1157" class="InductiveConstructor">zero</a><a id="151" class="Symbol">;</a><a id="152" href="Data.Fin.Base.html#1188" class="InductiveConstructor">suc</a><a id="155" class="Symbol">;</a><a id="156" href="Data.Fin.Base.html#1261" class="Function">toℕ</a><a id="159" class="Symbol">)</a> 
<a id="162" class="Keyword">open</a> <a id="167" class="Keyword">import</a> <a id="174" href="Data.Integer.Show.html" class="Module">Data.Integer.Show</a> <a id="192" class="Keyword">using</a> <a id="198" class="Symbol">()</a> <a id="201" class="Keyword">renaming</a> <a id="210" class="Symbol">(</a><a id="211" href="Data.Integer.Show.html#615" class="Function">show</a> <a id="216" class="Symbol">to</a> <a id="219" class="Function">ishow</a><a id="224" class="Symbol">)</a>
<a id="226" class="Keyword">open</a> <a id="231" class="Keyword">import</a> <a id="238" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="247" class="Keyword">using</a> <a id="253" class="Symbol">(</a><a id="254" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a><a id="257" class="Symbol">;</a><a id="258" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a><a id="260" class="Symbol">;</a><a id="261" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">_∷_</a><a id="264" class="Symbol">)</a>
<a id="266" class="Keyword">open</a> <a id="271" class="Keyword">import</a> <a id="278" href="Data.Bool.html" class="Module">Data.Bool</a> <a id="288" class="Keyword">using</a> <a id="294" class="Symbol">(</a><a id="295" href="Agda.Builtin.Bool.html#173" class="Datatype">Bool</a><a id="299" class="Symbol">)</a>
<a id="301" class="Keyword">open</a> <a id="306" class="Keyword">import</a> <a id="313" href="Data.Product.html" class="Module">Data.Product</a> <a id="326" class="Keyword">using</a> <a id="332" class="Symbol">(</a><a id="333" href="Data.Product.html#1176" class="Function Operator">_×_</a><a id="336" class="Symbol">;</a><a id="337" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="340" class="Symbol">)</a>
<a id="342" class="Keyword">open</a> <a id="347" class="Keyword">import</a> <a id="354" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="392" class="Keyword">using</a> <a id="398" class="Symbol">(</a><a id="399" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="402" class="Symbol">;</a><a id="403" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="407" class="Symbol">)</a>
<a id="409" class="Keyword">open</a> <a id="414" class="Keyword">import</a> <a id="421" href="Data.Sum.html" class="Module">Data.Sum</a> <a id="430" class="Keyword">using</a> <a id="436" class="Symbol">(</a><a id="437" href="Data.Sum.Base.html#743" class="Datatype Operator">_⊎_</a><a id="440" class="Symbol">;</a><a id="441" href="Data.Sum.Base.html#793" class="InductiveConstructor">inj₁</a><a id="445" class="Symbol">)</a>
<a id="447" class="Keyword">open</a> <a id="452" class="Keyword">import</a> <a id="459" href="Data.String.html" class="Module">Data.String</a> <a id="471" class="Keyword">using</a> <a id="477" class="Symbol">(</a><a id="478" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="484" class="Symbol">;</a><a id="485" href="Data.String.Base.html#2375" class="Function Operator">_++_</a><a id="489" class="Symbol">)</a>

<a id="492" class="Keyword">open</a> <a id="497" class="Keyword">import</a> <a id="504" href="Builtin.html" class="Module">Builtin</a> <a id="512" class="Keyword">using</a> <a id="518" class="Symbol">(</a><a id="519" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="526" class="Symbol">)</a>
<a id="528" class="Keyword">open</a> <a id="533" href="Builtin.html#1212" class="Module">Builtin.Builtin</a>

<a id="550" class="Keyword">open</a> <a id="555" class="Keyword">import</a> <a id="562" href="Builtin.Signature.html" class="Module">Builtin.Signature</a> <a id="580" class="Keyword">using</a> <a id="586" class="Symbol">(</a><a id="587" href="Builtin.Signature.html#1830" class="Datatype Operator">_⊢♯</a><a id="590" class="Symbol">;</a><a id="591" href="Builtin.Signature.html#2533" class="InductiveConstructor">integer</a><a id="598" class="Symbol">;</a><a id="599" href="Builtin.Signature.html#2580" class="InductiveConstructor">bytestring</a><a id="609" class="Symbol">)</a> 
<a id="612" class="Keyword">open</a> <a id="617" class="Keyword">import</a> <a id="624" href="Builtin.Constant.Type.html" class="Module">Builtin.Constant.Type</a>
<a id="646" class="Keyword">open</a> <a id="651" class="Keyword">import</a> <a id="658" href="Builtin.Constant.AtomicType.html" class="Module">Builtin.Constant.AtomicType</a> <a id="686" class="Keyword">using</a> <a id="692" class="Symbol">(</a><a id="693" href="Builtin.Constant.AtomicType.html#751" class="InductiveConstructor">aBool</a><a id="698" class="Symbol">)</a>

<a id="701" class="Keyword">open</a> <a id="706" class="Keyword">import</a> <a id="713" href="Raw.html" class="Module">Raw</a> <a id="717" class="Keyword">using</a> <a id="723" class="Symbol">(</a><a id="724" href="Raw.html#810" class="Datatype">RawTy</a><a id="729" class="Symbol">;</a><a id="730" href="Raw.html#1435" class="Datatype">RawTm</a><a id="735" class="Symbol">;</a><a id="736" href="Raw.html#828" class="Datatype">RawTyCon</a><a id="744" class="Symbol">)</a>
<a id="746" class="Keyword">open</a> <a id="751" href="Raw.html#810" class="Module">RawTy</a>
<a id="757" class="Keyword">open</a> <a id="762" href="Raw.html#1435" class="Module">RawTm</a>
<a id="768" class="Keyword">open</a> <a id="773" href="Raw.html#828" class="Module">RawTyCon</a>

<a id="783" class="Keyword">open</a> <a id="788" class="Keyword">import</a> <a id="795" href="Utils.html" class="Module">Utils</a> <a id="801" class="Keyword">using</a> <a id="807" class="Symbol">(</a><a id="808" href="Utils.html#6802" class="Datatype">Kind</a><a id="812" class="Symbol">;</a><a id="813" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="818" class="Symbol">;</a><a id="819" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="826" class="Symbol">;</a><a id="827" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="831" class="Symbol">;</a><a id="832" href="Data.Maybe.Base.html#1371" class="Function">maybe</a><a id="837" class="Symbol">;</a><a id="838" href="Utils.html#2866" class="Record">Monad</a><a id="843" class="Symbol">;</a><a id="844" href="Utils.html#1126" class="Datatype">Either</a><a id="850" class="Symbol">;</a><a id="851" href="Utils.html#1159" class="InductiveConstructor">inj₁</a><a id="855" class="Symbol">;</a><a id="856" href="Utils.html#1183" class="InductiveConstructor">inj₂</a><a id="860" class="Symbol">;</a><a id="861" href="Utils.html#4983" class="Datatype">List</a><a id="865" class="Symbol">;</a><a id="866" href="Utils.html#5012" class="InductiveConstructor">[]</a><a id="868" class="Symbol">;</a><a id="869" href="Utils.html#5027" class="InductiveConstructor Operator">_∷_</a><a id="872" class="Symbol">)</a>
<a id="874" class="Keyword">open</a> <a id="879" href="Utils.html#2866" class="Module">Monad</a><a id="884" class="Symbol"></a>

<a id="893" class="Keyword">open</a> <a id="898" class="Keyword">import</a> <a id="905" href="RawU.html" class="Module">RawU</a> <a id="910" class="Keyword">using</a> <a id="916" class="Symbol">(</a><a id="917" href="RawU.html#6799" class="Function">TyTag</a><a id="922" class="Symbol">;</a><a id="923" href="RawU.html#7639" class="Datatype">TmCon</a><a id="928" class="Symbol">;</a><a id="929" href="RawU.html#7660" class="InductiveConstructor">tmCon</a><a id="934" class="Symbol">;</a><a id="935" href="RawU.html#8841" class="Function">tagCon2TmCon</a><a id="947" class="Symbol">;</a><a id="948" href="RawU.html#10943" class="Function">tmCon2TagCon</a><a id="960" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="971" class="Keyword">data</a> <a id="ScopedTy"></a><a id="976" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="985" class="Symbol">(</a><a id="986" href="Scoped.html#986" class="Bound">n</a> <a id="988" class="Symbol">:</a> <a id="990" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="991" class="Symbol">)</a> <a id="993" class="Symbol">:</a> <a id="995" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="999" class="Keyword">where</a>
  <a id="ScopedTy.`"></a><a id="1007" href="Scoped.html#1007" class="InductiveConstructor">`</a>    <a id="1012" class="Symbol">:</a> <a id="1014" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="1018" href="Scoped.html#986" class="Bound">n</a> <a id="1020" class="Symbol">→</a> <a id="1022" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1031" href="Scoped.html#986" class="Bound">n</a>
  <a id="ScopedTy._⇒_"></a><a id="1035" href="Scoped.html#1035" class="InductiveConstructor Operator">_⇒_</a>  <a id="1040" class="Symbol">:</a> <a id="1042" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1051" href="Scoped.html#986" class="Bound">n</a> <a id="1053" class="Symbol">→</a> <a id="1055" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1064" href="Scoped.html#986" class="Bound">n</a> <a id="1066" class="Symbol">→</a> <a id="1068" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1077" href="Scoped.html#986" class="Bound">n</a>
  <a id="ScopedTy.Π"></a><a id="1081" href="Scoped.html#1081" class="InductiveConstructor">Π</a>    <a id="1086" class="Symbol">:</a> <a id="1088" href="Utils.html#6802" class="Datatype">Kind</a> <a id="1093" class="Symbol">→</a> <a id="1095" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1104" class="Symbol">(</a><a id="1105" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1109" href="Scoped.html#986" class="Bound">n</a><a id="1110" class="Symbol">)</a> <a id="1112" class="Symbol">→</a> <a id="1114" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1123" href="Scoped.html#986" class="Bound">n</a>
  <a id="ScopedTy.ƛ"></a><a id="1127" href="Scoped.html#1127" class="InductiveConstructor">ƛ</a>    <a id="1132" class="Symbol">:</a> <a id="1134" href="Utils.html#6802" class="Datatype">Kind</a> <a id="1139" class="Symbol">→</a> <a id="1141" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1150" class="Symbol">(</a><a id="1151" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1155" href="Scoped.html#986" class="Bound">n</a><a id="1156" class="Symbol">)</a> <a id="1158" class="Symbol">→</a> <a id="1160" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1169" href="Scoped.html#986" class="Bound">n</a>
  <a id="ScopedTy._·_"></a><a id="1173" href="Scoped.html#1173" class="InductiveConstructor Operator">_·_</a>  <a id="1178" class="Symbol">:</a> <a id="1180" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1189" href="Scoped.html#986" class="Bound">n</a> <a id="1191" class="Symbol">→</a> <a id="1193" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1202" href="Scoped.html#986" class="Bound">n</a> <a id="1204" class="Symbol">→</a> <a id="1206" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1215" href="Scoped.html#986" class="Bound">n</a>
  <a id="ScopedTy.con"></a><a id="1219" href="Scoped.html#1219" class="InductiveConstructor">con</a>  <a id="1224" class="Symbol">:</a> <a id="1226" class="Symbol">∀{</a><a id="1228" href="Scoped.html#1228" class="Bound">K</a><a id="1229" class="Symbol">}</a> <a id="1231" class="Symbol">→</a> <a id="1233" href="Builtin.Constant.Type.html#858" class="Datatype">TyCon</a> <a id="1239" href="Scoped.html#1228" class="Bound">K</a> <a id="1241" class="Symbol">→</a> <a id="1243" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1252" href="Scoped.html#986" class="Bound">n</a>
  <a id="ScopedTy.μ"></a><a id="1256" href="Scoped.html#1256" class="InductiveConstructor">μ</a>    <a id="1261" class="Symbol">:</a> <a id="1263" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1272" href="Scoped.html#986" class="Bound">n</a> <a id="1274" class="Symbol">→</a> <a id="1276" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1285" href="Scoped.html#986" class="Bound">n</a> <a id="1287" class="Symbol">→</a> <a id="1289" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1298" href="Scoped.html#986" class="Bound">n</a>
  <a id="ScopedTy.SOP"></a><a id="1302" href="Scoped.html#1302" class="InductiveConstructor">SOP</a>  <a id="1307" class="Symbol">:</a> <a id="1309" href="Utils.html#4983" class="Datatype">List</a> <a id="1314" class="Symbol">(</a><a id="1315" href="Utils.html#4983" class="Datatype">List</a> <a id="1320" class="Symbol">(</a><a id="1321" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1330" href="Scoped.html#986" class="Bound">n</a><a id="1331" class="Symbol">))</a> <a id="1334" class="Symbol">→</a> <a id="1336" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1345" href="Scoped.html#986" class="Bound">n</a>

<a id="Tel⋆"></a><a id="1348" href="Scoped.html#1348" class="Function">Tel⋆</a> <a id="1353" class="Symbol">:</a> <a id="1355" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1357" class="Symbol">→</a> <a id="1359" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1361" class="Symbol">→</a> <a id="1363" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1367" href="Scoped.html#1348" class="Function">Tel⋆</a> <a id="1372" href="Scoped.html#1372" class="Bound">n</a> <a id="1374" href="Scoped.html#1374" class="Bound">m</a> <a id="1376" class="Symbol">=</a> <a id="1378" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="1382" class="Symbol">(</a><a id="1383" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="1392" href="Scoped.html#1372" class="Bound">n</a><a id="1393" class="Symbol">)</a> <a id="1395" href="Scoped.html#1374" class="Bound">m</a>

<a id="1398" class="Comment">-- contexts</a>

<a id="1411" class="Keyword">data</a> <a id="Weirdℕ"></a><a id="1416" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1423" class="Symbol">:</a> <a id="1425" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1427" class="Symbol">→</a> <a id="1429" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1433" class="Keyword">where</a>
  <a id="Weirdℕ.Z"></a><a id="1441" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="1443" class="Symbol">:</a> <a id="1445" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1452" class="Number">0</a>
  <a id="Weirdℕ.S"></a><a id="1456" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="1458" class="Symbol">:</a> <a id="1460" class="Symbol">∀{</a><a id="1462" href="Scoped.html#1462" class="Bound">n</a><a id="1463" class="Symbol">}</a> <a id="1465" class="Symbol">→</a> <a id="1467" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1474" href="Scoped.html#1462" class="Bound">n</a>  <a id="1477" class="Symbol">→</a> <a id="1479" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1486" href="Scoped.html#1462" class="Bound">n</a>
  <a id="Weirdℕ.T"></a><a id="1490" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="1492" class="Symbol">:</a> <a id="1494" class="Symbol">∀{</a><a id="1496" href="Scoped.html#1496" class="Bound">n</a><a id="1497" class="Symbol">}</a> <a id="1499" class="Symbol">→</a> <a id="1501" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1508" href="Scoped.html#1496" class="Bound">n</a> <a id="1510" class="Symbol">→</a> <a id="1512" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1519" class="Symbol">(</a><a id="1520" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1524" href="Scoped.html#1496" class="Bound">n</a><a id="1525" class="Symbol">)</a>

<a id="1528" class="Comment">-- variables</a>

<a id="1542" class="Keyword">data</a> <a id="WeirdFin"></a><a id="1547" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="1556" class="Symbol">:</a> <a id="1558" class="Symbol">∀{</a><a id="1560" href="Scoped.html#1560" class="Bound">n</a><a id="1561" class="Symbol">}</a> <a id="1563" class="Symbol">→</a> <a id="1565" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1572" href="Scoped.html#1560" class="Bound">n</a> <a id="1574" class="Symbol">→</a> <a id="1576" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1580" class="Keyword">where</a>
  <a id="WeirdFin.Z"></a><a id="1588" href="Scoped.html#1588" class="InductiveConstructor">Z</a> <a id="1590" class="Symbol">:</a> <a id="1592" class="Symbol">∀{</a><a id="1594" href="Scoped.html#1594" class="Bound">n</a><a id="1595" class="Symbol">}{</a><a id="1597" href="Scoped.html#1597" class="Bound">w</a> <a id="1599" class="Symbol">:</a> <a id="1601" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1608" href="Scoped.html#1594" class="Bound">n</a><a id="1609" class="Symbol">}</a> <a id="1611" class="Symbol">→</a> <a id="1613" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="1622" class="Symbol">(</a><a id="1623" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="1625" href="Scoped.html#1597" class="Bound">w</a><a id="1626" class="Symbol">)</a>
  <a id="WeirdFin.S"></a><a id="1630" href="Scoped.html#1630" class="InductiveConstructor">S</a> <a id="1632" class="Symbol">:</a> <a id="1634" class="Symbol">∀{</a><a id="1636" href="Scoped.html#1636" class="Bound">n</a><a id="1637" class="Symbol">}{</a><a id="1639" href="Scoped.html#1639" class="Bound">w</a> <a id="1641" class="Symbol">:</a> <a id="1643" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1650" href="Scoped.html#1636" class="Bound">n</a><a id="1651" class="Symbol">}</a> <a id="1653" class="Symbol">→</a> <a id="1655" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="1664" href="Scoped.html#1639" class="Bound">w</a> <a id="1666" class="Symbol">→</a> <a id="1668" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="1677" class="Symbol">(</a><a id="1678" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="1680" href="Scoped.html#1639" class="Bound">w</a><a id="1681" class="Symbol">)</a>
  <a id="WeirdFin.T"></a><a id="1685" href="Scoped.html#1685" class="InductiveConstructor">T</a> <a id="1687" class="Symbol">:</a> <a id="1689" class="Symbol">∀{</a><a id="1691" href="Scoped.html#1691" class="Bound">n</a><a id="1692" class="Symbol">}{</a><a id="1694" href="Scoped.html#1694" class="Bound">w</a> <a id="1696" class="Symbol">:</a> <a id="1698" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1705" href="Scoped.html#1691" class="Bound">n</a><a id="1706" class="Symbol">}</a> <a id="1708" class="Symbol">→</a> <a id="1710" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="1719" href="Scoped.html#1694" class="Bound">w</a> <a id="1721" class="Symbol">→</a> <a id="1723" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="1732" class="Symbol">(</a><a id="1733" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="1735" href="Scoped.html#1694" class="Bound">w</a><a id="1736" class="Symbol">)</a>


<a id="1740" class="Comment">-- what is this for?</a>
<a id="1761" class="Comment">-- there are two meaningful things here:</a>
<a id="1802" class="Comment">-- 1. one to literally convert the number</a>
<a id="1844" class="Comment">-- 2. to extract a type context from a term one</a>
<a id="1892" class="Comment">-- this looks like (1)</a>

<a id="wtoℕ"></a><a id="1916" href="Scoped.html#1916" class="Function">wtoℕ</a> <a id="1921" class="Symbol">:</a> <a id="1923" class="Symbol">∀{</a><a id="1925" href="Scoped.html#1925" class="Bound">n</a><a id="1926" class="Symbol">}</a> <a id="1928" class="Symbol">→</a> <a id="1930" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="1937" href="Scoped.html#1925" class="Bound">n</a> <a id="1939" class="Symbol">→</a> <a id="1941" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="1943" href="Scoped.html#1916" class="Function">wtoℕ</a> <a id="1948" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="1950" class="Symbol">=</a> <a id="1952" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>
<a id="1957" href="Scoped.html#1916" class="Function">wtoℕ</a> <a id="1962" class="Symbol">(</a><a id="1963" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="1965" href="Scoped.html#1965" class="Bound">x</a><a id="1966" class="Symbol">)</a> <a id="1968" class="Symbol">=</a> <a id="1970" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1974" class="Symbol">(</a><a id="1975" href="Scoped.html#1916" class="Function">wtoℕ</a> <a id="1980" href="Scoped.html#1965" class="Bound">x</a><a id="1981" class="Symbol">)</a>
<a id="1983" href="Scoped.html#1916" class="Function">wtoℕ</a> <a id="1988" class="Symbol">(</a><a id="1989" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="1991" href="Scoped.html#1991" class="Bound">x</a><a id="1992" class="Symbol">)</a> <a id="1994" class="Symbol">=</a> <a id="1996" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2000" class="Symbol">(</a><a id="2001" href="Scoped.html#1916" class="Function">wtoℕ</a> <a id="2006" href="Scoped.html#1991" class="Bound">x</a><a id="2007" class="Symbol">)</a>

<a id="WeirdFintoℕ"></a><a id="2010" href="Scoped.html#2010" class="Function">WeirdFintoℕ</a> <a id="2022" class="Symbol">:</a> <a id="2024" class="Symbol">∀{</a><a id="2026" href="Scoped.html#2026" class="Bound">n</a><a id="2027" class="Symbol">}{</a><a id="2029" href="Scoped.html#2029" class="Bound">w</a> <a id="2031" class="Symbol">:</a> <a id="2033" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="2040" href="Scoped.html#2026" class="Bound">n</a><a id="2041" class="Symbol">}</a> <a id="2043" class="Symbol">→</a> <a id="2045" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="2054" href="Scoped.html#2029" class="Bound">w</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2060" href="Scoped.html#2010" class="Function">WeirdFintoℕ</a> <a id="2072" href="Scoped.html#1588" class="InductiveConstructor">Z</a>     <a id="2078" class="Symbol">=</a> <a id="2080" class="Number">0</a>
<a id="2082" href="Scoped.html#2010" class="Function">WeirdFintoℕ</a> <a id="2094" class="Symbol">(</a><a id="2095" href="Scoped.html#1630" class="InductiveConstructor">S</a> <a id="2097" href="Scoped.html#2097" class="Bound">i</a><a id="2098" class="Symbol">)</a> <a id="2100" class="Symbol">=</a> <a id="2102" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2106" class="Symbol">(</a><a id="2107" href="Scoped.html#2010" class="Function">WeirdFintoℕ</a> <a id="2119" href="Scoped.html#2097" class="Bound">i</a><a id="2120" class="Symbol">)</a>
<a id="2122" href="Scoped.html#2010" class="Function">WeirdFintoℕ</a> <a id="2134" class="Symbol">(</a><a id="2135" href="Scoped.html#1685" class="InductiveConstructor">T</a> <a id="2137" href="Scoped.html#2137" class="Bound">i</a><a id="2138" class="Symbol">)</a> <a id="2140" class="Symbol">=</a> <a id="2142" href="Scoped.html#2010" class="Function">WeirdFintoℕ</a> <a id="2154" href="Scoped.html#2137" class="Bound">i</a>

<a id="2157" class="Comment">-- extract number of term binders we are under</a>
<a id="wtoℕTm"></a><a id="2204" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2211" class="Symbol">:</a> <a id="2213" class="Symbol">∀{</a><a id="2215" href="Scoped.html#2215" class="Bound">n</a><a id="2216" class="Symbol">}</a> <a id="2218" class="Symbol">→</a> <a id="2220" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="2227" href="Scoped.html#2215" class="Bound">n</a> <a id="2229" class="Symbol">→</a> <a id="2231" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2233" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2240" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="2242" class="Symbol">=</a> <a id="2244" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>
<a id="2249" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2256" class="Symbol">(</a><a id="2257" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="2259" href="Scoped.html#2259" class="Bound">x</a><a id="2260" class="Symbol">)</a> <a id="2262" class="Symbol">=</a> <a id="2264" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2268" class="Symbol">(</a><a id="2269" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2276" href="Scoped.html#2259" class="Bound">x</a><a id="2277" class="Symbol">)</a>
<a id="2279" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2286" class="Symbol">(</a><a id="2287" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="2289" href="Scoped.html#2289" class="Bound">x</a><a id="2290" class="Symbol">)</a> <a id="2292" class="Symbol">=</a> <a id="2294" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2301" href="Scoped.html#2289" class="Bound">x</a>

<a id="wtoℕTy"></a><a id="2304" href="Scoped.html#2304" class="Function">wtoℕTy</a> <a id="2311" class="Symbol">:</a> <a id="2313" class="Symbol">∀{</a><a id="2315" href="Scoped.html#2315" class="Bound">n</a><a id="2316" class="Symbol">}</a> <a id="2318" class="Symbol">→</a> <a id="2320" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="2327" href="Scoped.html#2315" class="Bound">n</a> <a id="2329" class="Symbol">→</a> <a id="2331" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2333" href="Scoped.html#2304" class="Function">wtoℕTy</a> <a id="2340" href="Scoped.html#1441" class="InductiveConstructor">Z</a>     <a id="2346" class="Symbol">=</a> <a id="2348" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>
<a id="2353" href="Scoped.html#2304" class="Function">wtoℕTy</a> <a id="2360" class="Symbol">(</a><a id="2361" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="2363" href="Scoped.html#2363" class="Bound">x</a><a id="2364" class="Symbol">)</a> <a id="2366" class="Symbol">=</a> <a id="2368" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2375" href="Scoped.html#2363" class="Bound">x</a>
<a id="2377" href="Scoped.html#2304" class="Function">wtoℕTy</a> <a id="2384" class="Symbol">(</a><a id="2385" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="2387" href="Scoped.html#2387" class="Bound">x</a><a id="2388" class="Symbol">)</a> <a id="2390" class="Symbol">=</a> <a id="2392" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2396" class="Symbol">(</a><a id="2397" href="Scoped.html#2204" class="Function">wtoℕTm</a> <a id="2404" href="Scoped.html#2387" class="Bound">x</a><a id="2405" class="Symbol">)</a>


<a id="2409" class="Comment">-- extract the number of type binders</a>

<a id="lookupWTm"></a><a id="2448" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2458" class="Symbol">:</a> <a id="2460" class="Symbol">∀(</a><a id="2462" href="Scoped.html#2462" class="Bound">x</a> <a id="2464" class="Symbol">:</a> <a id="2466" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2467" class="Symbol">){</a><a id="2469" href="Scoped.html#2469" class="Bound">n</a><a id="2470" class="Symbol">}(</a><a id="2472" href="Scoped.html#2472" class="Bound">w</a> <a id="2474" class="Symbol">:</a> <a id="2476" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="2483" href="Scoped.html#2469" class="Bound">n</a><a id="2484" class="Symbol">)</a> <a id="2486" class="Symbol">→</a> <a id="2488" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2494" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2496" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2506" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="2511" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="2513" class="Symbol">=</a> <a id="2515" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2523" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2533" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="2538" class="Symbol">(</a><a id="2539" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="2541" href="Scoped.html#2541" class="Bound">w</a><a id="2542" class="Symbol">)</a> <a id="2544" class="Symbol">=</a> <a id="2546" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2551" class="Number">0</a>
<a id="2553" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2563" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="2568" class="Symbol">(</a><a id="2569" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="2571" href="Scoped.html#2571" class="Bound">w</a><a id="2572" class="Symbol">)</a> <a id="2574" class="Symbol">=</a> <a id="2576" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2584" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2594" class="Symbol">(</a><a id="2595" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2599" href="Scoped.html#2599" class="Bound">x</a><a id="2600" class="Symbol">)</a> <a id="2602" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="2604" class="Symbol">=</a> <a id="2606" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2614" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2624" class="Symbol">(</a><a id="2625" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2629" href="Scoped.html#2629" class="Bound">x</a><a id="2630" class="Symbol">)</a> <a id="2632" class="Symbol">(</a><a id="2633" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="2635" href="Scoped.html#2635" class="Bound">w</a><a id="2636" class="Symbol">)</a> <a id="2638" class="Symbol">=</a> <a id="2640" href="Utils.html#3049" class="Function">fmap</a> <a id="2645" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2649" class="Symbol">(</a><a id="2650" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2660" href="Scoped.html#2629" class="Bound">x</a> <a id="2662" href="Scoped.html#2635" class="Bound">w</a><a id="2663" class="Symbol">)</a>
<a id="2665" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2675" class="Symbol">(</a><a id="2676" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2680" href="Scoped.html#2680" class="Bound">x</a><a id="2681" class="Symbol">)</a> <a id="2683" class="Symbol">(</a><a id="2684" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="2686" href="Scoped.html#2686" class="Bound">w</a><a id="2687" class="Symbol">)</a> <a id="2689" class="Symbol">=</a> <a id="2691" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="2701" href="Scoped.html#2680" class="Bound">x</a> <a id="2703" href="Scoped.html#2686" class="Bound">w</a>

<a id="lookupWTy"></a><a id="2706" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2716" class="Symbol">:</a> <a id="2718" class="Symbol">∀(</a><a id="2720" href="Scoped.html#2720" class="Bound">x</a> <a id="2722" class="Symbol">:</a> <a id="2724" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2725" class="Symbol">){</a><a id="2727" href="Scoped.html#2727" class="Bound">n</a><a id="2728" class="Symbol">}(</a><a id="2730" href="Scoped.html#2730" class="Bound">w</a> <a id="2732" class="Symbol">:</a> <a id="2734" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="2741" href="Scoped.html#2727" class="Bound">n</a><a id="2742" class="Symbol">)</a> <a id="2744" class="Symbol">→</a> <a id="2746" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2752" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="2754" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2764" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="2769" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="2771" class="Symbol">=</a> <a id="2773" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2781" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2791" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="2796" class="Symbol">(</a><a id="2797" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="2799" href="Scoped.html#2799" class="Bound">w</a><a id="2800" class="Symbol">)</a> <a id="2802" class="Symbol">=</a> <a id="2804" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2812" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2822" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="2827" class="Symbol">(</a><a id="2828" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="2830" href="Scoped.html#2830" class="Bound">w</a><a id="2831" class="Symbol">)</a> <a id="2833" class="Symbol">=</a> <a id="2835" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2840" class="Number">0</a>
<a id="2842" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2852" class="Symbol">(</a><a id="2853" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2857" href="Scoped.html#2857" class="Bound">x</a><a id="2858" class="Symbol">)</a> <a id="2860" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="2862" class="Symbol">=</a> <a id="2864" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
<a id="2872" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2882" class="Symbol">(</a><a id="2883" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2887" href="Scoped.html#2887" class="Bound">x</a><a id="2888" class="Symbol">)</a> <a id="2890" class="Symbol">(</a><a id="2891" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="2893" href="Scoped.html#2893" class="Bound">w</a><a id="2894" class="Symbol">)</a> <a id="2896" class="Symbol">=</a> <a id="2898" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2908" href="Scoped.html#2887" class="Bound">x</a> <a id="2910" href="Scoped.html#2893" class="Bound">w</a>
<a id="2912" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2922" class="Symbol">(</a><a id="2923" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2927" href="Scoped.html#2927" class="Bound">x</a><a id="2928" class="Symbol">)</a> <a id="2930" class="Symbol">(</a><a id="2931" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="2933" href="Scoped.html#2933" class="Bound">w</a><a id="2934" class="Symbol">)</a> <a id="2936" class="Symbol">=</a> <a id="2938" href="Utils.html#3049" class="Function">fmap</a> <a id="2943" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="2947" class="Symbol">(</a><a id="2948" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="2958" href="Scoped.html#2927" class="Bound">x</a> <a id="2960" href="Scoped.html#2933" class="Bound">w</a><a id="2961" class="Symbol">)</a>


<a id="lookupWTm&#39;"></a><a id="2965" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="2976" class="Symbol">:</a> <a id="2978" class="Symbol">∀(</a><a id="2980" href="Scoped.html#2980" class="Bound">x</a> <a id="2982" class="Symbol">:</a> <a id="2984" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="2985" class="Symbol">){</a><a id="2987" href="Scoped.html#2987" class="Bound">n</a><a id="2988" class="Symbol">}</a> <a id="2990" class="Symbol">→</a> <a id="2992" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="2999" href="Scoped.html#2987" class="Bound">n</a> <a id="3001" class="Symbol">→</a> <a id="3003" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="3005" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="3016" href="Scoped.html#3016" class="Bound">i</a> <a id="3018" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="3020" class="Symbol">=</a> <a id="3022" href="Scoped.html#3016" class="Bound">i</a>
<a id="3024" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="3035" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="3040" class="Symbol">(</a><a id="3041" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="3043" href="Scoped.html#3043" class="Bound">w</a><a id="3044" class="Symbol">)</a> <a id="3046" class="Symbol">=</a> <a id="3048" class="Number">1</a>
<a id="3050" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="3061" class="Symbol">(</a><a id="3062" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3066" href="Scoped.html#3066" class="Bound">i</a><a id="3067" class="Symbol">)</a> <a id="3069" class="Symbol">(</a><a id="3070" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="3072" href="Scoped.html#3072" class="Bound">w</a><a id="3073" class="Symbol">)</a> <a id="3075" class="Symbol">=</a> <a id="3077" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3081" class="Symbol">(</a><a id="3082" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="3093" href="Scoped.html#3066" class="Bound">i</a> <a id="3095" href="Scoped.html#3072" class="Bound">w</a><a id="3096" class="Symbol">)</a>
<a id="3098" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="3109" href="Scoped.html#3109" class="Bound">i</a> <a id="3111" class="Symbol">(</a><a id="3112" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="3114" href="Scoped.html#3114" class="Bound">w</a><a id="3115" class="Symbol">)</a> <a id="3117" class="Symbol">=</a> <a id="3119" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3123" class="Symbol">(</a><a id="3124" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="3135" href="Scoped.html#3109" class="Bound">i</a> <a id="3137" href="Scoped.html#3114" class="Bound">w</a><a id="3138" class="Symbol">)</a>
<a id="3140" class="Comment">{-
lookupWTm&#39; x (S m) = lookupWTm&#39; x m
lookupWTm&#39; x (T m) = lookupWTm&#39; (suc x) m
lookupWTm&#39; x Z     = suc x
-}</a>

<a id="lookupWTy&#39;"></a><a id="3252" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="3263" class="Symbol">:</a> <a id="3265" class="Symbol">∀(</a><a id="3267" href="Scoped.html#3267" class="Bound">x</a> <a id="3269" class="Symbol">:</a> <a id="3271" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="3272" class="Symbol">){</a><a id="3274" href="Scoped.html#3274" class="Bound">n</a><a id="3275" class="Symbol">}</a> <a id="3277" class="Symbol">→</a> <a id="3279" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="3286" href="Scoped.html#3274" class="Bound">n</a> <a id="3288" class="Symbol">→</a> <a id="3290" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="3292" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="3303" href="Scoped.html#3303" class="Bound">i</a> <a id="3305" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="3307" class="Symbol">=</a> <a id="3309" href="Scoped.html#3303" class="Bound">i</a>
<a id="3311" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="3322" href="Scoped.html#3322" class="Bound">i</a> <a id="3324" class="Symbol">(</a><a id="3325" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="3327" href="Scoped.html#3327" class="Bound">w</a><a id="3328" class="Symbol">)</a> <a id="3330" class="Symbol">=</a> <a id="3332" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3336" class="Symbol">(</a><a id="3337" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="3348" href="Scoped.html#3322" class="Bound">i</a> <a id="3350" href="Scoped.html#3327" class="Bound">w</a><a id="3351" class="Symbol">)</a>
<a id="3353" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="3364" class="Symbol">(</a><a id="3365" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3369" href="Scoped.html#3369" class="Bound">i</a><a id="3370" class="Symbol">)</a> <a id="3372" class="Symbol">(</a><a id="3373" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="3375" href="Scoped.html#3375" class="Bound">w</a><a id="3376" class="Symbol">)</a> <a id="3378" class="Symbol">=</a> <a id="3380" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="3384" class="Symbol">(</a><a id="3385" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="3396" href="Scoped.html#3369" class="Bound">i</a> <a id="3398" href="Scoped.html#3375" class="Bound">w</a><a id="3399" class="Symbol">)</a>
<a id="3401" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="3412" class="Number">0</a> <a id="3414" class="Symbol">(</a><a id="3415" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="3417" href="Scoped.html#3417" class="Bound">w</a><a id="3418" class="Symbol">)</a> <a id="3420" class="Symbol">=</a> <a id="3422" class="Number">1</a>

<a id="3425" class="Comment">{-
lookupWTy&#39; x (S m) = lookupWTy&#39; (suc x) m
lookupWTy&#39; x (T m) = lookupWTy&#39; x m
lookupWTy&#39; x Z     = suc x
-}</a>

<a id="3537" class="Comment">-- these are renamings</a>
<a id="shifterTy"></a><a id="3560" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3570" class="Symbol">:</a> <a id="3572" class="Symbol">∀{</a><a id="3574" href="Scoped.html#3574" class="Bound">n</a><a id="3575" class="Symbol">}(</a><a id="3577" href="Scoped.html#3577" class="Bound">w</a> <a id="3579" class="Symbol">:</a> <a id="3581" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="3588" href="Scoped.html#3574" class="Bound">n</a><a id="3589" class="Symbol">)</a> <a id="3591" class="Symbol">→</a> <a id="3593" href="Raw.html#810" class="Datatype">RawTy</a> <a id="3599" class="Symbol">→</a> <a id="3601" href="Raw.html#810" class="Datatype">RawTy</a>
<a id="shifterTyList"></a><a id="3607" href="Scoped.html#3607" class="Function">shifterTyList</a> <a id="3621" class="Symbol">:</a> <a id="3623" class="Symbol">∀{</a><a id="3625" href="Scoped.html#3625" class="Bound">n</a><a id="3626" class="Symbol">}(</a><a id="3628" href="Scoped.html#3628" class="Bound">w</a> <a id="3630" class="Symbol">:</a> <a id="3632" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="3639" href="Scoped.html#3625" class="Bound">n</a><a id="3640" class="Symbol">)</a> <a id="3642" class="Symbol">→</a> <a id="3644" href="Utils.html#4983" class="Datatype">List</a> <a id="3649" href="Raw.html#810" class="Datatype">RawTy</a> <a id="3655" class="Symbol">→</a> <a id="3657" href="Utils.html#4983" class="Datatype">List</a> <a id="3662" href="Raw.html#810" class="Datatype">RawTy</a>
<a id="shifterTyListList"></a><a id="3668" href="Scoped.html#3668" class="Function">shifterTyListList</a> <a id="3686" class="Symbol">:</a> <a id="3688" class="Symbol">∀{</a><a id="3690" href="Scoped.html#3690" class="Bound">n</a><a id="3691" class="Symbol">}(</a><a id="3693" href="Scoped.html#3693" class="Bound">w</a> <a id="3695" class="Symbol">:</a> <a id="3697" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="3704" href="Scoped.html#3690" class="Bound">n</a><a id="3705" class="Symbol">)</a> <a id="3707" class="Symbol">→</a> <a id="3709" href="Utils.html#4983" class="Datatype">List</a> <a id="3714" class="Symbol">(</a><a id="3715" href="Utils.html#4983" class="Datatype">List</a> <a id="3720" href="Raw.html#810" class="Datatype">RawTy</a><a id="3725" class="Symbol">)</a> <a id="3727" class="Symbol">→</a> <a id="3729" href="Utils.html#4983" class="Datatype">List</a> <a id="3734" class="Symbol">(</a><a id="3735" href="Utils.html#4983" class="Datatype">List</a> <a id="3740" href="Raw.html#810" class="Datatype">RawTy</a><a id="3745" class="Symbol">)</a>

<a id="3748" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3758" href="Scoped.html#3758" class="Bound">w</a> <a id="3760" class="Symbol">(</a><a id="3761" href="Raw.html#863" class="InductiveConstructor">`</a> <a id="3763" href="Scoped.html#3763" class="Bound">x</a><a id="3764" class="Symbol">)</a>     <a id="3770" class="Symbol">=</a> <a id="3772" href="Raw.html#863" class="InductiveConstructor">`</a> <a id="3774" class="Symbol">(</a><a id="3775" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="3781" class="Symbol">(\</a><a id="3783" href="Scoped.html#3783" class="Bound">x</a> <a id="3785" class="Symbol">→</a> <a id="3787" href="Scoped.html#3783" class="Bound">x</a><a id="3788" class="Symbol">)</a> <a id="3790" class="Number">100</a> <a id="3794" class="Symbol">(</a><a id="3795" href="Scoped.html#2706" class="Function">lookupWTy</a> <a id="3805" href="Data.Nat.Base.html#3546" class="Function Operator">∣</a> <a id="3807" href="Scoped.html#3763" class="Bound">x</a> <a id="3809" href="Data.Nat.Base.html#3546" class="Function Operator">-</a> <a id="3811" class="Number">1</a> <a id="3813" href="Data.Nat.Base.html#3546" class="Function Operator">∣</a>  <a id="3816" href="Scoped.html#3758" class="Bound">w</a><a id="3817" class="Symbol">))</a>
<a id="3820" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3830" href="Scoped.html#3830" class="Bound">w</a> <a id="3832" class="Symbol">(</a><a id="3833" href="Scoped.html#3833" class="Bound">A</a> <a id="3835" href="Raw.html#881" class="InductiveConstructor Operator">⇒</a> <a id="3837" href="Scoped.html#3837" class="Bound">B</a><a id="3838" class="Symbol">)</a>   <a id="3842" class="Symbol">=</a> <a id="3844" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3854" href="Scoped.html#3830" class="Bound">w</a> <a id="3856" href="Scoped.html#3833" class="Bound">A</a> <a id="3858" href="Raw.html#881" class="InductiveConstructor Operator">⇒</a> <a id="3860" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3870" href="Scoped.html#3830" class="Bound">w</a> <a id="3872" href="Scoped.html#3837" class="Bound">B</a>
<a id="3874" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3884" href="Scoped.html#3884" class="Bound">w</a> <a id="3886" class="Symbol">(</a><a id="3887" href="Raw.html#911" class="InductiveConstructor">Π</a> <a id="3889" href="Scoped.html#3889" class="Bound">K</a> <a id="3891" href="Scoped.html#3891" class="Bound">A</a><a id="3892" class="Symbol">)</a>   <a id="3896" class="Symbol">=</a> <a id="3898" href="Raw.html#911" class="InductiveConstructor">Π</a> <a id="3900" href="Scoped.html#3889" class="Bound">K</a> <a id="3902" class="Symbol">(</a><a id="3903" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3913" class="Symbol">(</a><a id="3914" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="3916" href="Scoped.html#3884" class="Bound">w</a><a id="3917" class="Symbol">)</a> <a id="3919" href="Scoped.html#3891" class="Bound">A</a><a id="3920" class="Symbol">)</a>
<a id="3922" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3932" href="Scoped.html#3932" class="Bound">w</a> <a id="3934" class="Symbol">(</a><a id="3935" href="Raw.html#940" class="InductiveConstructor">ƛ</a> <a id="3937" href="Scoped.html#3937" class="Bound">K</a> <a id="3939" href="Scoped.html#3939" class="Bound">A</a><a id="3940" class="Symbol">)</a>   <a id="3944" class="Symbol">=</a> <a id="3946" href="Raw.html#940" class="InductiveConstructor">ƛ</a> <a id="3948" href="Scoped.html#3937" class="Bound">K</a> <a id="3950" class="Symbol">(</a><a id="3951" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3961" class="Symbol">(</a><a id="3962" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="3964" href="Scoped.html#3932" class="Bound">w</a><a id="3965" class="Symbol">)</a> <a id="3967" href="Scoped.html#3939" class="Bound">A</a><a id="3968" class="Symbol">)</a>
<a id="3970" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="3980" href="Scoped.html#3980" class="Bound">w</a> <a id="3982" class="Symbol">(</a><a id="3983" href="Scoped.html#3983" class="Bound">A</a> <a id="3985" href="Raw.html#969" class="InductiveConstructor Operator">·</a> <a id="3987" href="Scoped.html#3987" class="Bound">B</a><a id="3988" class="Symbol">)</a>   <a id="3992" class="Symbol">=</a> <a id="3994" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4004" href="Scoped.html#3980" class="Bound">w</a> <a id="4006" href="Scoped.html#3983" class="Bound">A</a> <a id="4008" href="Raw.html#969" class="InductiveConstructor Operator">·</a> <a id="4010" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4020" href="Scoped.html#3980" class="Bound">w</a> <a id="4022" href="Scoped.html#3987" class="Bound">B</a>
<a id="4024" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4034" href="Scoped.html#4034" class="Bound">w</a> <a id="4036" class="Symbol">(</a><a id="4037" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="4041" href="Scoped.html#4041" class="Bound">c</a><a id="4042" class="Symbol">)</a>   <a id="4046" class="Symbol">=</a> <a id="4048" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="4052" href="Scoped.html#4041" class="Bound">c</a>
<a id="4054" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4064" href="Scoped.html#4064" class="Bound">w</a> <a id="4066" class="Symbol">(</a><a id="4067" href="Raw.html#1024" class="InductiveConstructor">μ</a> <a id="4069" href="Scoped.html#4069" class="Bound">A</a> <a id="4071" href="Scoped.html#4071" class="Bound">B</a><a id="4072" class="Symbol">)</a>   <a id="4076" class="Symbol">=</a> <a id="4078" href="Raw.html#1024" class="InductiveConstructor">μ</a> <a id="4080" class="Symbol">(</a><a id="4081" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4091" href="Scoped.html#4064" class="Bound">w</a> <a id="4093" href="Scoped.html#4069" class="Bound">A</a><a id="4094" class="Symbol">)</a> <a id="4096" class="Symbol">(</a><a id="4097" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4107" href="Scoped.html#4064" class="Bound">w</a> <a id="4109" href="Scoped.html#4071" class="Bound">B</a><a id="4110" class="Symbol">)</a>
<a id="4112" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4122" href="Scoped.html#4122" class="Bound">w</a> <a id="4124" class="Symbol">(</a><a id="4125" href="Raw.html#1054" class="InductiveConstructor">SOP</a> <a id="4129" href="Scoped.html#4129" class="Bound">Tss</a><a id="4132" class="Symbol">)</a> <a id="4134" class="Symbol">=</a> <a id="4136" href="Raw.html#1054" class="InductiveConstructor">SOP</a> <a id="4140" class="Symbol">(</a><a id="4141" href="Scoped.html#3668" class="Function">shifterTyListList</a> <a id="4159" href="Scoped.html#4122" class="Bound">w</a> <a id="4161" href="Scoped.html#4129" class="Bound">Tss</a><a id="4164" class="Symbol">)</a>

<a id="4167" href="Scoped.html#3607" class="Function">shifterTyList</a> <a id="4181" href="Scoped.html#4181" class="Bound">w</a> <a id="4183" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="4186" class="Symbol">=</a> <a id="4188" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="4191" href="Scoped.html#3607" class="Function">shifterTyList</a> <a id="4205" href="Scoped.html#4205" class="Bound">w</a> <a id="4207" class="Symbol">(</a><a id="4208" href="Scoped.html#4208" class="Bound">x</a> <a id="4210" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="4212" href="Scoped.html#4212" class="Bound">xs</a><a id="4214" class="Symbol">)</a> <a id="4216" class="Symbol">=</a> <a id="4218" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4228" href="Scoped.html#4205" class="Bound">w</a> <a id="4230" href="Scoped.html#4208" class="Bound">x</a> <a id="4232" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="4234" href="Scoped.html#3607" class="Function">shifterTyList</a> <a id="4248" href="Scoped.html#4205" class="Bound">w</a> <a id="4250" href="Scoped.html#4212" class="Bound">xs</a>

<a id="4254" href="Scoped.html#3668" class="Function">shifterTyListList</a> <a id="4272" href="Scoped.html#4272" class="Bound">w</a> <a id="4274" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="4277" class="Symbol">=</a> <a id="4279" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="4282" href="Scoped.html#3668" class="Function">shifterTyListList</a> <a id="4300" href="Scoped.html#4300" class="Bound">w</a> <a id="4302" class="Symbol">(</a><a id="4303" href="Scoped.html#4303" class="Bound">xs</a> <a id="4306" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="4308" href="Scoped.html#4308" class="Bound">xss</a><a id="4311" class="Symbol">)</a> <a id="4313" class="Symbol">=</a> <a id="4315" href="Scoped.html#3607" class="Function">shifterTyList</a> <a id="4329" href="Scoped.html#4300" class="Bound">w</a> <a id="4331" href="Scoped.html#4303" class="Bound">xs</a> <a id="4334" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="4336" href="Scoped.html#3668" class="Function">shifterTyListList</a> <a id="4354" href="Scoped.html#4300" class="Bound">w</a> <a id="4356" href="Scoped.html#4308" class="Bound">xss</a>

<a id="shifter"></a><a id="4361" href="Scoped.html#4361" class="Function">shifter</a> <a id="4369" class="Symbol">:</a> <a id="4371" class="Symbol">∀{</a><a id="4373" href="Scoped.html#4373" class="Bound">n</a><a id="4374" class="Symbol">}(</a><a id="4376" href="Scoped.html#4376" class="Bound">w</a> <a id="4378" class="Symbol">:</a> <a id="4380" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="4387" href="Scoped.html#4373" class="Bound">n</a><a id="4388" class="Symbol">)</a> <a id="4390" class="Symbol">→</a> <a id="4392" href="Raw.html#1435" class="Datatype">RawTm</a> <a id="4398" class="Symbol">→</a> <a id="4400" href="Raw.html#1435" class="Datatype">RawTm</a>
<a id="shifterList"></a><a id="4406" href="Scoped.html#4406" class="Function">shifterList</a> <a id="4418" class="Symbol">:</a> <a id="4420" class="Symbol">∀{</a><a id="4422" href="Scoped.html#4422" class="Bound">n</a><a id="4423" class="Symbol">}(</a><a id="4425" href="Scoped.html#4425" class="Bound">w</a> <a id="4427" class="Symbol">:</a> <a id="4429" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="4436" href="Scoped.html#4422" class="Bound">n</a><a id="4437" class="Symbol">)</a> <a id="4439" class="Symbol">→</a> <a id="4441" href="Utils.html#4983" class="Datatype">List</a> <a id="4446" href="Raw.html#1435" class="Datatype">RawTm</a> <a id="4452" class="Symbol">→</a> <a id="4454" href="Utils.html#4983" class="Datatype">List</a> <a id="4459" href="Raw.html#1435" class="Datatype">RawTm</a>

<a id="4466" href="Scoped.html#4361" class="Function">shifter</a> <a id="4474" href="Scoped.html#4474" class="Bound">w</a> <a id="4476" class="Symbol">(</a><a id="4477" href="Raw.html#1455" class="InductiveConstructor">`</a> <a id="4479" href="Scoped.html#4479" class="Bound">x</a><a id="4480" class="Symbol">)</a> <a id="4482" class="Symbol">=</a> <a id="4484" href="Raw.html#1455" class="InductiveConstructor">`</a> <a id="4486" class="Symbol">(</a><a id="4487" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="4493" class="Symbol">(\</a><a id="4495" href="Scoped.html#4495" class="Bound">x</a> <a id="4497" class="Symbol">→</a> <a id="4499" href="Scoped.html#4495" class="Bound">x</a><a id="4500" class="Symbol">)</a> <a id="4502" class="Number">100</a> <a id="4506" class="Symbol">(</a><a id="4507" href="Scoped.html#2448" class="Function">lookupWTm</a> <a id="4517" href="Data.Nat.Base.html#3546" class="Function Operator">∣</a> <a id="4519" href="Scoped.html#4479" class="Bound">x</a> <a id="4521" href="Data.Nat.Base.html#3546" class="Function Operator">-</a> <a id="4523" class="Number">1</a> <a id="4525" href="Data.Nat.Base.html#3546" class="Function Operator">∣</a> <a id="4527" href="Scoped.html#4474" class="Bound">w</a><a id="4528" class="Symbol">))</a>
<a id="4531" href="Scoped.html#4361" class="Function">shifter</a> <a id="4539" href="Scoped.html#4539" class="Bound">w</a> <a id="4541" class="Symbol">(</a><a id="4542" href="Raw.html#1483" class="InductiveConstructor">Λ</a> <a id="4544" href="Scoped.html#4544" class="Bound">K</a> <a id="4546" href="Scoped.html#4546" class="Bound">t</a><a id="4547" class="Symbol">)</a> <a id="4549" class="Symbol">=</a> <a id="4551" href="Raw.html#1483" class="InductiveConstructor">Λ</a> <a id="4553" href="Scoped.html#4544" class="Bound">K</a> <a id="4555" class="Symbol">(</a><a id="4556" href="Scoped.html#4361" class="Function">shifter</a> <a id="4564" class="Symbol">(</a><a id="4565" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="4567" href="Scoped.html#4539" class="Bound">w</a><a id="4568" class="Symbol">)</a> <a id="4570" href="Scoped.html#4546" class="Bound">t</a><a id="4571" class="Symbol">)</a>
<a id="4573" href="Scoped.html#4361" class="Function">shifter</a> <a id="4581" href="Scoped.html#4581" class="Bound">w</a> <a id="4583" class="Symbol">(</a><a id="4584" href="Scoped.html#4584" class="Bound">t</a> <a id="4586" href="Raw.html#1522" class="InductiveConstructor Operator">·⋆</a> <a id="4589" href="Scoped.html#4589" class="Bound">A</a><a id="4590" class="Symbol">)</a> <a id="4592" class="Symbol">=</a> <a id="4594" href="Scoped.html#4361" class="Function">shifter</a> <a id="4602" href="Scoped.html#4581" class="Bound">w</a> <a id="4604" href="Scoped.html#4584" class="Bound">t</a> <a id="4606" href="Raw.html#1522" class="InductiveConstructor Operator">·⋆</a> <a id="4609" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4619" href="Scoped.html#4581" class="Bound">w</a> <a id="4621" href="Scoped.html#4589" class="Bound">A</a>
<a id="4623" href="Scoped.html#4361" class="Function">shifter</a> <a id="4631" href="Scoped.html#4631" class="Bound">w</a> <a id="4633" class="Symbol">(</a><a id="4634" href="Raw.html#1562" class="InductiveConstructor">ƛ</a> <a id="4636" href="Scoped.html#4636" class="Bound">A</a> <a id="4638" href="Scoped.html#4638" class="Bound">t</a><a id="4639" class="Symbol">)</a> <a id="4641" class="Symbol">=</a> <a id="4643" href="Raw.html#1562" class="InductiveConstructor">ƛ</a> <a id="4645" class="Symbol">(</a><a id="4646" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4656" class="Symbol">(</a><a id="4657" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="4659" href="Scoped.html#4631" class="Bound">w</a><a id="4660" class="Symbol">)</a> <a id="4662" href="Scoped.html#4636" class="Bound">A</a><a id="4663" class="Symbol">)</a> <a id="4665" class="Symbol">(</a><a id="4666" href="Scoped.html#4361" class="Function">shifter</a> <a id="4674" class="Symbol">(</a><a id="4675" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="4677" href="Scoped.html#4631" class="Bound">w</a><a id="4678" class="Symbol">)</a> <a id="4680" href="Scoped.html#4638" class="Bound">t</a><a id="4681" class="Symbol">)</a>
<a id="4683" href="Scoped.html#4361" class="Function">shifter</a> <a id="4691" href="Scoped.html#4691" class="Bound">w</a> <a id="4693" class="Symbol">(</a><a id="4694" href="Scoped.html#4694" class="Bound">t</a> <a id="4696" href="Raw.html#1602" class="InductiveConstructor Operator">·</a> <a id="4698" href="Scoped.html#4698" class="Bound">u</a><a id="4699" class="Symbol">)</a> <a id="4701" class="Symbol">=</a> <a id="4703" href="Scoped.html#4361" class="Function">shifter</a> <a id="4711" href="Scoped.html#4691" class="Bound">w</a> <a id="4713" href="Scoped.html#4694" class="Bound">t</a> <a id="4715" href="Raw.html#1602" class="InductiveConstructor Operator">·</a> <a id="4717" href="Scoped.html#4361" class="Function">shifter</a> <a id="4725" href="Scoped.html#4691" class="Bound">w</a> <a id="4727" href="Scoped.html#4698" class="Bound">u</a>
<a id="4729" href="Scoped.html#4361" class="Function">shifter</a> <a id="4737" href="Scoped.html#4737" class="Bound">w</a> <a id="4739" class="Symbol">(</a><a id="4740" href="Raw.html#1642" class="InductiveConstructor">con</a> <a id="4744" href="Scoped.html#4744" class="Bound">c</a><a id="4745" class="Symbol">)</a> <a id="4747" class="Symbol">=</a> <a id="4749" href="Raw.html#1642" class="InductiveConstructor">con</a> <a id="4753" href="Scoped.html#4744" class="Bound">c</a>
<a id="4755" href="Scoped.html#4361" class="Function">shifter</a> <a id="4763" href="Scoped.html#4763" class="Bound">w</a> <a id="4765" class="Symbol">(</a><a id="4766" href="Raw.html#1675" class="InductiveConstructor">error</a> <a id="4772" href="Scoped.html#4772" class="Bound">A</a><a id="4773" class="Symbol">)</a> <a id="4775" class="Symbol">=</a> <a id="4777" href="Raw.html#1675" class="InductiveConstructor">error</a> <a id="4783" class="Symbol">(</a><a id="4784" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4794" href="Scoped.html#4763" class="Bound">w</a> <a id="4796" href="Scoped.html#4772" class="Bound">A</a><a id="4797" class="Symbol">)</a>
<a id="4799" href="Scoped.html#4361" class="Function">shifter</a> <a id="4807" href="Scoped.html#4807" class="Bound">w</a> <a id="4809" class="Symbol">(</a><a id="4810" href="Raw.html#1707" class="InductiveConstructor">builtin</a> <a id="4818" href="Scoped.html#4818" class="Bound">b</a><a id="4819" class="Symbol">)</a> <a id="4821" class="Symbol">=</a> <a id="4823" href="Raw.html#1707" class="InductiveConstructor">builtin</a> <a id="4831" href="Scoped.html#4818" class="Bound">b</a>
<a id="4833" href="Scoped.html#4361" class="Function">shifter</a> <a id="4841" href="Scoped.html#4841" class="Bound">w</a> <a id="4843" class="Symbol">(</a><a id="4844" href="Raw.html#1741" class="InductiveConstructor">wrap</a> <a id="4849" href="Scoped.html#4849" class="Bound">pat</a> <a id="4853" href="Scoped.html#4853" class="Bound">arg</a> <a id="4857" href="Scoped.html#4857" class="Bound">t</a><a id="4858" class="Symbol">)</a> <a id="4860" class="Symbol">=</a>
  <a id="4864" href="Raw.html#1741" class="InductiveConstructor">wrap</a> <a id="4869" class="Symbol">(</a><a id="4870" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4880" href="Scoped.html#4841" class="Bound">w</a> <a id="4882" href="Scoped.html#4849" class="Bound">pat</a><a id="4885" class="Symbol">)</a> <a id="4887" class="Symbol">(</a><a id="4888" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="4898" href="Scoped.html#4841" class="Bound">w</a> <a id="4900" href="Scoped.html#4853" class="Bound">arg</a><a id="4903" class="Symbol">)</a> <a id="4905" class="Symbol">(</a><a id="4906" href="Scoped.html#4361" class="Function">shifter</a> <a id="4914" href="Scoped.html#4841" class="Bound">w</a> <a id="4916" href="Scoped.html#4857" class="Bound">t</a><a id="4917" class="Symbol">)</a>
<a id="4919" href="Scoped.html#4361" class="Function">shifter</a> <a id="4927" href="Scoped.html#4927" class="Bound">w</a> <a id="4929" class="Symbol">(</a><a id="4930" href="Raw.html#1789" class="InductiveConstructor">unwrap</a> <a id="4937" href="Scoped.html#4937" class="Bound">t</a><a id="4938" class="Symbol">)</a> <a id="4940" class="Symbol">=</a> <a id="4942" href="Raw.html#1789" class="InductiveConstructor">unwrap</a> <a id="4949" class="Symbol">(</a><a id="4950" href="Scoped.html#4361" class="Function">shifter</a> <a id="4958" href="Scoped.html#4927" class="Bound">w</a> <a id="4960" href="Scoped.html#4937" class="Bound">t</a><a id="4961" class="Symbol">)</a>
<a id="4963" href="Scoped.html#4361" class="Function">shifter</a> <a id="4971" href="Scoped.html#4971" class="Bound">w</a> <a id="4973" class="Symbol">(</a><a id="4974" href="Raw.html#1821" class="InductiveConstructor">constr</a> <a id="4981" href="Scoped.html#4981" class="Bound">A</a> <a id="4983" href="Scoped.html#4983" class="Bound">i</a> <a id="4985" href="Scoped.html#4985" class="Bound">cs</a><a id="4987" class="Symbol">)</a> <a id="4989" class="Symbol">=</a> <a id="4991" href="Raw.html#1821" class="InductiveConstructor">constr</a> <a id="4998" class="Symbol">(</a><a id="4999" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="5009" href="Scoped.html#4971" class="Bound">w</a> <a id="5011" href="Scoped.html#4981" class="Bound">A</a><a id="5012" class="Symbol">)</a> <a id="5014" href="Scoped.html#4983" class="Bound">i</a> <a id="5016" class="Symbol">(</a><a id="5017" href="Scoped.html#4406" class="Function">shifterList</a> <a id="5029" href="Scoped.html#4971" class="Bound">w</a> <a id="5031" href="Scoped.html#4985" class="Bound">cs</a><a id="5033" class="Symbol">)</a>
<a id="5035" href="Scoped.html#4361" class="Function">shifter</a> <a id="5043" href="Scoped.html#5043" class="Bound">w</a> <a id="5045" class="Symbol">(</a><a id="5046" href="Raw.html#1889" class="InductiveConstructor">case</a> <a id="5051" href="Scoped.html#5051" class="Bound">A</a> <a id="5053" href="Scoped.html#5053" class="Bound">x</a> <a id="5055" href="Scoped.html#5055" class="Bound">cs</a><a id="5057" class="Symbol">)</a> <a id="5059" class="Symbol">=</a> <a id="5061" href="Raw.html#1889" class="InductiveConstructor">case</a> <a id="5066" class="Symbol">(</a><a id="5067" href="Scoped.html#3560" class="Function">shifterTy</a> <a id="5077" href="Scoped.html#5043" class="Bound">w</a> <a id="5079" href="Scoped.html#5051" class="Bound">A</a><a id="5080" class="Symbol">)</a> <a id="5082" class="Symbol">(</a><a id="5083" href="Scoped.html#4361" class="Function">shifter</a> <a id="5091" href="Scoped.html#5043" class="Bound">w</a> <a id="5093" href="Scoped.html#5053" class="Bound">x</a><a id="5094" class="Symbol">)</a> <a id="5096" class="Symbol">(</a><a id="5097" href="Scoped.html#4406" class="Function">shifterList</a> <a id="5109" href="Scoped.html#5043" class="Bound">w</a> <a id="5111" href="Scoped.html#5055" class="Bound">cs</a><a id="5113" class="Symbol">)</a>

<a id="5116" href="Scoped.html#4406" class="Function">shifterList</a> <a id="5128" href="Scoped.html#5128" class="Bound">w</a> <a id="5130" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="5133" class="Symbol">=</a> <a id="5135" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="5138" href="Scoped.html#4406" class="Function">shifterList</a> <a id="5150" href="Scoped.html#5150" class="Bound">w</a> <a id="5152" class="Symbol">(</a><a id="5153" href="Scoped.html#5153" class="Bound">x</a> <a id="5155" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="5157" href="Scoped.html#5157" class="Bound">xs</a><a id="5159" class="Symbol">)</a> <a id="5161" class="Symbol">=</a> <a id="5163" href="Scoped.html#4361" class="Function">shifter</a> <a id="5171" href="Scoped.html#5150" class="Bound">w</a> <a id="5173" href="Scoped.html#5153" class="Bound">x</a> <a id="5175" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="5177" href="Scoped.html#4406" class="Function">shifterList</a> <a id="5189" href="Scoped.html#5150" class="Bound">w</a> <a id="5191" href="Scoped.html#5157" class="Bound">xs</a>

<a id="unshifterTy"></a><a id="5195" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5207" class="Symbol">:</a> <a id="5209" class="Symbol">∀{</a><a id="5211" href="Scoped.html#5211" class="Bound">n</a><a id="5212" class="Symbol">}</a> <a id="5214" class="Symbol">→</a> <a id="5216" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="5223" href="Scoped.html#5211" class="Bound">n</a> <a id="5225" class="Symbol">→</a> <a id="5227" href="Raw.html#810" class="Datatype">RawTy</a> <a id="5233" class="Symbol">→</a> <a id="5235" href="Raw.html#810" class="Datatype">RawTy</a>
<a id="unshifterTyList"></a><a id="5241" href="Scoped.html#5241" class="Function">unshifterTyList</a> <a id="5257" class="Symbol">:</a> <a id="5259" class="Symbol">∀{</a><a id="5261" href="Scoped.html#5261" class="Bound">n</a><a id="5262" class="Symbol">}(</a><a id="5264" href="Scoped.html#5264" class="Bound">w</a> <a id="5266" class="Symbol">:</a> <a id="5268" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="5275" href="Scoped.html#5261" class="Bound">n</a><a id="5276" class="Symbol">)</a> <a id="5278" class="Symbol">→</a> <a id="5280" href="Utils.html#4983" class="Datatype">List</a> <a id="5285" href="Raw.html#810" class="Datatype">RawTy</a> <a id="5291" class="Symbol">→</a> <a id="5293" href="Utils.html#4983" class="Datatype">List</a> <a id="5298" href="Raw.html#810" class="Datatype">RawTy</a>
<a id="unshifterTyListList"></a><a id="5304" href="Scoped.html#5304" class="Function">unshifterTyListList</a> <a id="5324" class="Symbol">:</a> <a id="5326" class="Symbol">∀{</a><a id="5328" href="Scoped.html#5328" class="Bound">n</a><a id="5329" class="Symbol">}(</a><a id="5331" href="Scoped.html#5331" class="Bound">w</a> <a id="5333" class="Symbol">:</a> <a id="5335" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="5342" href="Scoped.html#5328" class="Bound">n</a><a id="5343" class="Symbol">)</a> <a id="5345" class="Symbol">→</a> <a id="5347" href="Utils.html#4983" class="Datatype">List</a> <a id="5352" class="Symbol">(</a><a id="5353" href="Utils.html#4983" class="Datatype">List</a> <a id="5358" href="Raw.html#810" class="Datatype">RawTy</a><a id="5363" class="Symbol">)</a> <a id="5365" class="Symbol">→</a> <a id="5367" href="Utils.html#4983" class="Datatype">List</a> <a id="5372" class="Symbol">(</a><a id="5373" href="Utils.html#4983" class="Datatype">List</a> <a id="5378" href="Raw.html#810" class="Datatype">RawTy</a><a id="5383" class="Symbol">)</a>

<a id="5386" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5398" href="Scoped.html#5398" class="Bound">w</a> <a id="5400" class="Symbol">(</a><a id="5401" href="Raw.html#863" class="InductiveConstructor">`</a> <a id="5403" href="Scoped.html#5403" class="Bound">x</a><a id="5404" class="Symbol">)</a>     <a id="5410" class="Symbol">=</a> <a id="5412" href="Raw.html#863" class="InductiveConstructor">`</a> <a id="5414" class="Symbol">(</a><a id="5415" href="Scoped.html#3252" class="Function">lookupWTy&#39;</a> <a id="5426" href="Scoped.html#5403" class="Bound">x</a> <a id="5428" href="Scoped.html#5398" class="Bound">w</a><a id="5429" class="Symbol">)</a>
<a id="5431" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5443" href="Scoped.html#5443" class="Bound">w</a> <a id="5445" class="Symbol">(</a><a id="5446" href="Scoped.html#5446" class="Bound">A</a> <a id="5448" href="Raw.html#881" class="InductiveConstructor Operator">⇒</a> <a id="5450" href="Scoped.html#5450" class="Bound">B</a><a id="5451" class="Symbol">)</a>   <a id="5455" class="Symbol">=</a> <a id="5457" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5469" href="Scoped.html#5443" class="Bound">w</a> <a id="5471" href="Scoped.html#5446" class="Bound">A</a> <a id="5473" href="Raw.html#881" class="InductiveConstructor Operator">⇒</a> <a id="5475" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5487" href="Scoped.html#5443" class="Bound">w</a> <a id="5489" href="Scoped.html#5450" class="Bound">B</a>
<a id="5491" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5503" href="Scoped.html#5503" class="Bound">w</a> <a id="5505" class="Symbol">(</a><a id="5506" href="Raw.html#911" class="InductiveConstructor">Π</a> <a id="5508" href="Scoped.html#5508" class="Bound">K</a> <a id="5510" href="Scoped.html#5510" class="Bound">A</a><a id="5511" class="Symbol">)</a>   <a id="5515" class="Symbol">=</a> <a id="5517" href="Raw.html#911" class="InductiveConstructor">Π</a> <a id="5519" href="Scoped.html#5508" class="Bound">K</a> <a id="5521" class="Symbol">(</a><a id="5522" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5534" class="Symbol">(</a><a id="5535" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="5537" href="Scoped.html#5503" class="Bound">w</a><a id="5538" class="Symbol">)</a> <a id="5540" href="Scoped.html#5510" class="Bound">A</a><a id="5541" class="Symbol">)</a>
<a id="5543" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5555" href="Scoped.html#5555" class="Bound">w</a> <a id="5557" class="Symbol">(</a><a id="5558" href="Raw.html#940" class="InductiveConstructor">ƛ</a> <a id="5560" href="Scoped.html#5560" class="Bound">K</a> <a id="5562" href="Scoped.html#5562" class="Bound">A</a><a id="5563" class="Symbol">)</a>   <a id="5567" class="Symbol">=</a> <a id="5569" href="Raw.html#940" class="InductiveConstructor">ƛ</a> <a id="5571" href="Scoped.html#5560" class="Bound">K</a> <a id="5573" class="Symbol">(</a><a id="5574" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5586" class="Symbol">(</a><a id="5587" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="5589" href="Scoped.html#5555" class="Bound">w</a><a id="5590" class="Symbol">)</a> <a id="5592" href="Scoped.html#5562" class="Bound">A</a><a id="5593" class="Symbol">)</a>
<a id="5595" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5607" href="Scoped.html#5607" class="Bound">w</a> <a id="5609" class="Symbol">(</a><a id="5610" href="Scoped.html#5610" class="Bound">A</a> <a id="5612" href="Raw.html#969" class="InductiveConstructor Operator">·</a> <a id="5614" href="Scoped.html#5614" class="Bound">B</a><a id="5615" class="Symbol">)</a>   <a id="5619" class="Symbol">=</a> <a id="5621" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5633" href="Scoped.html#5607" class="Bound">w</a> <a id="5635" href="Scoped.html#5610" class="Bound">A</a> <a id="5637" href="Raw.html#969" class="InductiveConstructor Operator">·</a> <a id="5639" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5651" href="Scoped.html#5607" class="Bound">w</a> <a id="5653" href="Scoped.html#5614" class="Bound">B</a>
<a id="5655" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5667" href="Scoped.html#5667" class="Bound">w</a> <a id="5669" class="Symbol">(</a><a id="5670" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="5674" href="Scoped.html#5674" class="Bound">c</a><a id="5675" class="Symbol">)</a>   <a id="5679" class="Symbol">=</a> <a id="5681" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="5685" href="Scoped.html#5674" class="Bound">c</a>
<a id="5687" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5699" href="Scoped.html#5699" class="Bound">w</a> <a id="5701" class="Symbol">(</a><a id="5702" href="Raw.html#1024" class="InductiveConstructor">μ</a> <a id="5704" href="Scoped.html#5704" class="Bound">A</a> <a id="5706" href="Scoped.html#5706" class="Bound">B</a><a id="5707" class="Symbol">)</a>   <a id="5711" class="Symbol">=</a> <a id="5713" href="Raw.html#1024" class="InductiveConstructor">μ</a> <a id="5715" class="Symbol">(</a><a id="5716" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5728" href="Scoped.html#5699" class="Bound">w</a> <a id="5730" href="Scoped.html#5704" class="Bound">A</a><a id="5731" class="Symbol">)</a> <a id="5733" class="Symbol">(</a><a id="5734" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5746" href="Scoped.html#5699" class="Bound">w</a> <a id="5748" href="Scoped.html#5706" class="Bound">B</a><a id="5749" class="Symbol">)</a>
<a id="5751" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5763" href="Scoped.html#5763" class="Bound">w</a> <a id="5765" class="Symbol">(</a><a id="5766" href="Raw.html#1054" class="InductiveConstructor">SOP</a> <a id="5770" href="Scoped.html#5770" class="Bound">Tss</a><a id="5773" class="Symbol">)</a> <a id="5775" class="Symbol">=</a> <a id="5777" href="Raw.html#1054" class="InductiveConstructor">SOP</a> <a id="5781" class="Symbol">(</a><a id="5782" href="Scoped.html#5304" class="Function">unshifterTyListList</a> <a id="5802" href="Scoped.html#5763" class="Bound">w</a> <a id="5804" href="Scoped.html#5770" class="Bound">Tss</a><a id="5807" class="Symbol">)</a>

<a id="5810" href="Scoped.html#5241" class="Function">unshifterTyList</a> <a id="5826" href="Scoped.html#5826" class="Bound">w</a> <a id="5828" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="5831" class="Symbol">=</a> <a id="5833" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="5836" href="Scoped.html#5241" class="Function">unshifterTyList</a> <a id="5852" href="Scoped.html#5852" class="Bound">w</a> <a id="5854" class="Symbol">(</a><a id="5855" href="Scoped.html#5855" class="Bound">x</a> <a id="5857" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="5859" href="Scoped.html#5859" class="Bound">xs</a><a id="5861" class="Symbol">)</a> <a id="5863" class="Symbol">=</a> <a id="5865" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="5877" href="Scoped.html#5852" class="Bound">w</a> <a id="5879" href="Scoped.html#5855" class="Bound">x</a> <a id="5881" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="5883" href="Scoped.html#5241" class="Function">unshifterTyList</a> <a id="5899" href="Scoped.html#5852" class="Bound">w</a> <a id="5901" href="Scoped.html#5859" class="Bound">xs</a>

<a id="5905" href="Scoped.html#5304" class="Function">unshifterTyListList</a> <a id="5925" href="Scoped.html#5925" class="Bound">w</a> <a id="5927" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="5930" class="Symbol">=</a> <a id="5932" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="5935" href="Scoped.html#5304" class="Function">unshifterTyListList</a> <a id="5955" href="Scoped.html#5955" class="Bound">w</a> <a id="5957" class="Symbol">(</a><a id="5958" href="Scoped.html#5958" class="Bound">xs</a> <a id="5961" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="5963" href="Scoped.html#5963" class="Bound">xss</a><a id="5966" class="Symbol">)</a> <a id="5968" class="Symbol">=</a> <a id="5970" href="Scoped.html#5241" class="Function">unshifterTyList</a> <a id="5986" href="Scoped.html#5955" class="Bound">w</a> <a id="5988" href="Scoped.html#5958" class="Bound">xs</a> <a id="5991" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="5993" href="Scoped.html#5304" class="Function">unshifterTyListList</a> <a id="6013" href="Scoped.html#5955" class="Bound">w</a> <a id="6015" href="Scoped.html#5963" class="Bound">xss</a>

<a id="unshifter"></a><a id="6020" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6030" class="Symbol">:</a> <a id="6032" class="Symbol">∀{</a><a id="6034" href="Scoped.html#6034" class="Bound">n</a><a id="6035" class="Symbol">}</a> <a id="6037" class="Symbol">→</a> <a id="6039" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="6046" href="Scoped.html#6034" class="Bound">n</a> <a id="6048" class="Symbol">→</a> <a id="6050" href="Raw.html#1435" class="Datatype">RawTm</a> <a id="6056" class="Symbol">→</a> <a id="6058" href="Raw.html#1435" class="Datatype">RawTm</a>
<a id="unshifterList"></a><a id="6064" href="Scoped.html#6064" class="Function">unshifterList</a> <a id="6078" class="Symbol">:</a> <a id="6080" class="Symbol">∀{</a><a id="6082" href="Scoped.html#6082" class="Bound">n</a><a id="6083" class="Symbol">}(</a><a id="6085" href="Scoped.html#6085" class="Bound">w</a> <a id="6087" class="Symbol">:</a> <a id="6089" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="6096" href="Scoped.html#6082" class="Bound">n</a><a id="6097" class="Symbol">)</a> <a id="6099" class="Symbol">→</a> <a id="6101" href="Utils.html#4983" class="Datatype">List</a> <a id="6106" href="Raw.html#1435" class="Datatype">RawTm</a> <a id="6112" class="Symbol">→</a> <a id="6114" href="Utils.html#4983" class="Datatype">List</a> <a id="6119" href="Raw.html#1435" class="Datatype">RawTm</a>

<a id="6126" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6136" href="Scoped.html#6136" class="Bound">w</a> <a id="6138" class="Symbol">(</a><a id="6139" href="Raw.html#1455" class="InductiveConstructor">`</a> <a id="6141" href="Scoped.html#6141" class="Bound">x</a><a id="6142" class="Symbol">)</a> <a id="6144" class="Symbol">=</a> <a id="6146" href="Raw.html#1455" class="InductiveConstructor">`</a> <a id="6148" class="Symbol">(</a><a id="6149" href="Scoped.html#2965" class="Function">lookupWTm&#39;</a> <a id="6160" href="Scoped.html#6141" class="Bound">x</a> <a id="6162" href="Scoped.html#6136" class="Bound">w</a><a id="6163" class="Symbol">)</a>
<a id="6165" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6175" href="Scoped.html#6175" class="Bound">w</a> <a id="6177" class="Symbol">(</a><a id="6178" href="Raw.html#1483" class="InductiveConstructor">Λ</a> <a id="6180" href="Scoped.html#6180" class="Bound">K</a> <a id="6182" href="Scoped.html#6182" class="Bound">t</a><a id="6183" class="Symbol">)</a> <a id="6185" class="Symbol">=</a> <a id="6187" href="Raw.html#1483" class="InductiveConstructor">Λ</a> <a id="6189" href="Scoped.html#6180" class="Bound">K</a> <a id="6191" class="Symbol">(</a><a id="6192" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6202" class="Symbol">(</a><a id="6203" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="6205" href="Scoped.html#6175" class="Bound">w</a><a id="6206" class="Symbol">)</a> <a id="6208" href="Scoped.html#6182" class="Bound">t</a><a id="6209" class="Symbol">)</a>
<a id="6211" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6221" href="Scoped.html#6221" class="Bound">w</a> <a id="6223" class="Symbol">(</a><a id="6224" href="Scoped.html#6224" class="Bound">t</a> <a id="6226" href="Raw.html#1522" class="InductiveConstructor Operator">·⋆</a> <a id="6229" href="Scoped.html#6229" class="Bound">A</a><a id="6230" class="Symbol">)</a> <a id="6232" class="Symbol">=</a> <a id="6234" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6244" href="Scoped.html#6221" class="Bound">w</a> <a id="6246" href="Scoped.html#6224" class="Bound">t</a> <a id="6248" href="Raw.html#1522" class="InductiveConstructor Operator">·⋆</a> <a id="6251" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="6263" href="Scoped.html#6221" class="Bound">w</a> <a id="6265" href="Scoped.html#6229" class="Bound">A</a>
<a id="6267" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6277" href="Scoped.html#6277" class="Bound">w</a> <a id="6279" class="Symbol">(</a><a id="6280" href="Raw.html#1562" class="InductiveConstructor">ƛ</a> <a id="6282" href="Scoped.html#6282" class="Bound">A</a> <a id="6284" href="Scoped.html#6284" class="Bound">t</a><a id="6285" class="Symbol">)</a> <a id="6287" class="Symbol">=</a> <a id="6289" href="Raw.html#1562" class="InductiveConstructor">ƛ</a> <a id="6291" class="Symbol">(</a><a id="6292" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="6304" class="Symbol">(</a><a id="6305" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="6307" href="Scoped.html#6277" class="Bound">w</a><a id="6308" class="Symbol">)</a> <a id="6310" href="Scoped.html#6282" class="Bound">A</a><a id="6311" class="Symbol">)</a> <a id="6313" class="Symbol">(</a><a id="6314" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6324" class="Symbol">(</a><a id="6325" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="6327" href="Scoped.html#6277" class="Bound">w</a><a id="6328" class="Symbol">)</a> <a id="6330" href="Scoped.html#6284" class="Bound">t</a><a id="6331" class="Symbol">)</a>
<a id="6333" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6343" href="Scoped.html#6343" class="Bound">w</a> <a id="6345" class="Symbol">(</a><a id="6346" href="Scoped.html#6346" class="Bound">t</a> <a id="6348" href="Raw.html#1602" class="InductiveConstructor Operator">·</a> <a id="6350" href="Scoped.html#6350" class="Bound">u</a><a id="6351" class="Symbol">)</a> <a id="6353" class="Symbol">=</a> <a id="6355" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6365" href="Scoped.html#6343" class="Bound">w</a> <a id="6367" href="Scoped.html#6346" class="Bound">t</a> <a id="6369" href="Raw.html#1602" class="InductiveConstructor Operator">·</a> <a id="6371" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6381" href="Scoped.html#6343" class="Bound">w</a> <a id="6383" href="Scoped.html#6350" class="Bound">u</a>
<a id="6385" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6395" href="Scoped.html#6395" class="Bound">w</a> <a id="6397" class="Symbol">(</a><a id="6398" href="Raw.html#1642" class="InductiveConstructor">con</a> <a id="6402" href="Scoped.html#6402" class="Bound">c</a><a id="6403" class="Symbol">)</a> <a id="6405" class="Symbol">=</a> <a id="6407" href="Raw.html#1642" class="InductiveConstructor">con</a> <a id="6411" href="Scoped.html#6402" class="Bound">c</a>
<a id="6413" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6423" href="Scoped.html#6423" class="Bound">w</a> <a id="6425" class="Symbol">(</a><a id="6426" href="Raw.html#1675" class="InductiveConstructor">error</a> <a id="6432" href="Scoped.html#6432" class="Bound">A</a><a id="6433" class="Symbol">)</a> <a id="6435" class="Symbol">=</a> <a id="6437" href="Raw.html#1675" class="InductiveConstructor">error</a> <a id="6443" class="Symbol">(</a><a id="6444" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="6456" href="Scoped.html#6423" class="Bound">w</a> <a id="6458" href="Scoped.html#6432" class="Bound">A</a><a id="6459" class="Symbol">)</a>
<a id="6461" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6471" href="Scoped.html#6471" class="Bound">w</a> <a id="6473" class="Symbol">(</a><a id="6474" href="Raw.html#1707" class="InductiveConstructor">builtin</a> <a id="6482" href="Scoped.html#6482" class="Bound">b</a><a id="6483" class="Symbol">)</a> <a id="6485" class="Symbol">=</a> <a id="6487" href="Raw.html#1707" class="InductiveConstructor">builtin</a> <a id="6495" href="Scoped.html#6482" class="Bound">b</a>
<a id="6497" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6507" href="Scoped.html#6507" class="Bound">w</a> <a id="6509" class="Symbol">(</a><a id="6510" href="Raw.html#1741" class="InductiveConstructor">wrap</a> <a id="6515" href="Scoped.html#6515" class="Bound">pat</a> <a id="6519" href="Scoped.html#6519" class="Bound">arg</a> <a id="6523" href="Scoped.html#6523" class="Bound">t</a><a id="6524" class="Symbol">)</a> <a id="6526" class="Symbol">=</a>
  <a id="6530" href="Raw.html#1741" class="InductiveConstructor">wrap</a> <a id="6535" class="Symbol">(</a><a id="6536" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="6548" href="Scoped.html#6507" class="Bound">w</a> <a id="6550" href="Scoped.html#6515" class="Bound">pat</a><a id="6553" class="Symbol">)</a> <a id="6555" class="Symbol">(</a><a id="6556" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="6568" href="Scoped.html#6507" class="Bound">w</a> <a id="6570" href="Scoped.html#6519" class="Bound">arg</a><a id="6573" class="Symbol">)</a> <a id="6575" class="Symbol">(</a><a id="6576" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6586" href="Scoped.html#6507" class="Bound">w</a> <a id="6588" href="Scoped.html#6523" class="Bound">t</a><a id="6589" class="Symbol">)</a>
<a id="6591" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6601" href="Scoped.html#6601" class="Bound">w</a> <a id="6603" class="Symbol">(</a><a id="6604" href="Raw.html#1789" class="InductiveConstructor">unwrap</a> <a id="6611" href="Scoped.html#6611" class="Bound">t</a><a id="6612" class="Symbol">)</a> <a id="6614" class="Symbol">=</a> <a id="6616" href="Raw.html#1789" class="InductiveConstructor">unwrap</a> <a id="6623" class="Symbol">(</a><a id="6624" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6634" href="Scoped.html#6601" class="Bound">w</a> <a id="6636" href="Scoped.html#6611" class="Bound">t</a><a id="6637" class="Symbol">)</a>
<a id="6639" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6649" href="Scoped.html#6649" class="Bound">w</a> <a id="6651" class="Symbol">(</a><a id="6652" href="Raw.html#1821" class="InductiveConstructor">constr</a> <a id="6659" href="Scoped.html#6659" class="Bound">A</a> <a id="6661" href="Scoped.html#6661" class="Bound">i</a> <a id="6663" href="Scoped.html#6663" class="Bound">cs</a><a id="6665" class="Symbol">)</a> <a id="6667" class="Symbol">=</a> <a id="6669" href="Raw.html#1821" class="InductiveConstructor">constr</a> <a id="6676" class="Symbol">(</a><a id="6677" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="6689" href="Scoped.html#6649" class="Bound">w</a> <a id="6691" href="Scoped.html#6659" class="Bound">A</a><a id="6692" class="Symbol">)</a> <a id="6694" href="Scoped.html#6661" class="Bound">i</a> <a id="6696" class="Symbol">(</a><a id="6697" href="Scoped.html#6064" class="Function">unshifterList</a> <a id="6711" href="Scoped.html#6649" class="Bound">w</a> <a id="6713" href="Scoped.html#6663" class="Bound">cs</a><a id="6715" class="Symbol">)</a>
<a id="6717" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6727" href="Scoped.html#6727" class="Bound">w</a> <a id="6729" class="Symbol">(</a><a id="6730" href="Raw.html#1889" class="InductiveConstructor">case</a> <a id="6735" href="Scoped.html#6735" class="Bound">A</a> <a id="6737" href="Scoped.html#6737" class="Bound">t</a> <a id="6739" href="Scoped.html#6739" class="Bound">cs</a><a id="6741" class="Symbol">)</a> <a id="6743" class="Symbol">=</a> <a id="6745" href="Raw.html#1889" class="InductiveConstructor">case</a> <a id="6750" class="Symbol">(</a><a id="6751" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="6763" href="Scoped.html#6727" class="Bound">w</a> <a id="6765" href="Scoped.html#6735" class="Bound">A</a><a id="6766" class="Symbol">)</a> <a id="6768" class="Symbol">(</a><a id="6769" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6779" href="Scoped.html#6727" class="Bound">w</a> <a id="6781" href="Scoped.html#6737" class="Bound">t</a><a id="6782" class="Symbol">)</a> <a id="6784" class="Symbol">(</a><a id="6785" href="Scoped.html#6064" class="Function">unshifterList</a> <a id="6799" href="Scoped.html#6727" class="Bound">w</a> <a id="6801" href="Scoped.html#6739" class="Bound">cs</a><a id="6803" class="Symbol">)</a>

<a id="6806" href="Scoped.html#6064" class="Function">unshifterList</a> <a id="6820" href="Scoped.html#6820" class="Bound">w</a> <a id="6822" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="6825" class="Symbol">=</a> <a id="6827" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="6830" href="Scoped.html#6064" class="Function">unshifterList</a> <a id="6844" href="Scoped.html#6844" class="Bound">w</a> <a id="6846" class="Symbol">(</a><a id="6847" href="Scoped.html#6847" class="Bound">x</a> <a id="6849" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="6851" href="Scoped.html#6851" class="Bound">xs</a><a id="6853" class="Symbol">)</a> <a id="6855" class="Symbol">=</a> <a id="6857" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6867" href="Scoped.html#6844" class="Bound">w</a> <a id="6869" href="Scoped.html#6847" class="Bound">x</a> <a id="6871" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="6873" href="Scoped.html#6064" class="Function">unshifterList</a> <a id="6887" href="Scoped.html#6844" class="Bound">w</a> <a id="6889" href="Scoped.html#6851" class="Bound">xs</a>

<a id="6893" class="Keyword">data</a> <a id="ScopedTm"></a><a id="6898" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="6907" class="Symbol">{</a><a id="6908" href="Scoped.html#6908" class="Bound">n</a><a id="6909" class="Symbol">}(</a><a id="6911" href="Scoped.html#6911" class="Bound">w</a> <a id="6913" class="Symbol">:</a> <a id="6915" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="6922" href="Scoped.html#6908" class="Bound">n</a><a id="6923" class="Symbol">)</a> <a id="6925" class="Symbol">:</a> <a id="6927" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="6931" class="Keyword">where</a>
  <a id="ScopedTm.`"></a><a id="6939" href="Scoped.html#6939" class="InductiveConstructor">`</a>    <a id="6944" class="Symbol">:</a>    <a id="6949" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="6958" href="Scoped.html#6911" class="Bound">w</a> <a id="6960" class="Symbol">→</a> <a id="6962" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="6971" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.Λ"></a><a id="6975" href="Scoped.html#6975" class="InductiveConstructor">Λ</a>    <a id="6980" class="Symbol">:</a>    <a id="6985" href="Utils.html#6802" class="Datatype">Kind</a> <a id="6990" class="Symbol">→</a> <a id="6992" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7001" class="Symbol">(</a><a id="7002" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="7004" href="Scoped.html#6911" class="Bound">w</a><a id="7005" class="Symbol">)</a> <a id="7007" class="Symbol">→</a> <a id="7009" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7018" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm._·⋆_"></a><a id="7022" href="Scoped.html#7022" class="InductiveConstructor Operator">_·⋆_</a> <a id="7027" class="Symbol">:</a>    <a id="7032" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7041" href="Scoped.html#6911" class="Bound">w</a> <a id="7043" class="Symbol">→</a> <a id="7045" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="7054" href="Scoped.html#6908" class="Bound">n</a> <a id="7056" class="Symbol">→</a> <a id="7058" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7067" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.ƛ"></a><a id="7071" href="Scoped.html#7071" class="InductiveConstructor">ƛ</a>    <a id="7076" class="Symbol">:</a>    <a id="7081" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="7090" href="Scoped.html#6908" class="Bound">n</a> <a id="7092" class="Symbol">→</a> <a id="7094" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7103" class="Symbol">(</a><a id="7104" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="7106" href="Scoped.html#6911" class="Bound">w</a><a id="7107" class="Symbol">)</a> <a id="7109" class="Symbol">→</a> <a id="7111" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7120" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm._·_"></a><a id="7124" href="Scoped.html#7124" class="InductiveConstructor Operator">_·_</a>  <a id="7129" class="Symbol">:</a>    <a id="7134" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7143" href="Scoped.html#6911" class="Bound">w</a> <a id="7145" class="Symbol">→</a> <a id="7147" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7156" href="Scoped.html#6911" class="Bound">w</a> <a id="7158" class="Symbol">→</a> <a id="7160" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7169" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.con"></a><a id="7173" href="Scoped.html#7173" class="InductiveConstructor">con</a>  <a id="7178" class="Symbol">:</a>    <a id="7183" href="RawU.html#7639" class="Datatype">TmCon</a> <a id="7189" class="Symbol">→</a> <a id="7191" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7200" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.error"></a><a id="7204" href="Scoped.html#7204" class="InductiveConstructor">error</a> <a id="7210" class="Symbol">:</a>   <a id="7214" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="7223" href="Scoped.html#6908" class="Bound">n</a> <a id="7225" class="Symbol">→</a> <a id="7227" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7236" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.builtin"></a><a id="7240" href="Scoped.html#7240" class="InductiveConstructor">builtin</a> <a id="7248" class="Symbol">:</a> <a id="7250" class="Symbol">(</a><a id="7251" href="Scoped.html#7251" class="Bound">b</a> <a id="7253" class="Symbol">:</a> <a id="7255" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="7262" class="Symbol">)</a> <a id="7264" class="Symbol">→</a> <a id="7266" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7275" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.wrap"></a><a id="7279" href="Scoped.html#7279" class="InductiveConstructor">wrap</a> <a id="7284" class="Symbol">:</a>    <a id="7289" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="7298" href="Scoped.html#6908" class="Bound">n</a> <a id="7300" class="Symbol">→</a> <a id="7302" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="7311" href="Scoped.html#6908" class="Bound">n</a> <a id="7313" class="Symbol">→</a> <a id="7315" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7324" href="Scoped.html#6911" class="Bound">w</a> <a id="7326" class="Symbol">→</a> <a id="7328" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7337" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.unwrap"></a><a id="7341" href="Scoped.html#7341" class="InductiveConstructor">unwrap</a> <a id="7348" class="Symbol">:</a>  <a id="7351" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7360" href="Scoped.html#6911" class="Bound">w</a> <a id="7362" class="Symbol">→</a> <a id="7364" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7373" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.constr"></a><a id="7377" href="Scoped.html#7377" class="InductiveConstructor">constr</a>        <a id="7391" class="Symbol">:</a> <a id="7393" class="Symbol">(</a><a id="7394" href="Scoped.html#7394" class="Bound">A</a> <a id="7396" class="Symbol">:</a> <a id="7398" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="7407" href="Scoped.html#6908" class="Bound">n</a><a id="7408" class="Symbol">)</a> <a id="7410" class="Symbol">→</a> <a id="7412" class="Symbol">(</a><a id="7413" href="Scoped.html#7413" class="Bound">i</a> <a id="7415" class="Symbol">:</a> <a id="7417" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="7418" class="Symbol">)</a> <a id="7420" class="Symbol">→</a> <a id="7422" class="Symbol">(</a><a id="7423" href="Scoped.html#7423" class="Bound">cs</a> <a id="7426" class="Symbol">:</a> <a id="7428" href="Utils.html#4983" class="Datatype">List</a> <a id="7433" class="Symbol">(</a><a id="7434" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7443" href="Scoped.html#6911" class="Bound">w</a><a id="7444" class="Symbol">))</a> <a id="7447" class="Symbol">→</a> <a id="7449" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7458" href="Scoped.html#6911" class="Bound">w</a>
  <a id="ScopedTm.case"></a><a id="7462" href="Scoped.html#7462" class="InductiveConstructor">case</a>          <a id="7476" class="Symbol">:</a> <a id="7478" class="Symbol">(</a><a id="7479" href="Scoped.html#7479" class="Bound">A</a> <a id="7481" class="Symbol">:</a> <a id="7483" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="7492" href="Scoped.html#6908" class="Bound">n</a><a id="7493" class="Symbol">)</a> <a id="7495" class="Symbol">→</a> <a id="7497" class="Symbol">(</a><a id="7498" href="Scoped.html#7498" class="Bound">arg</a> <a id="7502" class="Symbol">:</a> <a id="7504" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7513" href="Scoped.html#6911" class="Bound">w</a><a id="7514" class="Symbol">)</a> <a id="7516" class="Symbol">→</a> <a id="7518" class="Symbol">(</a><a id="7519" href="Scoped.html#7519" class="Bound">cs</a> <a id="7522" class="Symbol">:</a> <a id="7524" href="Utils.html#4983" class="Datatype">List</a> <a id="7529" class="Symbol">(</a><a id="7530" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7539" href="Scoped.html#6911" class="Bound">w</a><a id="7540" class="Symbol">))</a> <a id="7543" class="Symbol">→</a> <a id="7545" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7554" href="Scoped.html#6911" class="Bound">w</a>

<a id="Tel"></a><a id="7557" href="Scoped.html#7557" class="Function">Tel</a> <a id="7561" class="Symbol">:</a> <a id="7563" class="Symbol">∀{</a><a id="7565" href="Scoped.html#7565" class="Bound">n</a><a id="7566" class="Symbol">}</a> <a id="7568" class="Symbol">→</a> <a id="7570" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="7577" href="Scoped.html#7565" class="Bound">n</a> <a id="7579" class="Symbol">→</a> <a id="7581" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="7583" class="Symbol">→</a> <a id="7585" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="7589" href="Scoped.html#7557" class="Function">Tel</a> <a id="7593" href="Scoped.html#7593" class="Bound">w</a> <a id="7595" href="Scoped.html#7595" class="Bound">n</a> <a id="7597" class="Symbol">=</a> <a id="7599" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="7603" class="Symbol">(</a><a id="7604" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="7613" href="Scoped.html#7593" class="Bound">w</a><a id="7614" class="Symbol">)</a> <a id="7616" href="Scoped.html#7595" class="Bound">n</a>

<a id="7619" class="Comment">-- SCOPE CHECKING / CONVERSION FROM RAW TO SCOPED</a>

<a id="7670" class="Comment">-- should just use ordinary kind for everything</a>

<a id="7719" class="Keyword">postulate</a>
  <a id="FreeVariableError"></a><a id="7731" href="Scoped.html#7731" class="Postulate">FreeVariableError</a> <a id="7749" class="Symbol">:</a> <a id="7751" href="Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="7756" class="Symbol">{-#</a> <a id="7760" class="Keyword">COMPILE</a> <a id="7768" class="Keyword">GHC</a> <a id="7772" href="Scoped.html#7731" class="Postulate">FreeVariableError</a> <a id="7790" class="Pragma">=</a> <a id="7792" class="Pragma">type</a> <a id="7797" class="Pragma">FreeVariableError</a> <a id="7815" class="Symbol">#-}</a>


<a id="7821" class="Keyword">data</a> <a id="ScopeError"></a><a id="7826" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="7837" class="Symbol">:</a> <a id="7839" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="7843" class="Keyword">where</a>
  <a id="ScopeError.deBError"></a><a id="7851" href="Scoped.html#7851" class="InductiveConstructor">deBError</a> <a id="7860" class="Symbol">:</a> <a id="7862" href="Scoped.html#7826" class="Datatype">ScopeError</a>
  <a id="ScopeError.freeVariableError"></a><a id="7875" href="Scoped.html#7875" class="InductiveConstructor">freeVariableError</a> <a id="7893" class="Symbol">:</a> <a id="7895" href="Scoped.html#7731" class="Postulate">FreeVariableError</a> <a id="7913" class="Symbol">→</a> <a id="7915" href="Scoped.html#7826" class="Datatype">ScopeError</a>

<a id="7927" class="Symbol">{-#</a> <a id="7931" class="Keyword">FOREIGN</a> <a id="7939" class="Pragma">GHC</a> <a id="7943" class="Pragma">import</a> <a id="7950" class="Pragma">PlutusCore.DeBruijn</a> <a id="7970" class="Symbol">#-}</a>
<a id="7974" class="Symbol">{-#</a> <a id="7978" class="Keyword">FOREIGN</a> <a id="7986" class="Pragma">GHC</a> <a id="7990" class="Pragma">import</a> <a id="7997" class="Pragma">Raw</a> <a id="8001" class="Symbol">#-}</a>
<a id="8005" class="Symbol">{-#</a> <a id="8009" class="Keyword">COMPILE</a> <a id="8017" class="Keyword">GHC</a> <a id="8021" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="8032" class="Pragma">=</a> <a id="8034" class="Pragma">data</a> <a id="8039" class="Pragma">ScopeError</a> <a id="8050" class="Pragma">(DeBError</a> <a id="8060" class="Pragma">|</a> <a id="8062" class="Pragma">FreeVariableError)</a> <a id="8081" class="Symbol">#-}</a>


<a id="ℕtoFin"></a><a id="8087" href="Scoped.html#8087" class="Function">ℕtoFin</a> <a id="8094" class="Symbol">:</a> <a id="8096" class="Symbol">∀{</a><a id="8098" href="Scoped.html#8098" class="Bound">n</a><a id="8099" class="Symbol">}</a> <a id="8101" class="Symbol">→</a> <a id="8103" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="8105" class="Symbol">→</a> <a id="8107" href="Utils.html#1126" class="Datatype">Either</a> <a id="8114" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="8125" class="Symbol">(</a><a id="8126" href="Data.Fin.Base.html#1135" class="Datatype">Fin</a> <a id="8130" href="Scoped.html#8098" class="Bound">n</a><a id="8131" class="Symbol">)</a>
<a id="8133" href="Scoped.html#8087" class="Function">ℕtoFin</a> <a id="8140" class="Symbol">{</a><a id="8141" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="8145" class="Symbol">}</a>  <a id="8148" class="Symbol">_</a>       <a id="8156" class="Symbol">=</a> <a id="8158" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="8163" href="Scoped.html#7851" class="InductiveConstructor">deBError</a>
<a id="8172" href="Scoped.html#8087" class="Function">ℕtoFin</a> <a id="8179" class="Symbol">{</a><a id="8180" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8184" href="Scoped.html#8184" class="Bound">m</a><a id="8185" class="Symbol">}</a> <a id="8187" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>    <a id="8195" class="Symbol">=</a> <a id="8197" href="Utils.html#2913" class="Field">return</a> <a id="8204" href="Data.Fin.Base.html#1157" class="InductiveConstructor">zero</a>
<a id="8209" href="Scoped.html#8087" class="Function">ℕtoFin</a> <a id="8216" class="Symbol">{</a><a id="8217" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8221" href="Scoped.html#8221" class="Bound">m</a><a id="8222" class="Symbol">}</a> <a id="8224" class="Symbol">(</a><a id="8225" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8229" href="Scoped.html#8229" class="Bound">n</a><a id="8230" class="Symbol">)</a> <a id="8232" class="Symbol">=</a> <a id="8234" href="Utils.html#3049" class="Function">fmap</a> <a id="8239" href="Data.Fin.Base.html#1188" class="InductiveConstructor">suc</a> <a id="8243" class="Symbol">(</a><a id="8244" href="Scoped.html#8087" class="Function">ℕtoFin</a> <a id="8251" href="Scoped.html#8229" class="Bound">n</a><a id="8252" class="Symbol">)</a>

<a id="ℕtoWeirdFin"></a><a id="8255" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="8267" class="Symbol">:</a> <a id="8269" class="Symbol">∀{</a><a id="8271" href="Scoped.html#8271" class="Bound">n</a><a id="8272" class="Symbol">}{</a><a id="8274" href="Scoped.html#8274" class="Bound">w</a> <a id="8276" class="Symbol">:</a> <a id="8278" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="8285" href="Scoped.html#8271" class="Bound">n</a><a id="8286" class="Symbol">}</a> <a id="8288" class="Symbol">→</a> <a id="8290" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="8292" class="Symbol">→</a> <a id="8294" href="Utils.html#1126" class="Datatype">Either</a> <a id="8301" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="8312" class="Symbol">(</a><a id="8313" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="8322" href="Scoped.html#8274" class="Bound">w</a><a id="8323" class="Symbol">)</a>
<a id="8325" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="8337" class="Symbol">{</a><a id="8338" class="Argument">w</a> <a id="8340" class="Symbol">=</a> <a id="8342" href="Scoped.html#1441" class="InductiveConstructor">Z</a><a id="8343" class="Symbol">}</a>   <a id="8347" href="Scoped.html#8347" class="Bound">n</a>    <a id="8352" class="Symbol">=</a> <a id="8354" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="8359" href="Scoped.html#7851" class="InductiveConstructor">deBError</a>
<a id="8368" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="8380" class="Symbol">{</a><a id="8381" class="Argument">w</a> <a id="8383" class="Symbol">=</a> <a id="8385" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="8387" href="Scoped.html#8387" class="Bound">w</a><a id="8388" class="Symbol">}</a> <a id="8390" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="8395" class="Symbol">=</a> <a id="8397" href="Utils.html#2913" class="Field">return</a> <a id="8404" href="Scoped.html#1588" class="InductiveConstructor">Z</a>
<a id="8406" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="8418" class="Symbol">{</a><a id="8419" class="Argument">w</a> <a id="8421" class="Symbol">=</a> <a id="8423" href="Scoped.html#1456" class="InductiveConstructor">S</a> <a id="8425" href="Scoped.html#8425" class="Bound">w</a><a id="8426" class="Symbol">}</a> <a id="8428" class="Symbol">(</a><a id="8429" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8433" href="Scoped.html#8433" class="Bound">n</a><a id="8434" class="Symbol">)</a> <a id="8436" class="Symbol">=</a> <a id="8438" class="Keyword">do</a>
  <a id="8443" href="Scoped.html#8443" class="Bound">i</a> <a id="8445" href="Utils.html#2941" class="Field Operator">←</a> <a id="8447" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="8459" class="Symbol">{</a><a id="8460" class="Argument">w</a> <a id="8462" class="Symbol">=</a> <a id="8464" href="Scoped.html#8425" class="Bound">w</a><a id="8465" class="Symbol">}</a> <a id="8467" href="Scoped.html#8433" class="Bound">n</a>
  <a id="8471" href="Utils.html#2913" class="Field">return</a> <a id="8478" class="Symbol">(</a><a id="8479" href="Scoped.html#1630" class="InductiveConstructor">S</a> <a id="8481" href="Scoped.html#8443" class="Bound">i</a><a id="8482" class="Symbol">)</a>
<a id="8484" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="8496" class="Symbol">{</a><a id="8497" class="Argument">w</a> <a id="8499" class="Symbol">=</a> <a id="8501" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="8503" href="Scoped.html#8503" class="Bound">w</a><a id="8504" class="Symbol">}</a> <a id="8506" href="Scoped.html#8506" class="Bound">n</a>  <a id="8509" class="Symbol">=</a> <a id="8511" class="Keyword">do</a>
  <a id="8516" href="Scoped.html#8516" class="Bound">i</a> <a id="8518" href="Utils.html#2941" class="Field Operator">←</a> <a id="8520" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="8532" class="Symbol">{</a><a id="8533" class="Argument">w</a> <a id="8535" class="Symbol">=</a> <a id="8537" href="Scoped.html#8503" class="Bound">w</a><a id="8538" class="Symbol">}</a> <a id="8540" href="Scoped.html#8506" class="Bound">n</a>
  <a id="8544" href="Utils.html#2913" class="Field">return</a> <a id="8551" class="Symbol">(</a><a id="8552" href="Scoped.html#1685" class="InductiveConstructor">T</a> <a id="8554" href="Scoped.html#8516" class="Bound">i</a><a id="8555" class="Symbol">)</a>

<a id="scopeCheckTy"></a><a id="8558" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8571" class="Symbol">:</a> <a id="8573" class="Symbol">∀{</a><a id="8575" href="Scoped.html#8575" class="Bound">n</a><a id="8576" class="Symbol">}</a> <a id="8578" class="Symbol">→</a> <a id="8580" href="Raw.html#810" class="Datatype">RawTy</a> <a id="8586" class="Symbol">→</a> <a id="8588" href="Utils.html#1126" class="Datatype">Either</a> <a id="8595" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="8606" class="Symbol">(</a><a id="8607" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="8616" href="Scoped.html#8575" class="Bound">n</a><a id="8617" class="Symbol">)</a>
<a id="scopeCheckTyList"></a><a id="8619" href="Scoped.html#8619" class="Function">scopeCheckTyList</a> <a id="8636" class="Symbol">:</a> <a id="8638" class="Symbol">∀{</a><a id="8640" href="Scoped.html#8640" class="Bound">n</a><a id="8641" class="Symbol">}</a> <a id="8643" class="Symbol">→</a> <a id="8645" href="Utils.html#4983" class="Datatype">List</a> <a id="8650" href="Raw.html#810" class="Datatype">RawTy</a> <a id="8656" class="Symbol">→</a> <a id="8658" href="Utils.html#1126" class="Datatype">Either</a> <a id="8665" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="8676" class="Symbol">(</a><a id="8677" href="Utils.html#4983" class="Datatype">List</a> <a id="8682" class="Symbol">(</a><a id="8683" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="8692" href="Scoped.html#8640" class="Bound">n</a><a id="8693" class="Symbol">))</a>
<a id="scopeCheckTyListList"></a><a id="8696" href="Scoped.html#8696" class="Function">scopeCheckTyListList</a> <a id="8717" class="Symbol">:</a> <a id="8719" class="Symbol">∀{</a><a id="8721" href="Scoped.html#8721" class="Bound">n</a><a id="8722" class="Symbol">}</a> <a id="8724" class="Symbol">→</a> <a id="8726" href="Utils.html#4983" class="Datatype">List</a> <a id="8731" class="Symbol">(</a><a id="8732" href="Utils.html#4983" class="Datatype">List</a> <a id="8737" href="Raw.html#810" class="Datatype">RawTy</a><a id="8742" class="Symbol">)</a> <a id="8744" class="Symbol">→</a> <a id="8746" href="Utils.html#1126" class="Datatype">Either</a> <a id="8753" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="8764" class="Symbol">(</a><a id="8765" href="Utils.html#4983" class="Datatype">List</a> <a id="8770" class="Symbol">(</a><a id="8771" href="Utils.html#4983" class="Datatype">List</a> <a id="8776" class="Symbol">(</a><a id="8777" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="8786" href="Scoped.html#8721" class="Bound">n</a><a id="8787" class="Symbol">)))</a>

<a id="8792" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8805" class="Symbol">(</a><a id="8806" href="Raw.html#863" class="InductiveConstructor">`</a> <a id="8808" href="Scoped.html#8808" class="Bound">x</a><a id="8809" class="Symbol">)</a> <a id="8811" class="Symbol">=</a> <a id="8813" href="Utils.html#3049" class="Function">fmap</a> <a id="8818" href="Scoped.html#1007" class="InductiveConstructor">`</a> <a id="8820" class="Symbol">(</a><a id="8821" href="Scoped.html#8087" class="Function">ℕtoFin</a> <a id="8828" href="Scoped.html#8808" class="Bound">x</a><a id="8829" class="Symbol">)</a>
<a id="8831" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8844" class="Symbol">(</a><a id="8845" href="Scoped.html#8845" class="Bound">A</a> <a id="8847" href="Raw.html#881" class="InductiveConstructor Operator">⇒</a> <a id="8849" href="Scoped.html#8849" class="Bound">B</a><a id="8850" class="Symbol">)</a> <a id="8852" class="Symbol">=</a> <a id="8854" class="Keyword">do</a>
  <a id="8859" href="Scoped.html#8859" class="Bound">A</a> <a id="8861" href="Utils.html#2941" class="Field Operator">←</a> <a id="8863" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8876" href="Scoped.html#8845" class="Bound">A</a>
  <a id="8880" href="Scoped.html#8880" class="Bound">B</a> <a id="8882" href="Utils.html#2941" class="Field Operator">←</a> <a id="8884" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8897" href="Scoped.html#8849" class="Bound">B</a>
  <a id="8901" href="Utils.html#2913" class="Field">return</a> <a id="8908" class="Symbol">(</a><a id="8909" href="Scoped.html#8859" class="Bound">A</a> <a id="8911" href="Scoped.html#1035" class="InductiveConstructor Operator">⇒</a> <a id="8913" href="Scoped.html#8880" class="Bound">B</a><a id="8914" class="Symbol">)</a>
<a id="8916" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8929" class="Symbol">(</a><a id="8930" href="Raw.html#911" class="InductiveConstructor">Π</a> <a id="8932" href="Scoped.html#8932" class="Bound">K</a> <a id="8934" href="Scoped.html#8934" class="Bound">A</a><a id="8935" class="Symbol">)</a> <a id="8937" class="Symbol">=</a> <a id="8939" href="Utils.html#3049" class="Function">fmap</a> <a id="8944" class="Symbol">(</a><a id="8945" href="Scoped.html#1081" class="InductiveConstructor">Π</a> <a id="8947" href="Scoped.html#8932" class="Bound">K</a><a id="8948" class="Symbol">)</a> <a id="8950" class="Symbol">(</a><a id="8951" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8964" href="Scoped.html#8934" class="Bound">A</a><a id="8965" class="Symbol">)</a>
<a id="8967" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="8980" class="Symbol">(</a><a id="8981" href="Raw.html#940" class="InductiveConstructor">ƛ</a> <a id="8983" href="Scoped.html#8983" class="Bound">K</a> <a id="8985" href="Scoped.html#8985" class="Bound">A</a><a id="8986" class="Symbol">)</a> <a id="8988" class="Symbol">=</a> <a id="8990" href="Utils.html#3049" class="Function">fmap</a> <a id="8995" class="Symbol">(</a><a id="8996" href="Scoped.html#1127" class="InductiveConstructor">ƛ</a> <a id="8998" href="Scoped.html#8983" class="Bound">K</a><a id="8999" class="Symbol">)</a> <a id="9001" class="Symbol">(</a><a id="9002" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9015" href="Scoped.html#8985" class="Bound">A</a><a id="9016" class="Symbol">)</a>
<a id="9018" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9031" class="Symbol">(</a><a id="9032" href="Scoped.html#9032" class="Bound">A</a> <a id="9034" href="Raw.html#969" class="InductiveConstructor Operator">·</a> <a id="9036" href="Scoped.html#9036" class="Bound">B</a><a id="9037" class="Symbol">)</a> <a id="9039" class="Symbol">=</a> <a id="9041" class="Keyword">do</a>
  <a id="9046" href="Scoped.html#9046" class="Bound">A</a> <a id="9048" href="Utils.html#2941" class="Field Operator">←</a> <a id="9050" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9063" href="Scoped.html#9032" class="Bound">A</a>
  <a id="9067" href="Scoped.html#9067" class="Bound">B</a> <a id="9069" href="Utils.html#2941" class="Field Operator">←</a> <a id="9071" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9084" href="Scoped.html#9036" class="Bound">B</a>
  <a id="9088" href="Utils.html#2913" class="Field">return</a> <a id="9095" class="Symbol">(</a><a id="9096" href="Scoped.html#9046" class="Bound">A</a> <a id="9098" href="Scoped.html#1173" class="InductiveConstructor Operator">·</a> <a id="9100" href="Scoped.html#9067" class="Bound">B</a><a id="9101" class="Symbol">)</a>
<a id="9103" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9116" class="Symbol">(</a><a id="9117" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="9121" class="Symbol">(</a><a id="9122" href="Raw.html#1262" class="InductiveConstructor">atomic</a> <a id="9129" href="Scoped.html#9129" class="Bound">x</a><a id="9130" class="Symbol">))</a> <a id="9133" class="Symbol">=</a> <a id="9135" href="Utils.html#2913" class="Field">return</a> <a id="9142" class="Symbol">(</a><a id="9143" href="Scoped.html#1219" class="InductiveConstructor">con</a> <a id="9147" class="Symbol">(</a><a id="9148" href="Builtin.Constant.Type.html#885" class="InductiveConstructor">atomic</a> <a id="9155" href="Scoped.html#9129" class="Bound">x</a><a id="9156" class="Symbol">))</a>
<a id="9159" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9172" class="Symbol">(</a><a id="9173" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="9177" href="Raw.html#1300" class="InductiveConstructor">list</a><a id="9181" class="Symbol">)</a> <a id="9183" class="Symbol">=</a> <a id="9185" href="Utils.html#2913" class="Field">return</a> <a id="9192" class="Symbol">(</a><a id="9193" href="Scoped.html#1219" class="InductiveConstructor">con</a> <a id="9197" href="Builtin.Constant.Type.html#922" class="InductiveConstructor">list</a><a id="9201" class="Symbol">)</a>
<a id="9203" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9216" class="Symbol">(</a><a id="9217" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="9221" href="Raw.html#1324" class="InductiveConstructor">pair</a><a id="9225" class="Symbol">)</a> <a id="9227" class="Symbol">=</a> <a id="9229" href="Utils.html#2913" class="Field">return</a> <a id="9236" class="Symbol">(</a><a id="9237" href="Scoped.html#1219" class="InductiveConstructor">con</a> <a id="9241" href="Builtin.Constant.Type.html#951" class="InductiveConstructor">pair</a><a id="9245" class="Symbol">)</a>
<a id="9247" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9260" class="Symbol">(</a><a id="9261" href="Raw.html#1024" class="InductiveConstructor">μ</a> <a id="9263" href="Scoped.html#9263" class="Bound">A</a> <a id="9265" href="Scoped.html#9265" class="Bound">B</a><a id="9266" class="Symbol">)</a> <a id="9268" class="Symbol">=</a> <a id="9270" class="Keyword">do</a>
  <a id="9275" href="Scoped.html#9275" class="Bound">A</a> <a id="9277" href="Utils.html#2941" class="Field Operator">←</a> <a id="9279" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9292" href="Scoped.html#9263" class="Bound">A</a>
  <a id="9296" href="Scoped.html#9296" class="Bound">B</a> <a id="9298" href="Utils.html#2941" class="Field Operator">←</a> <a id="9300" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9313" href="Scoped.html#9265" class="Bound">B</a>
  <a id="9317" href="Utils.html#2913" class="Field">return</a> <a id="9324" class="Symbol">(</a><a id="9325" href="Scoped.html#1256" class="InductiveConstructor">μ</a> <a id="9327" href="Scoped.html#9275" class="Bound">A</a> <a id="9329" href="Scoped.html#9296" class="Bound">B</a><a id="9330" class="Symbol">)</a>
<a id="9332" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9345" class="Symbol">(</a><a id="9346" href="Raw.html#1054" class="InductiveConstructor">SOP</a> <a id="9350" href="Scoped.html#9350" class="Bound">xss</a><a id="9353" class="Symbol">)</a> <a id="9355" class="Symbol">=</a> <a id="9357" class="Keyword">do</a> 
      <a id="9367" href="Scoped.html#9367" class="Bound">A</a> <a id="9369" href="Utils.html#2941" class="Field Operator">←</a> <a id="9371" href="Scoped.html#8696" class="Function">scopeCheckTyListList</a> <a id="9392" href="Scoped.html#9350" class="Bound">xss</a>  
      <a id="9404" href="Utils.html#2913" class="Field">return</a> <a id="9411" class="Symbol">(</a><a id="9412" href="Scoped.html#1302" class="InductiveConstructor">SOP</a> <a id="9416" href="Scoped.html#9367" class="Bound">A</a><a id="9417" class="Symbol">)</a>

<a id="9420" href="Scoped.html#8619" class="Function">scopeCheckTyList</a> <a id="9437" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="9440" class="Symbol">=</a> <a id="9442" href="Utils.html#2913" class="Field">return</a> <a id="9449" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="9452" href="Scoped.html#8619" class="Function">scopeCheckTyList</a> <a id="9469" class="Symbol">(</a><a id="9470" href="Scoped.html#9470" class="Bound">x</a> <a id="9472" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="9474" href="Scoped.html#9474" class="Bound">xs</a><a id="9476" class="Symbol">)</a> <a id="9478" class="Symbol">=</a> <a id="9480" class="Keyword">do</a> 
      <a id="9490" href="Scoped.html#9490" class="Bound">A</a>  <a id="9493" href="Utils.html#2941" class="Field Operator">←</a> <a id="9495" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="9508" href="Scoped.html#9470" class="Bound">x</a> 
      <a id="9517" href="Scoped.html#9517" class="Bound">As</a> <a id="9520" href="Utils.html#2941" class="Field Operator">←</a> <a id="9522" href="Scoped.html#8619" class="Function">scopeCheckTyList</a> <a id="9539" href="Scoped.html#9474" class="Bound">xs</a>
      <a id="9548" href="Utils.html#2913" class="Field">return</a> <a id="9555" class="Symbol">(</a><a id="9556" href="Scoped.html#9490" class="Bound">A</a> <a id="9558" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="9560" href="Scoped.html#9517" class="Bound">As</a><a id="9562" class="Symbol">)</a>

<a id="9565" href="Scoped.html#8696" class="Function">scopeCheckTyListList</a> <a id="9586" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="9589" class="Symbol">=</a> <a id="9591" href="Utils.html#2913" class="Field">return</a> <a id="9598" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="9601" href="Scoped.html#8696" class="Function">scopeCheckTyListList</a> <a id="9622" class="Symbol">(</a><a id="9623" href="Scoped.html#9623" class="Bound">xs</a> <a id="9626" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="9628" href="Scoped.html#9628" class="Bound">xss</a><a id="9631" class="Symbol">)</a> <a id="9633" class="Symbol">=</a> <a id="9635" class="Keyword">do</a> 
      <a id="9645" href="Scoped.html#9645" class="Bound">Ts</a>  <a id="9649" href="Utils.html#2941" class="Field Operator">←</a> <a id="9651" href="Scoped.html#8619" class="Function">scopeCheckTyList</a> <a id="9668" href="Scoped.html#9623" class="Bound">xs</a> 
      <a id="9678" href="Scoped.html#9678" class="Bound">Tss</a> <a id="9682" href="Utils.html#2941" class="Field Operator">←</a> <a id="9684" href="Scoped.html#8696" class="Function">scopeCheckTyListList</a> <a id="9705" href="Scoped.html#9628" class="Bound">xss</a>
      <a id="9715" href="Utils.html#2913" class="Field">return</a> <a id="9722" class="Symbol">(</a><a id="9723" href="Scoped.html#9645" class="Bound">Ts</a> <a id="9726" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="9728" href="Scoped.html#9678" class="Bound">Tss</a><a id="9731" class="Symbol">)</a>

<a id="scopeCheckTm"></a><a id="9734" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="9747" class="Symbol">:</a> <a id="9749" class="Symbol">∀{</a><a id="9751" href="Scoped.html#9751" class="Bound">n</a><a id="9752" class="Symbol">}{</a><a id="9754" href="Scoped.html#9754" class="Bound">w</a> <a id="9756" class="Symbol">:</a> <a id="9758" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="9765" href="Scoped.html#9751" class="Bound">n</a><a id="9766" class="Symbol">}</a> <a id="9768" class="Symbol">→</a> <a id="9770" href="Raw.html#1435" class="Datatype">RawTm</a> <a id="9776" class="Symbol">→</a> <a id="9778" href="Utils.html#1126" class="Datatype">Either</a> <a id="9785" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="9796" class="Symbol">(</a><a id="9797" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="9806" href="Scoped.html#9754" class="Bound">w</a><a id="9807" class="Symbol">)</a>
<a id="scopeCheckTmList"></a><a id="9809" href="Scoped.html#9809" class="Function">scopeCheckTmList</a> <a id="9826" class="Symbol">:</a> <a id="9828" class="Symbol">∀{</a><a id="9830" href="Scoped.html#9830" class="Bound">n</a><a id="9831" class="Symbol">}{</a><a id="9833" href="Scoped.html#9833" class="Bound">w</a> <a id="9835" class="Symbol">:</a> <a id="9837" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="9844" href="Scoped.html#9830" class="Bound">n</a><a id="9845" class="Symbol">}</a> <a id="9847" class="Symbol">→</a> <a id="9849" href="Utils.html#4983" class="Datatype">List</a> <a id="9854" href="Raw.html#1435" class="Datatype">RawTm</a> <a id="9860" class="Symbol">→</a> <a id="9862" href="Utils.html#1126" class="Datatype">Either</a> <a id="9869" href="Scoped.html#7826" class="Datatype">ScopeError</a> <a id="9880" class="Symbol">(</a><a id="9881" href="Utils.html#4983" class="Datatype">List</a> <a id="9886" class="Symbol">(</a><a id="9887" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="9896" href="Scoped.html#9833" class="Bound">w</a><a id="9897" class="Symbol">))</a>

<a id="9901" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="9914" class="Symbol">(</a><a id="9915" href="Raw.html#1455" class="InductiveConstructor">`</a> <a id="9917" href="Scoped.html#9917" class="Bound">x</a><a id="9918" class="Symbol">)</a> <a id="9920" class="Symbol">=</a> <a id="9922" href="Utils.html#3049" class="Function">fmap</a> <a id="9927" href="Scoped.html#6939" class="InductiveConstructor">`</a> <a id="9929" class="Symbol">(</a><a id="9930" href="Scoped.html#8255" class="Function">ℕtoWeirdFin</a> <a id="9942" href="Scoped.html#9917" class="Bound">x</a><a id="9943" class="Symbol">)</a>
<a id="9945" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="9958" class="Symbol">{</a><a id="9959" href="Scoped.html#9959" class="Bound">n</a><a id="9960" class="Symbol">}{</a><a id="9962" href="Scoped.html#9962" class="Bound">w</a><a id="9963" class="Symbol">}(</a><a id="9965" href="Raw.html#1483" class="InductiveConstructor">Λ</a> <a id="9967" href="Scoped.html#9967" class="Bound">K</a> <a id="9969" href="Scoped.html#9969" class="Bound">t</a><a id="9970" class="Symbol">)</a> <a id="9972" class="Symbol">=</a> <a id="9974" href="Utils.html#3049" class="Function">fmap</a> <a id="9979" class="Symbol">(</a><a id="9980" href="Scoped.html#6975" class="InductiveConstructor">Λ</a> <a id="9982" href="Scoped.html#9967" class="Bound">K</a><a id="9983" class="Symbol">)</a> <a id="9985" class="Symbol">(</a><a id="9986" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="9999" class="Symbol">{</a><a id="10000" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="10004" href="Scoped.html#9959" class="Bound">n</a><a id="10005" class="Symbol">}{</a><a id="10007" href="Scoped.html#1490" class="InductiveConstructor">T</a> <a id="10009" href="Scoped.html#9962" class="Bound">w</a><a id="10010" class="Symbol">}</a> <a id="10012" href="Scoped.html#9969" class="Bound">t</a><a id="10013" class="Symbol">)</a>
<a id="10015" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10028" class="Symbol">(</a><a id="10029" href="Scoped.html#10029" class="Bound">t</a> <a id="10031" href="Raw.html#1522" class="InductiveConstructor Operator">·⋆</a> <a id="10034" href="Scoped.html#10034" class="Bound">A</a><a id="10035" class="Symbol">)</a> <a id="10037" class="Symbol">=</a> <a id="10039" class="Keyword">do</a>
  <a id="10044" href="Scoped.html#10044" class="Bound">A</a> <a id="10046" href="Utils.html#2941" class="Field Operator">←</a> <a id="10048" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="10061" href="Scoped.html#10034" class="Bound">A</a>
  <a id="10065" href="Scoped.html#10065" class="Bound">t</a> <a id="10067" href="Utils.html#2941" class="Field Operator">←</a> <a id="10069" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10082" href="Scoped.html#10029" class="Bound">t</a>
  <a id="10086" href="Utils.html#2913" class="Field">return</a> <a id="10093" class="Symbol">(</a><a id="10094" href="Scoped.html#10065" class="Bound">t</a> <a id="10096" href="Scoped.html#7022" class="InductiveConstructor Operator">·⋆</a> <a id="10099" href="Scoped.html#10044" class="Bound">A</a><a id="10100" class="Symbol">)</a>
<a id="10102" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10115" class="Symbol">(</a><a id="10116" href="Raw.html#1562" class="InductiveConstructor">ƛ</a> <a id="10118" href="Scoped.html#10118" class="Bound">A</a> <a id="10120" href="Scoped.html#10120" class="Bound">t</a><a id="10121" class="Symbol">)</a> <a id="10123" class="Symbol">=</a> <a id="10125" class="Keyword">do</a>
  <a id="10130" href="Scoped.html#10130" class="Bound">A</a> <a id="10132" href="Utils.html#2941" class="Field Operator">←</a> <a id="10134" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="10147" href="Scoped.html#10118" class="Bound">A</a>
  <a id="10151" href="Scoped.html#10151" class="Bound">t</a> <a id="10153" href="Utils.html#2941" class="Field Operator">←</a> <a id="10155" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10168" href="Scoped.html#10120" class="Bound">t</a>
  <a id="10172" href="Utils.html#2913" class="Field">return</a> <a id="10179" class="Symbol">(</a><a id="10180" href="Scoped.html#7071" class="InductiveConstructor">ƛ</a> <a id="10182" href="Scoped.html#10130" class="Bound">A</a> <a id="10184" href="Scoped.html#10151" class="Bound">t</a><a id="10185" class="Symbol">)</a>
<a id="10187" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10200" class="Symbol">(</a><a id="10201" href="Scoped.html#10201" class="Bound">t</a> <a id="10203" href="Raw.html#1602" class="InductiveConstructor Operator">·</a> <a id="10205" href="Scoped.html#10205" class="Bound">u</a><a id="10206" class="Symbol">)</a> <a id="10208" class="Symbol">=</a> <a id="10210" class="Keyword">do</a>
  <a id="10215" href="Scoped.html#10215" class="Bound">t</a> <a id="10217" href="Utils.html#2941" class="Field Operator">←</a> <a id="10219" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10232" href="Scoped.html#10201" class="Bound">t</a>
  <a id="10236" href="Scoped.html#10236" class="Bound">u</a> <a id="10238" href="Utils.html#2941" class="Field Operator">←</a> <a id="10240" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10253" href="Scoped.html#10205" class="Bound">u</a>
  <a id="10257" href="Utils.html#2913" class="Field">return</a> <a id="10264" class="Symbol">(</a><a id="10265" href="Scoped.html#10215" class="Bound">t</a> <a id="10267" href="Scoped.html#7124" class="InductiveConstructor Operator">·</a> <a id="10269" href="Scoped.html#10236" class="Bound">u</a><a id="10270" class="Symbol">)</a>
<a id="10272" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10285" class="Symbol">(</a><a id="10286" href="Raw.html#1642" class="InductiveConstructor">con</a> <a id="10290" href="Scoped.html#10290" class="Bound">c</a><a id="10291" class="Symbol">)</a> <a id="10293" class="Symbol">=</a> <a id="10295" href="Utils.html#2913" class="Field">return</a> <a id="10302" class="Symbol">(</a><a id="10303" href="Scoped.html#7173" class="InductiveConstructor">con</a> <a id="10307" class="Symbol">(</a><a id="10308" href="RawU.html#8841" class="Function">tagCon2TmCon</a> <a id="10321" href="Scoped.html#10290" class="Bound">c</a><a id="10322" class="Symbol">))</a>
<a id="10325" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10338" class="Symbol">(</a><a id="10339" href="Raw.html#1707" class="InductiveConstructor">builtin</a> <a id="10347" href="Scoped.html#10347" class="Bound">b</a><a id="10348" class="Symbol">)</a> <a id="10350" class="Symbol">=</a> <a id="10352" href="Utils.html#2913" class="Field">return</a> <a id="10359" class="Symbol">(</a><a id="10360" href="Scoped.html#7240" class="InductiveConstructor">builtin</a> <a id="10368" href="Scoped.html#10347" class="Bound">b</a><a id="10369" class="Symbol">)</a>
<a id="10371" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10384" class="Symbol">(</a><a id="10385" href="Raw.html#1675" class="InductiveConstructor">error</a> <a id="10391" href="Scoped.html#10391" class="Bound">A</a><a id="10392" class="Symbol">)</a> <a id="10394" class="Symbol">=</a> <a id="10396" href="Utils.html#3049" class="Function">fmap</a> <a id="10401" href="Scoped.html#7204" class="InductiveConstructor">error</a> <a id="10407" class="Symbol">(</a><a id="10408" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="10421" href="Scoped.html#10391" class="Bound">A</a><a id="10422" class="Symbol">)</a>
<a id="10424" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10437" class="Symbol">(</a><a id="10438" href="Raw.html#1741" class="InductiveConstructor">wrap</a> <a id="10443" href="Scoped.html#10443" class="Bound">A</a> <a id="10445" href="Scoped.html#10445" class="Bound">B</a> <a id="10447" href="Scoped.html#10447" class="Bound">t</a><a id="10448" class="Symbol">)</a> <a id="10450" class="Symbol">=</a> <a id="10452" class="Keyword">do</a>
  <a id="10457" href="Scoped.html#10457" class="Bound">A</a> <a id="10459" href="Utils.html#2941" class="Field Operator">←</a> <a id="10461" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="10474" href="Scoped.html#10443" class="Bound">A</a>
  <a id="10478" href="Scoped.html#10478" class="Bound">B</a> <a id="10480" href="Utils.html#2941" class="Field Operator">←</a> <a id="10482" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="10495" href="Scoped.html#10445" class="Bound">B</a>
  <a id="10499" href="Scoped.html#10499" class="Bound">t</a> <a id="10501" href="Utils.html#2941" class="Field Operator">←</a> <a id="10503" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10516" href="Scoped.html#10447" class="Bound">t</a>
  <a id="10520" href="Utils.html#2913" class="Field">return</a> <a id="10527" class="Symbol">(</a><a id="10528" href="Scoped.html#7279" class="InductiveConstructor">wrap</a> <a id="10533" href="Scoped.html#10457" class="Bound">A</a> <a id="10535" href="Scoped.html#10478" class="Bound">B</a> <a id="10537" href="Scoped.html#10499" class="Bound">t</a><a id="10538" class="Symbol">)</a>
<a id="10540" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10553" class="Symbol">(</a><a id="10554" href="Raw.html#1789" class="InductiveConstructor">unwrap</a> <a id="10561" href="Scoped.html#10561" class="Bound">t</a><a id="10562" class="Symbol">)</a> <a id="10564" class="Symbol">=</a> <a id="10566" href="Utils.html#3049" class="Function">fmap</a> <a id="10571" href="Scoped.html#7341" class="InductiveConstructor">unwrap</a> <a id="10578" class="Symbol">(</a><a id="10579" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10592" href="Scoped.html#10561" class="Bound">t</a><a id="10593" class="Symbol">)</a>
<a id="10595" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10608" class="Symbol">(</a><a id="10609" href="Raw.html#1821" class="InductiveConstructor">constr</a> <a id="10616" href="Scoped.html#10616" class="Bound">A</a> <a id="10618" href="Scoped.html#10618" class="Bound">i</a> <a id="10620" href="Scoped.html#10620" class="Bound">cs</a><a id="10622" class="Symbol">)</a> <a id="10624" class="Symbol">=</a> <a id="10626" class="Keyword">do</a> 
  <a id="10632" href="Scoped.html#10632" class="Bound">A</a>  <a id="10635" href="Utils.html#2941" class="Field Operator">←</a> <a id="10637" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="10650" href="Scoped.html#10616" class="Bound">A</a> 
  <a id="10655" href="Scoped.html#10655" class="Bound">cs</a> <a id="10658" href="Utils.html#2941" class="Field Operator">←</a> <a id="10660" href="Scoped.html#9809" class="Function">scopeCheckTmList</a> <a id="10677" href="Scoped.html#10620" class="Bound">cs</a>
  <a id="10682" href="Utils.html#2913" class="Field">return</a> <a id="10689" class="Symbol">(</a><a id="10690" href="Scoped.html#7377" class="InductiveConstructor">constr</a> <a id="10697" href="Scoped.html#10632" class="Bound">A</a> <a id="10699" href="Scoped.html#10618" class="Bound">i</a> <a id="10701" href="Scoped.html#10655" class="Bound">cs</a><a id="10703" class="Symbol">)</a>
<a id="10705" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10718" class="Symbol">(</a><a id="10719" href="Raw.html#1889" class="InductiveConstructor">case</a> <a id="10724" href="Scoped.html#10724" class="Bound">A</a> <a id="10726" href="Scoped.html#10726" class="Bound">t</a> <a id="10728" href="Scoped.html#10728" class="Bound">cs</a><a id="10730" class="Symbol">)</a> <a id="10732" class="Symbol">=</a> <a id="10734" class="Keyword">do</a> 
  <a id="10740" href="Scoped.html#10740" class="Bound">A</a>  <a id="10743" href="Utils.html#2941" class="Field Operator">←</a> <a id="10745" href="Scoped.html#8558" class="Function">scopeCheckTy</a> <a id="10758" href="Scoped.html#10724" class="Bound">A</a>
  <a id="10762" href="Scoped.html#10762" class="Bound">t</a>  <a id="10765" href="Utils.html#2941" class="Field Operator">←</a> <a id="10767" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10780" href="Scoped.html#10726" class="Bound">t</a>
  <a id="10784" href="Scoped.html#10784" class="Bound">cs</a> <a id="10787" href="Utils.html#2941" class="Field Operator">←</a> <a id="10789" href="Scoped.html#9809" class="Function">scopeCheckTmList</a> <a id="10806" href="Scoped.html#10728" class="Bound">cs</a>
  <a id="10811" href="Utils.html#2913" class="Field">return</a> <a id="10818" class="Symbol">(</a><a id="10819" href="Scoped.html#7462" class="InductiveConstructor">case</a> <a id="10824" href="Scoped.html#10740" class="Bound">A</a> <a id="10826" href="Scoped.html#10762" class="Bound">t</a> <a id="10828" href="Scoped.html#10784" class="Bound">cs</a><a id="10830" class="Symbol">)</a>

<a id="10833" href="Scoped.html#9809" class="Function">scopeCheckTmList</a> <a id="10850" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="10853" class="Symbol">=</a> <a id="10855" href="Utils.html#2913" class="Field">return</a> <a id="10862" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="10865" href="Scoped.html#9809" class="Function">scopeCheckTmList</a> <a id="10882" class="Symbol">(</a><a id="10883" href="Scoped.html#10883" class="Bound">x</a> <a id="10885" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="10887" href="Scoped.html#10887" class="Bound">xs</a><a id="10889" class="Symbol">)</a> <a id="10891" class="Symbol">=</a> <a id="10893" class="Keyword">do</a> 
  <a id="10899" href="Scoped.html#10899" class="Bound">x</a>  <a id="10902" href="Utils.html#2941" class="Field Operator">←</a> <a id="10904" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="10917" href="Scoped.html#10883" class="Bound">x</a> 
  <a id="10922" href="Scoped.html#10922" class="Bound">xs</a> <a id="10925" href="Utils.html#2941" class="Field Operator">←</a> <a id="10927" href="Scoped.html#9809" class="Function">scopeCheckTmList</a> <a id="10944" href="Scoped.html#10887" class="Bound">xs</a> 
  <a id="10950" href="Utils.html#2913" class="Field">return</a> <a id="10957" class="Symbol">(</a><a id="10958" href="Scoped.html#10899" class="Bound">x</a> <a id="10960" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="10962" href="Scoped.html#10922" class="Bound">xs</a><a id="10964" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="extricateScopeTy"></a><a id="10975" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="10992" class="Symbol">:</a> <a id="10994" class="Symbol">∀{</a><a id="10996" href="Scoped.html#10996" class="Bound">n</a><a id="10997" class="Symbol">}</a> <a id="10999" class="Symbol">→</a> <a id="11001" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="11010" href="Scoped.html#10996" class="Bound">n</a> <a id="11012" class="Symbol">→</a> <a id="11014" href="Raw.html#810" class="Datatype">RawTy</a>
<a id="extricateScopeTyList"></a><a id="11020" href="Scoped.html#11020" class="Function">extricateScopeTyList</a> <a id="11041" class="Symbol">:</a> <a id="11043" class="Symbol">∀{</a><a id="11045" href="Scoped.html#11045" class="Bound">n</a><a id="11046" class="Symbol">}</a> <a id="11048" class="Symbol">→</a> <a id="11050" href="Utils.html#4983" class="Datatype">List</a> <a id="11055" class="Symbol">(</a><a id="11056" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="11065" href="Scoped.html#11045" class="Bound">n</a><a id="11066" class="Symbol">)</a> <a id="11068" class="Symbol">→</a> <a id="11070" href="Utils.html#4983" class="Datatype">List</a> <a id="11075" href="Raw.html#810" class="Datatype">RawTy</a>
<a id="extricateScopeTyListList"></a><a id="11081" href="Scoped.html#11081" class="Function">extricateScopeTyListList</a> <a id="11106" class="Symbol">:</a> <a id="11108" class="Symbol">∀{</a><a id="11110" href="Scoped.html#11110" class="Bound">n</a><a id="11111" class="Symbol">}</a> <a id="11113" class="Symbol">→</a> <a id="11115" href="Utils.html#4983" class="Datatype">List</a> <a id="11120" class="Symbol">(</a><a id="11121" href="Utils.html#4983" class="Datatype">List</a> <a id="11126" class="Symbol">(</a><a id="11127" href="Scoped.html#976" class="Datatype">ScopedTy</a> <a id="11136" href="Scoped.html#11110" class="Bound">n</a><a id="11137" class="Symbol">))</a> <a id="11140" class="Symbol">→</a> <a id="11142" href="Utils.html#4983" class="Datatype">List</a> <a id="11147" class="Symbol">(</a><a id="11148" href="Utils.html#4983" class="Datatype">List</a> <a id="11153" href="Raw.html#810" class="Datatype">RawTy</a><a id="11158" class="Symbol">)</a>

<a id="11161" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11178" class="Symbol">(</a><a id="11179" href="Scoped.html#1007" class="InductiveConstructor">`</a> <a id="11181" href="Scoped.html#11181" class="Bound">x</a><a id="11182" class="Symbol">)</a>      <a id="11189" class="Symbol">=</a> <a id="11191" href="Raw.html#863" class="InductiveConstructor">`</a> <a id="11193" class="Symbol">(</a><a id="11194" href="Data.Fin.Base.html#1261" class="Function">toℕ</a> <a id="11198" href="Scoped.html#11181" class="Bound">x</a><a id="11199" class="Symbol">)</a>
<a id="11201" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11218" class="Symbol">(</a><a id="11219" href="Scoped.html#11219" class="Bound">A</a> <a id="11221" href="Scoped.html#1035" class="InductiveConstructor Operator">⇒</a> <a id="11223" href="Scoped.html#11223" class="Bound">B</a><a id="11224" class="Symbol">)</a>    <a id="11229" class="Symbol">=</a> <a id="11231" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11248" href="Scoped.html#11219" class="Bound">A</a> <a id="11250" href="Raw.html#881" class="InductiveConstructor Operator">⇒</a> <a id="11252" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11269" href="Scoped.html#11223" class="Bound">B</a>
<a id="11271" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11288" class="Symbol">(</a><a id="11289" href="Scoped.html#1081" class="InductiveConstructor">Π</a> <a id="11291" href="Scoped.html#11291" class="Bound">K</a> <a id="11293" href="Scoped.html#11293" class="Bound">A</a><a id="11294" class="Symbol">)</a>    <a id="11299" class="Symbol">=</a> <a id="11301" href="Raw.html#911" class="InductiveConstructor">Π</a> <a id="11303" href="Scoped.html#11291" class="Bound">K</a> <a id="11305" class="Symbol">(</a><a id="11306" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11323" href="Scoped.html#11293" class="Bound">A</a><a id="11324" class="Symbol">)</a>
<a id="11326" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11343" class="Symbol">(</a><a id="11344" href="Scoped.html#1127" class="InductiveConstructor">ƛ</a> <a id="11346" href="Scoped.html#11346" class="Bound">K</a> <a id="11348" href="Scoped.html#11348" class="Bound">A</a><a id="11349" class="Symbol">)</a>    <a id="11354" class="Symbol">=</a> <a id="11356" href="Raw.html#940" class="InductiveConstructor">ƛ</a> <a id="11358" href="Scoped.html#11346" class="Bound">K</a> <a id="11360" class="Symbol">(</a><a id="11361" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11378" href="Scoped.html#11348" class="Bound">A</a><a id="11379" class="Symbol">)</a>
<a id="11381" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11398" class="Symbol">(</a><a id="11399" href="Scoped.html#11399" class="Bound">A</a> <a id="11401" href="Scoped.html#1173" class="InductiveConstructor Operator">·</a> <a id="11403" href="Scoped.html#11403" class="Bound">B</a><a id="11404" class="Symbol">)</a>    <a id="11409" class="Symbol">=</a> <a id="11411" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11428" href="Scoped.html#11399" class="Bound">A</a> <a id="11430" href="Raw.html#969" class="InductiveConstructor Operator">·</a> <a id="11432" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11449" href="Scoped.html#11403" class="Bound">B</a>
<a id="11451" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11468" class="Symbol">(</a><a id="11469" href="Scoped.html#1219" class="InductiveConstructor">con</a> <a id="11473" class="Symbol">(</a><a id="11474" href="Builtin.Constant.Type.html#885" class="InductiveConstructor">atomic</a> <a id="11481" href="Scoped.html#11481" class="Bound">x</a><a id="11482" class="Symbol">))</a> <a id="11485" class="Symbol">=</a> <a id="11487" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="11491" class="Symbol">(</a><a id="11492" href="Raw.html#1262" class="InductiveConstructor">atomic</a> <a id="11499" href="Scoped.html#11481" class="Bound">x</a><a id="11500" class="Symbol">)</a>
<a id="11502" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11519" class="Symbol">(</a><a id="11520" href="Scoped.html#1219" class="InductiveConstructor">con</a> <a id="11524" href="Builtin.Constant.Type.html#922" class="InductiveConstructor">list</a><a id="11528" class="Symbol">)</a> <a id="11530" class="Symbol">=</a> <a id="11532" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="11536" href="Raw.html#1300" class="InductiveConstructor">list</a>
<a id="11541" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11558" class="Symbol">(</a><a id="11559" href="Scoped.html#1219" class="InductiveConstructor">con</a> <a id="11563" href="Builtin.Constant.Type.html#951" class="InductiveConstructor">pair</a><a id="11567" class="Symbol">)</a> <a id="11569" class="Symbol">=</a> <a id="11571" href="Raw.html#999" class="InductiveConstructor">con</a> <a id="11575" href="Raw.html#1324" class="InductiveConstructor">pair</a>
<a id="11580" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11597" class="Symbol">(</a><a id="11598" href="Scoped.html#1256" class="InductiveConstructor">μ</a> <a id="11600" href="Scoped.html#11600" class="Bound">A</a> <a id="11602" href="Scoped.html#11602" class="Bound">B</a><a id="11603" class="Symbol">)</a>    <a id="11608" class="Symbol">=</a> <a id="11610" href="Raw.html#1024" class="InductiveConstructor">μ</a> <a id="11612" class="Symbol">(</a><a id="11613" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11630" href="Scoped.html#11600" class="Bound">A</a><a id="11631" class="Symbol">)</a> <a id="11633" class="Symbol">(</a><a id="11634" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11651" href="Scoped.html#11602" class="Bound">B</a><a id="11652" class="Symbol">)</a>
<a id="11654" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11671" class="Symbol">(</a><a id="11672" href="Scoped.html#1302" class="InductiveConstructor">SOP</a> <a id="11676" href="Scoped.html#11676" class="Bound">Tss</a><a id="11679" class="Symbol">)</a>  <a id="11682" class="Symbol">=</a> <a id="11684" href="Raw.html#1054" class="InductiveConstructor">SOP</a> <a id="11688" class="Symbol">(</a><a id="11689" href="Scoped.html#11081" class="Function">extricateScopeTyListList</a> <a id="11714" href="Scoped.html#11676" class="Bound">Tss</a><a id="11717" class="Symbol">)</a>

<a id="11720" href="Scoped.html#11020" class="Function">extricateScopeTyList</a> <a id="11741" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="11744" class="Symbol">=</a> <a id="11746" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="11749" href="Scoped.html#11020" class="Function">extricateScopeTyList</a> <a id="11770" class="Symbol">(</a><a id="11771" href="Scoped.html#11771" class="Bound">x</a> <a id="11773" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="11775" href="Scoped.html#11775" class="Bound">xs</a><a id="11777" class="Symbol">)</a> <a id="11779" class="Symbol">=</a> <a id="11781" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="11798" href="Scoped.html#11771" class="Bound">x</a> <a id="11800" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="11802" href="Scoped.html#11020" class="Function">extricateScopeTyList</a> <a id="11823" href="Scoped.html#11775" class="Bound">xs</a>

<a id="11827" href="Scoped.html#11081" class="Function">extricateScopeTyListList</a> <a id="11852" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="11855" class="Symbol">=</a> <a id="11857" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="11860" href="Scoped.html#11081" class="Function">extricateScopeTyListList</a> <a id="11885" class="Symbol">(</a><a id="11886" href="Scoped.html#11886" class="Bound">xs</a> <a id="11889" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="11891" href="Scoped.html#11891" class="Bound">xss</a><a id="11894" class="Symbol">)</a> <a id="11896" class="Symbol">=</a> <a id="11898" href="Scoped.html#11020" class="Function">extricateScopeTyList</a> <a id="11919" href="Scoped.html#11886" class="Bound">xs</a> <a id="11922" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="11924" href="Scoped.html#11081" class="Function">extricateScopeTyListList</a> <a id="11949" href="Scoped.html#11891" class="Bound">xss</a>

<a id="extricateScope"></a><a id="11954" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="11969" class="Symbol">:</a> <a id="11971" class="Symbol">∀{</a><a id="11973" href="Scoped.html#11973" class="Bound">n</a><a id="11974" class="Symbol">}{</a><a id="11976" href="Scoped.html#11976" class="Bound">w</a> <a id="11978" class="Symbol">:</a> <a id="11980" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="11987" href="Scoped.html#11973" class="Bound">n</a><a id="11988" class="Symbol">}</a> <a id="11990" class="Symbol">→</a> <a id="11992" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="12001" href="Scoped.html#11976" class="Bound">w</a> <a id="12003" class="Symbol">→</a> <a id="12005" href="Raw.html#1435" class="Datatype">RawTm</a>
<a id="extricateScopeList"></a><a id="12011" href="Scoped.html#12011" class="Function">extricateScopeList</a>  <a id="12031" class="Symbol">:</a> <a id="12033" class="Symbol">∀{</a><a id="12035" href="Scoped.html#12035" class="Bound">n</a><a id="12036" class="Symbol">}{</a><a id="12038" href="Scoped.html#12038" class="Bound">w</a> <a id="12040" class="Symbol">:</a> <a id="12042" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="12049" href="Scoped.html#12035" class="Bound">n</a><a id="12050" class="Symbol">}</a> <a id="12052" class="Symbol">→</a> <a id="12054" href="Utils.html#4983" class="Datatype">List</a> <a id="12059" class="Symbol">(</a><a id="12060" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="12069" href="Scoped.html#12038" class="Bound">w</a><a id="12070" class="Symbol">)</a> <a id="12072" class="Symbol">→</a> <a id="12074" href="Utils.html#4983" class="Datatype">List</a> <a id="12079" href="Raw.html#1435" class="Datatype">RawTm</a>

<a id="12086" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12101" class="Symbol">(</a><a id="12102" href="Scoped.html#6939" class="InductiveConstructor">`</a> <a id="12104" href="Scoped.html#12104" class="Bound">x</a><a id="12105" class="Symbol">)</a> <a id="12107" class="Symbol">=</a> <a id="12109" href="Raw.html#1455" class="InductiveConstructor">`</a> <a id="12111" class="Symbol">(</a><a id="12112" href="Scoped.html#2010" class="Function">WeirdFintoℕ</a> <a id="12124" href="Scoped.html#12104" class="Bound">x</a><a id="12125" class="Symbol">)</a>
<a id="12127" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12142" class="Symbol">(</a><a id="12143" href="Scoped.html#6975" class="InductiveConstructor">Λ</a> <a id="12145" href="Scoped.html#12145" class="Bound">K</a> <a id="12147" href="Scoped.html#12147" class="Bound">t</a><a id="12148" class="Symbol">)</a> <a id="12150" class="Symbol">=</a> <a id="12152" href="Raw.html#1483" class="InductiveConstructor">Λ</a> <a id="12154" href="Scoped.html#12145" class="Bound">K</a> <a id="12156" class="Symbol">(</a><a id="12157" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12172" href="Scoped.html#12147" class="Bound">t</a><a id="12173" class="Symbol">)</a>
<a id="12175" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12190" class="Symbol">(</a><a id="12191" href="Scoped.html#12191" class="Bound">t</a> <a id="12193" href="Scoped.html#7022" class="InductiveConstructor Operator">·⋆</a> <a id="12196" href="Scoped.html#12196" class="Bound">A</a><a id="12197" class="Symbol">)</a> <a id="12199" class="Symbol">=</a> <a id="12201" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12216" href="Scoped.html#12191" class="Bound">t</a> <a id="12218" href="Raw.html#1522" class="InductiveConstructor Operator">·⋆</a> <a id="12221" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="12238" href="Scoped.html#12196" class="Bound">A</a>
<a id="12240" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12255" class="Symbol">(</a><a id="12256" href="Scoped.html#7071" class="InductiveConstructor">ƛ</a> <a id="12258" href="Scoped.html#12258" class="Bound">A</a> <a id="12260" href="Scoped.html#12260" class="Bound">t</a><a id="12261" class="Symbol">)</a> <a id="12263" class="Symbol">=</a> <a id="12265" href="Raw.html#1562" class="InductiveConstructor">ƛ</a> <a id="12267" class="Symbol">(</a><a id="12268" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="12285" href="Scoped.html#12258" class="Bound">A</a><a id="12286" class="Symbol">)</a> <a id="12288" class="Symbol">(</a><a id="12289" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12304" href="Scoped.html#12260" class="Bound">t</a><a id="12305" class="Symbol">)</a>
<a id="12307" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12322" class="Symbol">(</a><a id="12323" href="Scoped.html#12323" class="Bound">t</a> <a id="12325" href="Scoped.html#7124" class="InductiveConstructor Operator">·</a> <a id="12327" href="Scoped.html#12327" class="Bound">u</a><a id="12328" class="Symbol">)</a> <a id="12330" class="Symbol">=</a> <a id="12332" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12347" href="Scoped.html#12323" class="Bound">t</a> <a id="12349" href="Raw.html#1602" class="InductiveConstructor Operator">·</a> <a id="12351" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12366" href="Scoped.html#12327" class="Bound">u</a>
<a id="12368" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12383" class="Symbol">(</a><a id="12384" href="Scoped.html#7173" class="InductiveConstructor">con</a> <a id="12388" href="Scoped.html#12388" class="Bound">c</a><a id="12389" class="Symbol">)</a> <a id="12391" class="Symbol">=</a> <a id="12393" href="Raw.html#1642" class="InductiveConstructor">con</a> <a id="12397" class="Symbol">(</a><a id="12398" href="RawU.html#10943" class="Function">tmCon2TagCon</a> <a id="12411" href="Scoped.html#12388" class="Bound">c</a><a id="12412" class="Symbol">)</a>
<a id="12414" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12429" class="Symbol">(</a><a id="12430" href="Scoped.html#7204" class="InductiveConstructor">error</a> <a id="12436" href="Scoped.html#12436" class="Bound">A</a><a id="12437" class="Symbol">)</a> <a id="12439" class="Symbol">=</a> <a id="12441" href="Raw.html#1675" class="InductiveConstructor">error</a> <a id="12447" class="Symbol">(</a><a id="12448" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="12465" href="Scoped.html#12436" class="Bound">A</a><a id="12466" class="Symbol">)</a>
<a id="12468" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12483" class="Symbol">(</a><a id="12484" href="Scoped.html#7240" class="InductiveConstructor">builtin</a> <a id="12492" href="Scoped.html#12492" class="Bound">bn</a><a id="12494" class="Symbol">)</a> <a id="12496" class="Symbol">=</a> <a id="12498" href="Raw.html#1707" class="InductiveConstructor">builtin</a> <a id="12506" href="Scoped.html#12492" class="Bound">bn</a>
<a id="12509" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12524" class="Symbol">(</a><a id="12525" href="Scoped.html#7279" class="InductiveConstructor">wrap</a> <a id="12530" href="Scoped.html#12530" class="Bound">pat</a> <a id="12534" href="Scoped.html#12534" class="Bound">arg</a> <a id="12538" href="Scoped.html#12538" class="Bound">t</a><a id="12539" class="Symbol">)</a> <a id="12541" class="Symbol">=</a>
  <a id="12545" href="Raw.html#1741" class="InductiveConstructor">wrap</a> <a id="12550" class="Symbol">(</a><a id="12551" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="12568" href="Scoped.html#12530" class="Bound">pat</a><a id="12571" class="Symbol">)</a> <a id="12573" class="Symbol">(</a><a id="12574" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="12591" href="Scoped.html#12534" class="Bound">arg</a><a id="12594" class="Symbol">)</a> <a id="12596" class="Symbol">(</a><a id="12597" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12612" href="Scoped.html#12538" class="Bound">t</a><a id="12613" class="Symbol">)</a>
<a id="12615" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12630" class="Symbol">(</a><a id="12631" href="Scoped.html#7341" class="InductiveConstructor">unwrap</a> <a id="12638" href="Scoped.html#12638" class="Bound">t</a><a id="12639" class="Symbol">)</a> <a id="12641" class="Symbol">=</a> <a id="12643" href="Raw.html#1789" class="InductiveConstructor">unwrap</a> <a id="12650" class="Symbol">(</a><a id="12651" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12666" href="Scoped.html#12638" class="Bound">t</a><a id="12667" class="Symbol">)</a>
<a id="12669" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12684" class="Symbol">(</a><a id="12685" href="Scoped.html#7377" class="InductiveConstructor">constr</a> <a id="12692" href="Scoped.html#12692" class="Bound">A</a> <a id="12694" href="Scoped.html#12694" class="Bound">i</a> <a id="12696" href="Scoped.html#12696" class="Bound">cs</a><a id="12698" class="Symbol">)</a> <a id="12700" class="Symbol">=</a> <a id="12702" href="Raw.html#1821" class="InductiveConstructor">constr</a> <a id="12709" class="Symbol">(</a><a id="12710" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="12727" href="Scoped.html#12692" class="Bound">A</a><a id="12728" class="Symbol">)</a> <a id="12730" href="Scoped.html#12694" class="Bound">i</a> <a id="12732" class="Symbol">(</a><a id="12733" href="Scoped.html#12011" class="Function">extricateScopeList</a> <a id="12752" href="Scoped.html#12696" class="Bound">cs</a><a id="12754" class="Symbol">)</a>
<a id="12756" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12771" class="Symbol">(</a><a id="12772" href="Scoped.html#7462" class="InductiveConstructor">case</a> <a id="12777" href="Scoped.html#12777" class="Bound">A</a> <a id="12779" href="Scoped.html#12779" class="Bound">x</a> <a id="12781" href="Scoped.html#12781" class="Bound">cs</a><a id="12783" class="Symbol">)</a> <a id="12785" class="Symbol">=</a> <a id="12787" href="Raw.html#1889" class="InductiveConstructor">case</a> <a id="12792" class="Symbol">(</a><a id="12793" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="12810" href="Scoped.html#12777" class="Bound">A</a><a id="12811" class="Symbol">)</a> <a id="12813" class="Symbol">(</a><a id="12814" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12829" href="Scoped.html#12779" class="Bound">x</a><a id="12830" class="Symbol">)</a> <a id="12832" class="Symbol">(</a><a id="12833" href="Scoped.html#12011" class="Function">extricateScopeList</a> <a id="12852" href="Scoped.html#12781" class="Bound">cs</a><a id="12854" class="Symbol">)</a>

<a id="12857" href="Scoped.html#12011" class="Function">extricateScopeList</a> <a id="12876" href="Utils.html#5012" class="InductiveConstructor">[]</a> <a id="12879" class="Symbol">=</a> <a id="12881" href="Utils.html#5012" class="InductiveConstructor">[]</a>
<a id="12884" href="Scoped.html#12011" class="Function">extricateScopeList</a> <a id="12903" class="Symbol">(</a><a id="12904" href="Scoped.html#12904" class="Bound">x</a> <a id="12906" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="12908" href="Scoped.html#12908" class="Bound">xs</a><a id="12910" class="Symbol">)</a> <a id="12912" class="Symbol">=</a> <a id="12914" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="12929" href="Scoped.html#12904" class="Bound">x</a> <a id="12931" href="Utils.html#5027" class="InductiveConstructor Operator">∷</a> <a id="12933" href="Scoped.html#12011" class="Function">extricateScopeList</a> <a id="12952" href="Scoped.html#12908" class="Bound">xs</a>
</pre>
<p>– UGLY PRINTING</p>

<pre class="Agda"><a id="uglyWeirdFin"></a><a id="12982" href="Scoped.html#12982" class="Function">uglyWeirdFin</a> <a id="12995" class="Symbol">:</a> <a id="12997" class="Symbol">∀{</a><a id="12999" href="Scoped.html#12999" class="Bound">n</a><a id="13000" class="Symbol">}{</a><a id="13002" href="Scoped.html#13002" class="Bound">w</a> <a id="13004" class="Symbol">:</a> <a id="13006" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="13013" href="Scoped.html#12999" class="Bound">n</a><a id="13014" class="Symbol">}</a> <a id="13016" class="Symbol">→</a> <a id="13018" href="Scoped.html#1547" class="Datatype">WeirdFin</a> <a id="13027" href="Scoped.html#13002" class="Bound">w</a> <a id="13029" class="Symbol">→</a> <a id="13031" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="13038" href="Scoped.html#12982" class="Function">uglyWeirdFin</a> <a id="13051" href="Scoped.html#1588" class="InductiveConstructor">Z</a> <a id="13053" class="Symbol">=</a> <a id="13055" class="String">&quot;0&quot;</a>
<a id="13059" href="Scoped.html#12982" class="Function">uglyWeirdFin</a> <a id="13072" class="Symbol">(</a><a id="13073" href="Scoped.html#1685" class="InductiveConstructor">T</a> <a id="13075" href="Scoped.html#13075" class="Bound">x</a><a id="13076" class="Symbol">)</a> <a id="13078" class="Symbol">=</a> <a id="13080" class="String">&quot;(T &quot;</a> <a id="13086" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13089" href="Scoped.html#12982" class="Function">uglyWeirdFin</a> <a id="13102" href="Scoped.html#13075" class="Bound">x</a> <a id="13104" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13107" class="String">&quot;)&quot;</a>
<a id="13111" href="Scoped.html#12982" class="Function">uglyWeirdFin</a> <a id="13124" class="Symbol">(</a><a id="13125" href="Scoped.html#1630" class="InductiveConstructor">S</a> <a id="13127" href="Scoped.html#13127" class="Bound">x</a><a id="13128" class="Symbol">)</a> <a id="13130" class="Symbol">=</a> <a id="13132" class="String">&quot;(S &quot;</a> <a id="13138" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13141" href="Scoped.html#12982" class="Function">uglyWeirdFin</a> <a id="13154" href="Scoped.html#13127" class="Bound">x</a> <a id="13156" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13159" class="String">&quot;)&quot;</a>

<a id="uglyTmCon"></a><a id="13164" href="Scoped.html#13164" class="Function">uglyTmCon</a> <a id="13174" class="Symbol">:</a> <a id="13176" href="RawU.html#7639" class="Datatype">TmCon</a> <a id="13182" class="Symbol">→</a> <a id="13184" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="13191" href="Scoped.html#13164" class="Function">uglyTmCon</a> <a id="13201" class="Symbol">(</a><a id="13202" href="RawU.html#7660" class="InductiveConstructor">tmCon</a> <a id="13208" href="Builtin.Signature.html#2533" class="InductiveConstructor">integer</a> <a id="13216" href="Scoped.html#13216" class="Bound">x</a><a id="13217" class="Symbol">)</a> <a id="13219" class="Symbol">=</a> <a id="13221" class="String">&quot;(integer &quot;</a> <a id="13233" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13236" href="Scoped.html#219" class="Function">ishow</a> <a id="13242" href="Scoped.html#13216" class="Bound">x</a> <a id="13244" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13247" class="String">&quot;)&quot;</a>
<a id="13251" href="Scoped.html#13164" class="Function">uglyTmCon</a> <a id="13261" class="Symbol">(</a><a id="13262" href="RawU.html#7660" class="InductiveConstructor">tmCon</a> <a id="13268" href="Builtin.Signature.html#2580" class="InductiveConstructor">bytestring</a> <a id="13279" href="Scoped.html#13279" class="Bound">x</a><a id="13280" class="Symbol">)</a> <a id="13282" class="Symbol">=</a> <a id="13284" class="String">&quot;bytestring&quot;</a>
<a id="13297" href="Scoped.html#13164" class="CatchallClause Function">uglyTmCon</a><a id="13306" class="CatchallClause"> </a><a id="13307" href="Scoped.html#13307" class="CatchallClause Bound">size</a> <a id="13312" class="Symbol">=</a> <a id="13314" class="String">&quot;size&quot;</a>


<a id="13323" class="Keyword">postulate</a> <a id="showNat"></a><a id="13333" href="Scoped.html#13333" class="Postulate">showNat</a> <a id="13341" class="Symbol">:</a> <a id="13343" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="13345" class="Symbol">→</a> <a id="13347" href="Agda.Builtin.String.html#335" class="Postulate">String</a>

<a id="13355" class="Symbol">{-#</a> <a id="13359" class="Keyword">FOREIGN</a> <a id="13367" class="Pragma">GHC</a> <a id="13371" class="Pragma">import</a> <a id="13378" class="Pragma">qualified</a> <a id="13388" class="Pragma">Data.Text</a> <a id="13398" class="Pragma">as</a> <a id="13401" class="Pragma">T</a> <a id="13403" class="Symbol">#-}</a>
<a id="13407" class="Symbol">{-#</a> <a id="13411" class="Keyword">COMPILE</a> <a id="13419" class="Keyword">GHC</a> <a id="13423" href="Scoped.html#13333" class="Postulate">showNat</a> <a id="13431" class="Pragma">=</a> <a id="13433" class="Pragma">T.pack</a> <a id="13440" class="Pragma">.</a> <a id="13442" class="Pragma">show</a> <a id="13447" class="Symbol">#-}</a>

<a id="uglyBuiltin"></a><a id="13452" href="Scoped.html#13452" class="Function">uglyBuiltin</a> <a id="13464" class="Symbol">:</a> <a id="13466" href="Builtin.html#1212" class="Datatype">Builtin</a> <a id="13474" class="Symbol">→</a> <a id="13476" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="13483" href="Scoped.html#13452" class="Function">uglyBuiltin</a> <a id="13495" href="Builtin.html#1248" class="InductiveConstructor">addInteger</a> <a id="13506" class="Symbol">=</a> <a id="13508" class="String">&quot;addInteger&quot;</a>
<a id="13521" href="Scoped.html#13452" class="CatchallClause Function">uglyBuiltin</a><a id="13532" class="CatchallClause"> </a><a id="13533" class="CatchallClause Symbol">_</a> <a id="13535" class="Symbol">=</a> <a id="13537" class="String">&quot;other&quot;</a>
<a id="ugly"></a><a id="13545" href="Scoped.html#13545" class="Function">ugly</a> <a id="13550" class="Symbol">:</a> <a id="13552" class="Symbol">∀{</a><a id="13554" href="Scoped.html#13554" class="Bound">n</a><a id="13555" class="Symbol">}{</a><a id="13557" href="Scoped.html#13557" class="Bound">w</a> <a id="13559" class="Symbol">:</a> <a id="13561" href="Scoped.html#1416" class="Datatype">Weirdℕ</a> <a id="13568" href="Scoped.html#13554" class="Bound">n</a><a id="13569" class="Symbol">}</a> <a id="13571" class="Symbol">→</a> <a id="13573" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="13582" href="Scoped.html#13557" class="Bound">w</a> <a id="13584" class="Symbol">→</a> <a id="13586" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="13593" href="Scoped.html#13545" class="Function">ugly</a> <a id="13598" class="Symbol">(</a><a id="13599" href="Scoped.html#6939" class="InductiveConstructor">`</a> <a id="13601" href="Scoped.html#13601" class="Bound">x</a><a id="13602" class="Symbol">)</a> <a id="13604" class="Symbol">=</a> <a id="13606" class="String">&quot;(` &quot;</a> <a id="13612" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13615" href="Scoped.html#12982" class="Function">uglyWeirdFin</a> <a id="13628" href="Scoped.html#13601" class="Bound">x</a> <a id="13630" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13633" class="String">&quot;)&quot;</a>
<a id="13637" href="Scoped.html#13545" class="Function">ugly</a> <a id="13642" class="Symbol">(</a><a id="13643" href="Scoped.html#7071" class="InductiveConstructor">ƛ</a> <a id="13645" class="Symbol">_</a> <a id="13647" href="Scoped.html#13647" class="Bound">t</a><a id="13648" class="Symbol">)</a> <a id="13650" class="Symbol">=</a> <a id="13652" class="String">&quot;(ƛ &quot;</a> <a id="13658" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13661" href="Scoped.html#13545" class="Function">ugly</a> <a id="13666" href="Scoped.html#13647" class="Bound">t</a> <a id="13668" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13671" class="String">&quot;)&quot;</a>
<a id="13675" href="Scoped.html#13545" class="Function">ugly</a> <a id="13680" class="Symbol">(</a><a id="13681" href="Scoped.html#13681" class="Bound">t</a> <a id="13683" href="Scoped.html#7124" class="InductiveConstructor Operator">·</a> <a id="13685" href="Scoped.html#13685" class="Bound">u</a><a id="13686" class="Symbol">)</a> <a id="13688" class="Symbol">=</a> <a id="13690" class="String">&quot;( &quot;</a> <a id="13695" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13698" href="Scoped.html#13545" class="Function">ugly</a> <a id="13703" href="Scoped.html#13681" class="Bound">t</a> <a id="13705" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13708" class="String">&quot; · &quot;</a> <a id="13714" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13717" href="Scoped.html#13545" class="Function">ugly</a> <a id="13722" href="Scoped.html#13685" class="Bound">u</a> <a id="13724" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13727" class="String">&quot;)&quot;</a>
<a id="13731" href="Scoped.html#13545" class="Function">ugly</a> <a id="13736" class="Symbol">(</a><a id="13737" href="Scoped.html#6975" class="InductiveConstructor">Λ</a> <a id="13739" class="Symbol">_</a> <a id="13741" href="Scoped.html#13741" class="Bound">t</a><a id="13742" class="Symbol">)</a> <a id="13744" class="Symbol">=</a> <a id="13746" class="String">&quot;(Λ &quot;</a> <a id="13752" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13755" href="Scoped.html#13545" class="Function">ugly</a> <a id="13760" href="Scoped.html#13741" class="Bound">t</a> <a id="13762" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13765" class="String">&quot;)&quot;</a>
<a id="13769" href="Scoped.html#13545" class="Function">ugly</a> <a id="13774" class="Symbol">(</a><a id="13775" href="Scoped.html#13775" class="Bound">t</a> <a id="13777" href="Scoped.html#7022" class="InductiveConstructor Operator">·⋆</a> <a id="13780" href="Scoped.html#13780" class="Bound">A</a><a id="13781" class="Symbol">)</a> <a id="13783" class="Symbol">=</a> <a id="13785" class="String">&quot;( &quot;</a> <a id="13790" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13793" href="Scoped.html#13545" class="Function">ugly</a> <a id="13798" href="Scoped.html#13775" class="Bound">t</a> <a id="13800" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13803" class="String">&quot; ·⋆ &quot;</a> <a id="13810" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13813" class="String">&quot;TYPE&quot;</a> <a id="13820" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13823" class="String">&quot;)&quot;</a>

<a id="13828" href="Scoped.html#13545" class="Function">ugly</a> <a id="13833" class="Symbol">(</a><a id="13834" href="Scoped.html#7173" class="InductiveConstructor">con</a> <a id="13838" href="Scoped.html#13838" class="Bound">c</a><a id="13839" class="Symbol">)</a> <a id="13841" class="Symbol">=</a> <a id="13843" class="String">&quot;(con &quot;</a> <a id="13851" class="Comment">-- ++ uglyTermCon c ++ &quot;)&quot;</a>
<a id="13878" href="Scoped.html#13545" class="Function">ugly</a> <a id="13883" class="Symbol">(</a><a id="13884" href="Scoped.html#7240" class="InductiveConstructor">builtin</a> <a id="13892" href="Scoped.html#13892" class="Bound">b</a><a id="13893" class="Symbol">)</a> <a id="13895" class="Symbol">=</a> <a id="13897" class="String">&quot;builtin &quot;</a> <a id="13908" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="13911" href="Scoped.html#13452" class="Function">uglyBuiltin</a> <a id="13923" href="Scoped.html#13892" class="Bound">b</a>
<a id="13925" class="Comment">{-  &quot;(builtin &quot; ++
  uglyBuiltin b ++
  &quot; &quot; ++
  ishow (Data.Integer.ℤ.pos (Data.List.length As)) ++
  &quot; &quot; ++
  ishow (Data.Integer.ℤ.pos (Data.List.length ts))
  ++ &quot;)&quot; -}</a>
<a id="14098" href="Scoped.html#13545" class="Function">ugly</a> <a id="14103" class="Symbol">(</a><a id="14104" href="Scoped.html#7204" class="InductiveConstructor">error</a> <a id="14110" class="Symbol">_)</a> <a id="14113" class="Symbol">=</a> <a id="14115" class="String">&quot;error _&quot;</a>
<a id="14125" href="Scoped.html#13545" class="Function">ugly</a> <a id="14130" class="Symbol">(</a><a id="14131" href="Scoped.html#7279" class="InductiveConstructor">wrap</a> <a id="14136" class="Symbol">_</a> <a id="14138" class="Symbol">_</a> <a id="14140" href="Scoped.html#14140" class="Bound">t</a><a id="14141" class="Symbol">)</a> <a id="14143" class="Symbol">=</a> <a id="14145" class="String">&quot;(wrap &quot;</a> <a id="14154" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="14157" href="Scoped.html#13545" class="Function">ugly</a> <a id="14162" href="Scoped.html#14140" class="Bound">t</a> <a id="14164" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="14167" class="String">&quot;)&quot;</a>
<a id="14171" href="Scoped.html#13545" class="Function">ugly</a> <a id="14176" class="Symbol">(</a><a id="14177" href="Scoped.html#7341" class="InductiveConstructor">unwrap</a> <a id="14184" href="Scoped.html#14184" class="Bound">t</a><a id="14185" class="Symbol">)</a> <a id="14187" class="Symbol">=</a> <a id="14189" class="String">&quot;(unwrap &quot;</a> <a id="14200" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="14203" href="Scoped.html#13545" class="Function">ugly</a> <a id="14208" href="Scoped.html#14184" class="Bound">t</a> <a id="14210" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="14213" class="String">&quot;)&quot;</a>
<a id="14217" href="Scoped.html#13545" class="Function">ugly</a> <a id="14222" class="Symbol">(</a><a id="14223" href="Scoped.html#7377" class="InductiveConstructor">constr</a> <a id="14230" href="Scoped.html#14230" class="Bound">A</a> <a id="14232" href="Scoped.html#14232" class="Bound">i</a> <a id="14234" href="Scoped.html#14234" class="Bound">cs</a><a id="14236" class="Symbol">)</a> <a id="14238" class="Symbol">=</a> <a id="14240" class="String">&quot;constr&quot;</a> <a id="14249" class="Comment">-- TODO: Do it better</a>
<a id="14271" href="Scoped.html#13545" class="Function">ugly</a> <a id="14276" class="Symbol">(</a><a id="14277" href="Scoped.html#7462" class="InductiveConstructor">case</a> <a id="14282" href="Scoped.html#14282" class="Bound">A</a> <a id="14284" href="Scoped.html#14284" class="Bound">x</a> <a id="14286" href="Scoped.html#14286" class="Bound">cs</a><a id="14288" class="Symbol">)</a>   <a id="14292" class="Symbol">=</a> <a id="14294" class="String">&quot;case&quot;</a>   <a id="14303" class="Comment">-- TODO: Do it better</a>
</pre>

    </section>
  </body>
</html>