<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CEK Machine with Costs</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>CEK Machine with Costs</h1>
    <section>
      <h1 id="cek-machine-with-costs">CEK Machine with costs</h1>

<p>This module implements a CEK machine for UPLC which computes costs.</p>

<pre class="Agda"><a id="151" class="Keyword">open</a> <a id="156" class="Keyword">import</a> <a id="163" href="Cost.Base.html" class="Module">Cost.Base</a>

<a id="174" class="Keyword">module</a> <a id="181" href="Untyped.CEKWithCost.html" class="Module">Untyped.CEKWithCost</a> <a id="201" class="Symbol">{</a><a id="202" href="Untyped.CEKWithCost.html#202" class="Bound">Budget</a> <a id="209" class="Symbol">:</a> <a id="211" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="214" class="Symbol">}(</a><a id="216" href="Untyped.CEKWithCost.html#216" class="Bound">machineParameters</a> <a id="234" class="Symbol">:</a> <a id="236" href="Cost.Base.html#2070" class="Record">MachineParameters</a> <a id="254" href="Untyped.CEKWithCost.html#202" class="Bound">Budget</a><a id="260" class="Symbol">)</a> <a id="262" class="Keyword">where</a>
</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="289" class="Keyword">open</a> <a id="294" class="Keyword">import</a> <a id="301" href="Data.Unit.html" class="Module">Data.Unit</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a><a id="319" class="Symbol">;</a><a id="320" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="322" class="Symbol">)</a>
<a id="324" class="Keyword">open</a> <a id="329" class="Keyword">import</a> <a id="336" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="345" class="Keyword">using</a> <a id="351" class="Symbol">(</a><a id="352" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="353" class="Symbol">;</a><a id="354" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="358" class="Symbol">;</a><a id="359" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a><a id="362" class="Symbol">)</a>
<a id="364" class="Keyword">open</a> <a id="369" class="Keyword">import</a> <a id="376" href="Data.List.html" class="Module">Data.List</a> <a id="386" class="Keyword">using</a> <a id="392" class="Symbol">(</a><a id="393" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="397" class="Symbol">;</a><a id="398" href="Data.List.Base.html#10392" class="InductiveConstructor">[]</a><a id="400" class="Symbol">;</a><a id="401" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="404" class="Symbol">)</a>
<a id="406" class="Keyword">open</a> <a id="411" class="Keyword">import</a> <a id="418" href="Data.Vec.html" class="Module">Data.Vec</a> <a id="427" class="Keyword">using</a> <a id="433" class="Symbol">(</a><a id="434" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a><a id="437" class="Symbol">;</a><a id="438" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a><a id="440" class="Symbol">;</a><a id="441" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">_∷_</a><a id="444" class="Symbol">;</a><a id="445" href="Data.Vec.Base.html#7783" class="Function">reverse</a><a id="452" class="Symbol">)</a>
<a id="454" class="Keyword">open</a> <a id="459" class="Keyword">import</a> <a id="466" href="Data.Product.html" class="Module">Data.Product</a> <a id="479" class="Keyword">using</a> <a id="485" class="Symbol">(</a><a id="486" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a><a id="489" class="Symbol">)</a>
<a id="491" class="Keyword">open</a> <a id="496" class="Keyword">import</a> <a id="503" href="Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="541" class="Keyword">using</a> <a id="547" class="Symbol">(</a><a id="548" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">_≡_</a><a id="551" class="Symbol">;</a><a id="552" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a><a id="556" class="Symbol">;</a><a id="557" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a><a id="560" class="Symbol">)</a>

<a id="563" class="Keyword">open</a> <a id="568" class="Keyword">import</a> <a id="575" href="Untyped.html" class="Module">Untyped</a> <a id="583" class="Keyword">using</a> <a id="589" class="Symbol">(</a><a id="590" href="Untyped.html#1295" class="Datatype Operator">_⊢</a><a id="592" class="Symbol">)</a>
<a id="594" class="Keyword">open</a> <a id="599" href="Untyped.html#1295" class="Module Operator">_⊢</a>
<a id="602" class="Keyword">open</a> <a id="607" class="Keyword">import</a> <a id="614" href="Utils.html" class="Module">Utils</a> <a id="620" class="Keyword">using</a> <a id="626" class="Symbol">(</a><a id="627" href="Utils.html#3952" class="Record">Writer</a><a id="633" class="Symbol">;</a><a id="634" href="Utils.html#2985" class="Function Operator">_&gt;&gt;_</a><a id="638" class="Symbol">;</a><a id="639" href="Utils.html#2941" class="Field Operator">_&gt;&gt;=_</a><a id="644" class="Symbol">;</a><a id="645" href="Utils.html#2913" class="Field">return</a><a id="651" class="Symbol">;</a><a id="652" href="Data.Maybe.Base.html#1371" class="Function">maybe</a><a id="657" class="Symbol">;</a><a id="658" href="Utils.html#1126" class="Datatype">Either</a><a id="664" class="Symbol">;</a><a id="665" href="Utils.html#1159" class="InductiveConstructor">inj₁</a><a id="669" class="Symbol">;</a><a id="670" href="Utils.html#1183" class="InductiveConstructor">inj₂</a><a id="674" class="Symbol">;</a><a id="675" href="Utils.html#4362" class="Datatype">RuntimeError</a><a id="687" class="Symbol">;</a><a id="688" href="Utils.html#4389" class="InductiveConstructor">gasError</a><a id="696" class="Symbol">;</a><a id="697" href="Utils.html#1263" class="Function">either</a><a id="703" class="Symbol">;</a><a id="704" href="Utils.html#2191" class="Datatype Operator">_∔_≣_</a><a id="709" class="Symbol">)</a>
<a id="711" class="Keyword">open</a> <a id="716" href="Utils.html#3952" class="Module">Writer</a>
<a id="723" class="Keyword">open</a> <a id="728" class="Keyword">import</a> <a id="735" href="RawU.html" class="Module">RawU</a> <a id="740" class="Keyword">using</a> <a id="746" class="Symbol">(</a><a id="747" href="RawU.html#7660" class="InductiveConstructor">tmCon</a><a id="752" class="Symbol">)</a>
<a id="754" class="Keyword">open</a> <a id="759" class="Keyword">import</a> <a id="766" href="Builtin.html" class="Module">Builtin</a> <a id="774" class="Keyword">using</a> <a id="780" class="Symbol">(</a><a id="781" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="788" class="Symbol">;</a><a id="789" href="Builtin.html#14034" class="Function">arity</a><a id="794" class="Symbol">;</a><a id="795" href="Builtin.html#7253" class="Function">signature</a><a id="804" class="Symbol">)</a>
<a id="806" class="Keyword">open</a> <a id="811" class="Keyword">import</a> <a id="818" href="Builtin.Signature.html" class="Module">Builtin.Signature</a> <a id="836" class="Keyword">using</a> <a id="842" class="Symbol">(</a><a id="843" href="Builtin.Signature.html#3990" class="Function">fv</a><a id="845" class="Symbol">;</a><a id="846" href="Builtin.Signature.html#3888" class="Function">args♯</a><a id="851" class="Symbol">)</a>

<a id="854" class="Keyword">open</a> <a id="859" href="Cost.Base.html#901" class="Module">StepKind</a>
<a id="868" class="Keyword">open</a> <a id="873" href="Cost.Base.html#1650" class="Module">ExBudgetCategory</a>

<a id="891" class="Keyword">open</a> <a id="896" class="Keyword">import</a> <a id="903" href="Untyped.CEK.html" class="Module">Untyped.CEK</a>

</pre>
<h2 id="cost-monad">Cost Monad</h2>

<p>We instantiate a Writer Monad with the operations from the machine parameters</p>

<pre class="Agda"><a id="1020" class="Keyword">open</a> <a id="1025" href="Cost.Base.html#2070" class="Module">MachineParameters</a> <a id="1043" href="Untyped.CEKWithCost.html#216" class="Bound">machineParameters</a> <a id="1061" class="Keyword">renaming</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Cost.Base.html#2176" class="Field">ε</a> <a id="1073" class="Symbol">to</a> <a id="1076" class="Field">e</a><a id="1077" class="Symbol">)</a>
<a id="1079" class="Keyword">open</a> <a id="1084" href="Utils.html#4059" class="Module">Utils.WriterMonad</a> <a id="1102" href="Untyped.CEKWithCost.html#1076" class="Field">e</a> <a id="1104" href="Cost.Base.html#2191" class="Field Operator">_∙_</a>

<a id="CekM"></a><a id="1109" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1114" class="Symbol">:</a> <a id="1116" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="1120" class="Symbol">→</a> <a id="1122" href="Agda.Primitive.html#388" class="Primitive">Set</a>
<a id="1126" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1131" class="Symbol">=</a> <a id="1133" href="Utils.html#3952" class="Record">Writer</a> <a id="1140" href="Untyped.CEKWithCost.html#202" class="Bound">Budget</a>
</pre>
<h3 id="spending-operations">Spending operations</h3>

<p>As opposed to the production implemention, our <code class="language-plaintext highlighter-rouge">spend</code> function does not implement slippage.
Slippage is an optimization that allows the interpreter to only add costs every n steps. 
Slippage is only semantically relevant in restricting mode (not currently implemented in agda), 
so we do not need to consider it here.</p>

<pre class="Agda"><a id="spend"></a><a id="1501" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="1507" class="Symbol">:</a> <a id="1509" href="Cost.Base.html#901" class="Datatype">StepKind</a> <a id="1518" class="Symbol">→</a> <a id="1520" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1525" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1527" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="1533" href="Untyped.CEKWithCost.html#1533" class="Bound">st</a> <a id="1536" class="Symbol">=</a> <a id="1538" href="Utils.html#4275" class="Function">tell</a> <a id="1543" class="Symbol">(</a><a id="1544" href="Cost.Base.html#2129" class="Field">cekMachineCost</a> <a id="1559" class="Symbol">(</a><a id="1560" href="Cost.Base.html#1726" class="InductiveConstructor">BStep</a> <a id="1566" href="Untyped.CEKWithCost.html#1533" class="Bound">st</a><a id="1568" class="Symbol">))</a>

<a id="spendStartupCost"></a><a id="1572" href="Untyped.CEKWithCost.html#1572" class="Function">spendStartupCost</a> <a id="1589" class="Symbol">:</a> <a id="1591" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="1596" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="1598" href="Untyped.CEKWithCost.html#1572" class="Function">spendStartupCost</a> <a id="1615" class="Symbol">=</a> <a id="1617" href="Utils.html#4275" class="Function">tell</a> <a id="1622" href="Cost.Base.html#2259" class="Function">startupCost</a>
</pre>
<p>In order to calculate the cost of executing a builtin, we obtain a vector with 
the size of each constant argument using <code class="language-plaintext highlighter-rouge">extractArgSizes</code>.</p>

<p>Non-constant argument should only occur in places where the builtin is polymorphic
and should be ignored by the cost model of the corresponding builtin. Therefore, 
they are added with a size of 0.</p>

<p>The function <code class="language-plaintext highlighter-rouge">extractArgSizes</code> get the arguments in inverse order, so we reverse 
them in the <code class="language-plaintext highlighter-rouge">spendBuiltin</code> function.</p>

<pre class="Agda"><a id="extractConstants"></a><a id="2105" href="Untyped.CEKWithCost.html#2105" class="Function">extractConstants</a> <a id="2122" class="Symbol">:</a> <a id="2124" class="Symbol">∀{</a><a id="2126" href="Untyped.CEKWithCost.html#2126" class="Bound">b</a><a id="2127" class="Symbol">}</a>
          <a id="2139" class="Symbol">→</a> <a id="2141" class="Symbol">∀{</a><a id="2143" href="Untyped.CEKWithCost.html#2143" class="Bound">tn</a> <a id="2146" href="Untyped.CEKWithCost.html#2146" class="Bound">tm</a><a id="2148" class="Symbol">}</a> <a id="2150" class="Symbol">→</a> <a id="2152" class="Symbol">{</a><a id="2153" href="Untyped.CEKWithCost.html#2153" class="Bound">pt</a> <a id="2156" class="Symbol">:</a> <a id="2158" href="Untyped.CEKWithCost.html#2143" class="Bound">tn</a> <a id="2161" href="Utils.html#2191" class="Datatype Operator">∔</a> <a id="2163" href="Untyped.CEKWithCost.html#2146" class="Bound">tm</a> <a id="2166" href="Utils.html#2191" class="Datatype Operator">≣</a> <a id="2168" href="Builtin.Signature.html#3990" class="Function">fv</a> <a id="2171" class="Symbol">(</a><a id="2172" href="Builtin.html#7253" class="Function">signature</a> <a id="2182" href="Untyped.CEKWithCost.html#2126" class="Bound">b</a><a id="2183" class="Symbol">)}</a>
          <a id="2196" class="Symbol">→</a> <a id="2198" class="Symbol">∀{</a><a id="2200" href="Untyped.CEKWithCost.html#2200" class="Bound">an</a> <a id="2203" href="Untyped.CEKWithCost.html#2203" class="Bound">am</a><a id="2205" class="Symbol">}</a> <a id="2207" class="Symbol">→</a> <a id="2209" class="Symbol">{</a><a id="2210" href="Untyped.CEKWithCost.html#2210" class="Bound">pa</a> <a id="2213" class="Symbol">:</a> <a id="2215" href="Untyped.CEKWithCost.html#2200" class="Bound">an</a> <a id="2218" href="Utils.html#2191" class="Datatype Operator">∔</a> <a id="2220" href="Untyped.CEKWithCost.html#2203" class="Bound">am</a> <a id="2223" href="Utils.html#2191" class="Datatype Operator">≣</a> <a id="2225" href="Builtin.Signature.html#3888" class="Function">args♯</a> <a id="2231" class="Symbol">(</a><a id="2232" href="Builtin.html#7253" class="Function">signature</a> <a id="2242" href="Untyped.CEKWithCost.html#2126" class="Bound">b</a><a id="2243" class="Symbol">)}</a>
          <a id="2256" class="Symbol">→</a> <a id="2258" href="Untyped.CEK.html#1367" class="Datatype">BApp</a> <a id="2263" href="Untyped.CEKWithCost.html#2126" class="Bound">b</a> <a id="2265" href="Untyped.CEKWithCost.html#2153" class="Bound">pt</a> <a id="2268" href="Untyped.CEKWithCost.html#2210" class="Bound">pa</a> <a id="2271" class="Symbol">→</a> <a id="2273" href="Data.Vec.Base.html#1007" class="Datatype">Vec</a> <a id="2277" href="Untyped.CEK.html#1264" class="Datatype">Value</a> <a id="2283" href="Untyped.CEKWithCost.html#2200" class="Bound">an</a>
<a id="2286" href="Untyped.CEKWithCost.html#2105" class="Function">extractConstants</a> <a id="2303" href="Untyped.CEK.html#2010" class="InductiveConstructor">base</a> <a id="2308" class="Symbol">=</a> <a id="2310" href="Data.Vec.Base.html#1043" class="InductiveConstructor">[]</a>
<a id="2313" href="Untyped.CEKWithCost.html#2105" class="Function">extractConstants</a> <a id="2330" class="Symbol">(</a><a id="2331" href="Untyped.CEK.html#2083" class="InductiveConstructor">app</a> <a id="2335" href="Untyped.CEKWithCost.html#2335" class="Bound">bapp</a> <a id="2340" href="Untyped.CEKWithCost.html#2340" class="Bound">v</a><a id="2341" class="Symbol">)</a> <a id="2343" class="Symbol">=</a> <a id="2345" href="Untyped.CEKWithCost.html#2340" class="Bound">v</a> <a id="2347" href="Data.Vec.Base.html#1062" class="InductiveConstructor Operator">∷</a> <a id="2349" href="Untyped.CEKWithCost.html#2105" class="Function">extractConstants</a> <a id="2366" href="Untyped.CEKWithCost.html#2335" class="Bound">bapp</a>
<a id="2371" href="Untyped.CEKWithCost.html#2105" class="Function">extractConstants</a> <a id="2388" class="Symbol">(</a><a id="2389" href="Untyped.CEK.html#2251" class="InductiveConstructor">app⋆</a> <a id="2394" href="Untyped.CEKWithCost.html#2394" class="Bound">bapp</a><a id="2398" class="Symbol">)</a> <a id="2400" class="Symbol">=</a> <a id="2402" href="Untyped.CEKWithCost.html#2105" class="Function">extractConstants</a> <a id="2419" href="Untyped.CEKWithCost.html#2394" class="Bound">bapp</a> 

<a id="spendBuiltin"></a><a id="2426" href="Untyped.CEKWithCost.html#2426" class="Function">spendBuiltin</a> <a id="2439" class="Symbol">:</a> <a id="2441" class="Symbol">(</a><a id="2442" href="Untyped.CEKWithCost.html#2442" class="Bound">b</a> <a id="2444" class="Symbol">:</a> <a id="2446" href="Builtin.html#1212" class="Datatype">Builtin</a><a id="2453" class="Symbol">)</a> <a id="2455" class="Symbol">→</a> <a id="2457" href="Untyped.CEK.html#4066" class="Function">fullyAppliedBuiltin</a> <a id="2477" href="Untyped.CEKWithCost.html#2442" class="Bound">b</a> <a id="2479" class="Symbol">→</a> <a id="2481" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="2486" href="Agda.Builtin.Unit.html#175" class="Record">⊤</a>
<a id="2488" href="Untyped.CEKWithCost.html#2426" class="Function">spendBuiltin</a> <a id="2501" href="Untyped.CEKWithCost.html#2501" class="Bound">b</a> <a id="2503" href="Untyped.CEKWithCost.html#2503" class="Bound">bapp</a> <a id="2508" class="Symbol">=</a> <a id="2510" href="Utils.html#4275" class="Function">tell</a> <a id="2515" class="Symbol">(</a><a id="2516" href="Cost.Base.html#2129" class="Field">cekMachineCost</a> <a id="2531" class="Symbol">(</a><a id="2532" href="Cost.Base.html#1833" class="InductiveConstructor">BBuiltinApp</a> <a id="2544" href="Untyped.CEKWithCost.html#2501" class="Bound">b</a> <a id="2546" href="Untyped.CEKWithCost.html#2568" class="Function">argsizes</a><a id="2554" class="Symbol">))</a>
     <a id="2562" class="Keyword">where</a> <a id="2568" href="Untyped.CEKWithCost.html#2568" class="Function">argsizes</a> <a id="2577" class="Symbol">=</a> <a id="2579" href="Data.Vec.Base.html#7783" class="Function">reverse</a> <a id="2587" class="Symbol">(</a><a id="2588" href="Untyped.CEKWithCost.html#2105" class="Function">extractConstants</a> <a id="2605" href="Untyped.CEKWithCost.html#2503" class="Bound">bapp</a><a id="2609" class="Symbol">)</a>
</pre>
<h2 id="step-with-costs">Step with costs</h2>

<p>Function <code class="language-plaintext highlighter-rouge">step</code> performs a single step in the CEK machine.</p>

<pre class="Agda"><a id="stepC"></a><a id="2700" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="2706" class="Symbol">:</a> <a id="2708" href="Untyped.CEK.html#3547" class="Datatype">State</a> <a id="2714" class="Symbol">→</a> <a id="2716" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="2721" href="Untyped.CEK.html#3547" class="Datatype">State</a>
<a id="2727" class="Comment">-- computeCEK in the Haskell implementation</a>
<a id="2771" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="2777" class="Symbol">(</a><a id="2778" href="Untyped.CEKWithCost.html#2778" class="Bound">s</a> <a id="2780" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="2782" href="Untyped.CEKWithCost.html#2782" class="Bound">ρ</a> <a id="2784" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="2786" href="Untyped.html#1322" class="InductiveConstructor">`</a> <a id="2788" href="Untyped.CEKWithCost.html#2788" class="Bound">x</a><a id="2789" class="Symbol">)</a>               <a id="2805" class="Symbol">=</a> <a id="2807" class="Keyword">do</a>
    <a id="2814" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="2820" href="Cost.Base.html#941" class="InductiveConstructor">BVar</a>
    <a id="2829" href="Utils.html#2913" class="Field">return</a> <a id="2836" class="Symbol">(</a><a id="2837" href="Untyped.CEKWithCost.html#2778" class="Bound">s</a> <a id="2839" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="2841" href="Untyped.CEK.html#3747" class="Function">lookup</a> <a id="2848" href="Untyped.CEKWithCost.html#2782" class="Bound">ρ</a> <a id="2850" href="Untyped.CEKWithCost.html#2788" class="Bound">x</a><a id="2851" class="Symbol">)</a>
<a id="2853" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="2859" class="Symbol">(</a><a id="2860" href="Untyped.CEKWithCost.html#2860" class="Bound">s</a> <a id="2862" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="2864" href="Untyped.CEKWithCost.html#2864" class="Bound">ρ</a> <a id="2866" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="2868" href="Untyped.html#1338" class="InductiveConstructor">ƛ</a> <a id="2870" href="Untyped.CEKWithCost.html#2870" class="Bound">t</a><a id="2871" class="Symbol">)</a>               <a id="2887" class="Symbol">=</a> <a id="2889" class="Keyword">do</a>
    <a id="2896" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="2902" href="Cost.Base.html#952" class="InductiveConstructor">BLamAbs</a>
    <a id="2914" href="Utils.html#2913" class="Field">return</a> <a id="2921" class="Symbol">(</a><a id="2922" href="Untyped.CEKWithCost.html#2860" class="Bound">s</a> <a id="2924" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="2926" href="Untyped.CEK.html#1492" class="InductiveConstructor">V-ƛ</a> <a id="2930" href="Untyped.CEKWithCost.html#2864" class="Bound">ρ</a> <a id="2932" href="Untyped.CEKWithCost.html#2870" class="Bound">t</a><a id="2933" class="Symbol">)</a>
<a id="2935" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="2941" class="Symbol">(</a><a id="2942" href="Untyped.CEKWithCost.html#2942" class="Bound">s</a> <a id="2944" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="2946" href="Untyped.CEKWithCost.html#2946" class="Bound">ρ</a> <a id="2948" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="2950" class="Symbol">(</a><a id="2951" href="Untyped.CEKWithCost.html#2951" class="Bound">t</a> <a id="2953" href="Untyped.html#1362" class="InductiveConstructor Operator">·</a> <a id="2955" href="Untyped.CEKWithCost.html#2955" class="Bound">u</a><a id="2956" class="Symbol">))</a>           <a id="2969" class="Symbol">=</a> <a id="2971" class="Keyword">do</a>
    <a id="2978" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="2984" href="Cost.Base.html#966" class="InductiveConstructor">BApply</a>
    <a id="2995" href="Utils.html#2913" class="Field">return</a> <a id="3002" class="Symbol">((</a><a id="3004" href="Untyped.CEKWithCost.html#2942" class="Bound">s</a> <a id="3006" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3008" href="Untyped.CEK.html#3330" class="InductiveConstructor">-·</a> <a id="3011" href="Untyped.CEKWithCost.html#2946" class="Bound">ρ</a> <a id="3013" href="Untyped.CEKWithCost.html#2955" class="Bound">u</a><a id="3014" class="Symbol">)</a> <a id="3016" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3018" href="Untyped.CEKWithCost.html#2946" class="Bound">ρ</a> <a id="3020" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3022" href="Untyped.CEKWithCost.html#2951" class="Bound">t</a><a id="3023" class="Symbol">)</a>
<a id="3025" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3031" class="Symbol">(</a><a id="3032" href="Untyped.CEKWithCost.html#3032" class="Bound">s</a> <a id="3034" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3036" href="Untyped.CEKWithCost.html#3036" class="Bound">ρ</a> <a id="3038" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3040" href="Untyped.html#1386" class="InductiveConstructor">force</a> <a id="3046" href="Untyped.CEKWithCost.html#3046" class="Bound">t</a><a id="3047" class="Symbol">)</a>           <a id="3059" class="Symbol">=</a> <a id="3061" class="Keyword">do</a>
    <a id="3068" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="3074" href="Cost.Base.html#992" class="InductiveConstructor">BForce</a>
    <a id="3085" href="Utils.html#2913" class="Field">return</a> <a id="3092" class="Symbol">((</a><a id="3094" href="Untyped.CEKWithCost.html#3032" class="Bound">s</a> <a id="3096" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3098" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="3104" class="Symbol">)</a> <a id="3106" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3108" href="Untyped.CEKWithCost.html#3036" class="Bound">ρ</a> <a id="3110" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3112" href="Untyped.CEKWithCost.html#3046" class="Bound">t</a><a id="3113" class="Symbol">)</a>
<a id="3115" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3121" class="Symbol">(</a><a id="3122" href="Untyped.CEKWithCost.html#3122" class="Bound">s</a> <a id="3124" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3126" href="Untyped.CEKWithCost.html#3126" class="Bound">ρ</a> <a id="3128" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3130" href="Untyped.html#1406" class="InductiveConstructor">delay</a> <a id="3136" href="Untyped.CEKWithCost.html#3136" class="Bound">t</a><a id="3137" class="Symbol">)</a>           <a id="3149" class="Symbol">=</a> <a id="3151" class="Keyword">do</a> 
    <a id="3159" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="3165" href="Cost.Base.html#979" class="InductiveConstructor">BDelay</a>
    <a id="3176" href="Utils.html#2913" class="Field">return</a> <a id="3183" class="Symbol">(</a><a id="3184" href="Untyped.CEKWithCost.html#3122" class="Bound">s</a> <a id="3186" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3188" href="Untyped.CEK.html#1576" class="InductiveConstructor">V-delay</a> <a id="3196" href="Untyped.CEKWithCost.html#3126" class="Bound">ρ</a> <a id="3198" href="Untyped.CEKWithCost.html#3136" class="Bound">t</a><a id="3199" class="Symbol">)</a>
<a id="3201" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3207" class="Symbol">(</a><a id="3208" href="Untyped.CEKWithCost.html#3208" class="Bound">s</a> <a id="3210" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3212" href="Untyped.CEKWithCost.html#3212" class="Bound">ρ</a> <a id="3214" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3216" href="Untyped.html#1426" class="InductiveConstructor">con</a> <a id="3220" class="Symbol">(</a><a id="3221" href="RawU.html#7660" class="InductiveConstructor">tmCon</a> <a id="3227" href="Untyped.CEKWithCost.html#3227" class="Bound">t</a> <a id="3229" href="Untyped.CEKWithCost.html#3229" class="Bound">c</a><a id="3230" class="Symbol">))</a>   <a id="3235" class="Symbol">=</a> <a id="3237" class="Keyword">do</a> 
    <a id="3245" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="3251" href="Cost.Base.html#927" class="InductiveConstructor">BConst</a>
    <a id="3262" href="Utils.html#2913" class="Field">return</a> <a id="3269" class="Symbol">(</a><a id="3270" href="Untyped.CEKWithCost.html#3208" class="Bound">s</a> <a id="3272" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3274" href="Untyped.CEK.html#1533" class="InductiveConstructor">V-con</a> <a id="3280" href="Untyped.CEKWithCost.html#3227" class="Bound">t</a> <a id="3282" href="Untyped.CEKWithCost.html#3229" class="Bound">c</a><a id="3283" class="Symbol">)</a>
<a id="3285" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3291" class="Symbol">(</a><a id="3292" href="Untyped.CEKWithCost.html#3292" class="Bound">s</a> <a id="3294" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3296" href="Untyped.CEKWithCost.html#3296" class="Bound">ρ</a> <a id="3298" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3300" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="3307" href="Untyped.CEKWithCost.html#3307" class="Bound">i</a> <a id="3309" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="3311" class="Symbol">)</a>       <a id="3319" class="Symbol">=</a> <a id="3321" class="Keyword">do</a>
    <a id="3328" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="3334" href="Cost.Base.html#1086" class="InductiveConstructor">BConstr</a>    
    <a id="3350" href="Utils.html#2913" class="Field">return</a> <a id="3357" class="Symbol">(</a><a id="3358" href="Untyped.CEKWithCost.html#3292" class="Bound">s</a> <a id="3360" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3362" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="3371" href="Untyped.CEKWithCost.html#3307" class="Bound">i</a> <a id="3373" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a><a id="3374" class="Symbol">)</a>
<a id="3376" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3382" class="Symbol">(</a><a id="3383" href="Untyped.CEKWithCost.html#3383" class="Bound">s</a> <a id="3385" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3387" href="Untyped.CEKWithCost.html#3387" class="Bound">ρ</a> <a id="3389" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3391" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="3398" href="Untyped.CEKWithCost.html#3398" class="Bound">i</a> <a id="3400" class="Symbol">(</a><a id="3401" href="Untyped.CEKWithCost.html#3401" class="Bound">x</a> <a id="3403" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="3405" href="Untyped.CEKWithCost.html#3405" class="Bound">xs</a><a id="3407" class="Symbol">))</a> <a id="3410" class="Symbol">=</a> <a id="3412" class="Keyword">do</a> 
    <a id="3420" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="3426" href="Cost.Base.html#1086" class="InductiveConstructor">BConstr</a>
    <a id="3438" href="Utils.html#2913" class="Field">return</a> <a id="3445" class="Symbol">((</a><a id="3447" href="Untyped.CEKWithCost.html#3383" class="Bound">s</a> <a id="3449" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3451" href="Untyped.CEK.html#3426" class="InductiveConstructor">constr-</a> <a id="3459" href="Untyped.CEKWithCost.html#3398" class="Bound">i</a> <a id="3461" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a> <a id="3463" href="Untyped.CEKWithCost.html#3387" class="Bound">ρ</a> <a id="3465" href="Untyped.CEKWithCost.html#3405" class="Bound">xs</a><a id="3467" class="Symbol">)</a><a id="3468" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3470" href="Untyped.CEKWithCost.html#3387" class="Bound">ρ</a> <a id="3472" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3474" href="Untyped.CEKWithCost.html#3401" class="Bound">x</a><a id="3475" class="Symbol">)</a>
<a id="3477" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3483" class="Symbol">(</a><a id="3484" href="Untyped.CEKWithCost.html#3484" class="Bound">s</a> <a id="3486" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3488" href="Untyped.CEKWithCost.html#3488" class="Bound">ρ</a> <a id="3490" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3492" href="Untyped.html#1493" class="InductiveConstructor">case</a> <a id="3497" href="Untyped.CEKWithCost.html#3497" class="Bound">t</a> <a id="3499" href="Untyped.CEKWithCost.html#3499" class="Bound">ts</a><a id="3501" class="Symbol">)</a>         <a id="3511" class="Symbol">=</a> <a id="3513" class="Keyword">do</a> 
    <a id="3521" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="3527" href="Cost.Base.html#1101" class="InductiveConstructor">BCase</a>
    <a id="3537" href="Utils.html#2913" class="Field">return</a> <a id="3544" class="Symbol">((</a><a id="3546" href="Untyped.CEKWithCost.html#3484" class="Bound">s</a> <a id="3548" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3550" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="3556" href="Untyped.CEKWithCost.html#3488" class="Bound">ρ</a> <a id="3558" href="Untyped.CEKWithCost.html#3499" class="Bound">ts</a><a id="3560" class="Symbol">)</a> <a id="3562" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3564" href="Untyped.CEKWithCost.html#3488" class="Bound">ρ</a> <a id="3566" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3568" href="Untyped.CEKWithCost.html#3497" class="Bound">t</a><a id="3569" class="Symbol">)</a>
<a id="3571" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3577" class="Symbol">(</a><a id="3578" href="Untyped.CEKWithCost.html#3578" class="Bound">s</a> <a id="3580" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3582" href="Untyped.CEKWithCost.html#3582" class="Bound">ρ</a> <a id="3584" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3586" href="Untyped.html#1541" class="InductiveConstructor">builtin</a> <a id="3594" href="Untyped.CEKWithCost.html#3594" class="Bound">b</a><a id="3595" class="Symbol">)</a>         <a id="3605" class="Symbol">=</a> <a id="3607" class="Keyword">do</a> 
    <a id="3615" href="Untyped.CEKWithCost.html#1501" class="Function">spend</a> <a id="3621" href="Cost.Base.html#1005" class="InductiveConstructor">BBuiltin</a>
    <a id="3634" href="Utils.html#2913" class="Field">return</a> <a id="3641" class="Symbol">(</a><a id="3642" href="Untyped.CEKWithCost.html#3578" class="Bound">s</a> <a id="3644" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3646" href="Untyped.CEK.html#18353" class="Function">ival</a> <a id="3651" href="Untyped.CEKWithCost.html#3594" class="Bound">b</a><a id="3652" class="Symbol">)</a>
<a id="3654" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3660" class="Symbol">(</a><a id="3661" href="Untyped.CEKWithCost.html#3661" class="Bound">s</a> <a id="3663" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3665" href="Untyped.CEKWithCost.html#3665" class="Bound">ρ</a> <a id="3667" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3669" href="Untyped.html#1573" class="InductiveConstructor">error</a><a id="3674" class="Symbol">)</a>             <a id="3688" class="Symbol">=</a> <a id="3690" href="Utils.html#2913" class="Field">return</a> <a id="3697" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a>

<a id="3700" class="Comment">-- return∁EK in the Haskell implementation</a>
<a id="3743" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3749" class="Symbol">(</a><a id="3750" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a> <a id="3752" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3754" href="Untyped.CEKWithCost.html#3754" class="Bound">v</a><a id="3755" class="Symbol">)</a>                               <a id="3787" class="Symbol">=</a> <a id="3789" href="Utils.html#2913" class="Field">return</a> <a id="3796" class="Symbol">(</a><a id="3797" href="Untyped.CEK.html#3661" class="InductiveConstructor">□</a> <a id="3799" href="Untyped.CEKWithCost.html#3754" class="Bound">v</a><a id="3800" class="Symbol">)</a>
<a id="3802" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3808" class="Symbol">((</a><a id="3810" href="Untyped.CEKWithCost.html#3810" class="Bound">s</a> <a id="3812" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3814" href="Untyped.CEK.html#3330" class="InductiveConstructor">-·</a> <a id="3817" href="Untyped.CEKWithCost.html#3817" class="Bound">ρ</a> <a id="3819" href="Untyped.CEKWithCost.html#3819" class="Bound">u</a><a id="3820" class="Symbol">)</a> <a id="3822" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3824" href="Untyped.CEKWithCost.html#3824" class="Bound">v</a><a id="3825" class="Symbol">)</a>                    <a id="3846" class="Symbol">=</a> <a id="3848" href="Utils.html#2913" class="Field">return</a> <a id="3855" class="Symbol">((</a><a id="3857" href="Untyped.CEKWithCost.html#3810" class="Bound">s</a> <a id="3859" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3861" class="Symbol">(</a><a id="3862" href="Untyped.CEKWithCost.html#3824" class="Bound">v</a> <a id="3864" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="3866" class="Symbol">))</a> <a id="3869" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="3871" href="Untyped.CEKWithCost.html#3817" class="Bound">ρ</a> <a id="3873" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="3875" href="Untyped.CEKWithCost.html#3819" class="Bound">u</a><a id="3876" class="Symbol">)</a>
<a id="3878" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3884" class="Symbol">((</a><a id="3886" href="Untyped.CEKWithCost.html#3886" class="Bound">s</a> <a id="3888" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3890" href="Untyped.CEK.html#3365" class="InductiveConstructor">-·v</a> <a id="3894" href="Untyped.CEKWithCost.html#3894" class="Bound">v</a><a id="3895" class="Symbol">)</a> <a id="3897" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3899" href="Untyped.CEKWithCost.html#3899" class="Bound">vf</a><a id="3901" class="Symbol">)</a>                    <a id="3922" class="Symbol">=</a> <a id="3924" href="Utils.html#2913" class="Field">return</a> <a id="3931" class="Symbol">((</a><a id="3933" href="Untyped.CEKWithCost.html#3886" class="Bound">s</a> <a id="3935" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3937" href="Untyped.CEKWithCost.html#3899" class="Bound">vf</a> <a id="3940" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="3942" class="Symbol">)</a> <a id="3944" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3946" href="Untyped.CEKWithCost.html#3894" class="Bound">v</a><a id="3947" class="Symbol">)</a>
<a id="3949" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="3955" class="Symbol">((</a><a id="3957" href="Untyped.CEKWithCost.html#3957" class="Bound">s</a> <a id="3959" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="3961" class="Symbol">(</a><a id="3962" href="Untyped.CEK.html#1492" class="InductiveConstructor">V-ƛ</a> <a id="3966" href="Untyped.CEKWithCost.html#3966" class="Bound">ρ</a> <a id="3968" href="Untyped.CEKWithCost.html#3968" class="Bound">t</a> <a id="3970" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="3972" class="Symbol">))</a> <a id="3975" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="3977" href="Untyped.CEKWithCost.html#3977" class="Bound">v</a><a id="3978" class="Symbol">)</a>              <a id="3993" class="Symbol">=</a> <a id="3995" href="Utils.html#2913" class="Field">return</a> <a id="4002" class="Symbol">(</a><a id="4003" href="Untyped.CEKWithCost.html#3957" class="Bound">s</a> <a id="4005" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="4007" href="Untyped.CEKWithCost.html#3966" class="Bound">ρ</a> <a id="4009" href="Untyped.CEK.html#1318" class="InductiveConstructor Operator">∷</a> <a id="4011" href="Untyped.CEKWithCost.html#3977" class="Bound">v</a> <a id="4013" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="4015" href="Untyped.CEKWithCost.html#3968" class="Bound">t</a><a id="4016" class="Symbol">)</a>
<a id="4018" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4024" class="Symbol">((</a><a id="4026" href="Untyped.CEKWithCost.html#4026" class="Bound">s</a> <a id="4028" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4030" class="Symbol">(</a><a id="4031" href="Untyped.CEK.html#1533" class="InductiveConstructor">V-con</a> <a id="4037" class="Symbol">_</a> <a id="4039" class="Symbol">_</a>   <a id="4043" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="4045" class="Symbol">))</a> <a id="4048" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4050" href="Untyped.CEKWithCost.html#4050" class="Bound">v</a><a id="4051" class="Symbol">)</a>          <a id="4062" class="Symbol">=</a> <a id="4064" href="Utils.html#2913" class="Field">return</a> <a id="4071" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="4073" class="Comment">-- constant in function position</a>
<a id="4106" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4112" class="Symbol">((</a><a id="4114" href="Untyped.CEKWithCost.html#4114" class="Bound">s</a> <a id="4116" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4118" class="Symbol">(</a><a id="4119" href="Untyped.CEK.html#1576" class="InductiveConstructor">V-delay</a> <a id="4127" class="Symbol">_</a> <a id="4129" class="Symbol">_</a> <a id="4131" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="4133" class="Symbol">))</a> <a id="4136" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4138" href="Untyped.CEKWithCost.html#4138" class="Bound">v</a><a id="4139" class="Symbol">)</a>          <a id="4150" class="Symbol">=</a> <a id="4152" href="Utils.html#2913" class="Field">return</a> <a id="4159" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="4161" class="Comment">-- delay in function position</a>
<a id="4191" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4197" class="Symbol">((</a><a id="4199" href="Untyped.CEKWithCost.html#4199" class="Bound">s</a> <a id="4201" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4203" class="Symbol">(</a><a id="4204" href="Untyped.CEK.html#1824" class="InductiveConstructor">V-IΠ</a> <a id="4209" href="Untyped.CEKWithCost.html#4209" class="Bound">b</a> <a id="4211" href="Untyped.CEKWithCost.html#4211" class="Bound">bapp</a> <a id="4216" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="4218" class="Symbol">))</a> <a id="4221" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4223" href="Untyped.CEKWithCost.html#4223" class="Bound">v</a><a id="4224" class="Symbol">)</a>          <a id="4235" class="Symbol">=</a> <a id="4237" href="Utils.html#2913" class="Field">return</a> <a id="4244" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="4246" class="Comment">-- delayed builtin in function position</a>
<a id="4286" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4292" class="Symbol">((</a><a id="4294" href="Untyped.CEKWithCost.html#4294" class="Bound">s</a> <a id="4296" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4298" class="Symbol">(</a><a id="4299" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="4308" href="Untyped.CEKWithCost.html#4308" class="Bound">i</a> <a id="4310" href="Untyped.CEKWithCost.html#4310" class="Bound">vs</a> <a id="4313" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="4315" class="Symbol">))</a> <a id="4318" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4320" href="Untyped.CEKWithCost.html#4320" class="Bound">v</a><a id="4321" class="Symbol">)</a>        <a id="4330" class="Symbol">=</a> <a id="4332" href="Utils.html#2913" class="Field">return</a> <a id="4339" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="4341" class="Comment">-- SOP in function position</a>
<a id="4369" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4375" class="Symbol">((</a><a id="4377" href="Untyped.CEKWithCost.html#4377" class="Bound">s</a> <a id="4379" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4381" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="4387" class="Symbol">)</a> <a id="4389" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4391" href="Untyped.CEK.html#1824" class="InductiveConstructor">V-IΠ</a> <a id="4396" href="Untyped.CEKWithCost.html#4396" class="Bound">b</a> <a id="4398" href="Untyped.CEKWithCost.html#4398" class="Bound">bapp</a><a id="4402" class="Symbol">)</a>          <a id="4413" class="Symbol">=</a> <a id="4415" href="Utils.html#2913" class="Field">return</a> <a id="4422" class="Symbol">(</a><a id="4423" href="Untyped.CEKWithCost.html#4377" class="Bound">s</a> <a id="4425" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4427" href="Untyped.CEK.html#3847" class="Function">V-I</a> <a id="4431" href="Untyped.CEKWithCost.html#4396" class="Bound">b</a> <a id="4433" class="Symbol">(</a><a id="4434" href="Untyped.CEK.html#2251" class="InductiveConstructor">app⋆</a> <a id="4439" href="Untyped.CEKWithCost.html#4398" class="Bound">bapp</a><a id="4443" class="Symbol">))</a>
<a id="4446" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4452" class="Symbol">((</a><a id="4454" href="Untyped.CEKWithCost.html#4454" class="Bound">s</a> <a id="4456" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4458" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="4464" class="Symbol">)</a> <a id="4466" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4468" href="Untyped.CEK.html#1576" class="InductiveConstructor">V-delay</a> <a id="4476" href="Untyped.CEKWithCost.html#4476" class="Bound">ρ</a> <a id="4478" href="Untyped.CEKWithCost.html#4478" class="Bound">t</a><a id="4479" class="Symbol">)</a>          <a id="4490" class="Symbol">=</a> <a id="4492" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4498" class="Symbol">(</a><a id="4499" href="Untyped.CEKWithCost.html#4454" class="Bound">s</a> <a id="4501" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="4503" href="Untyped.CEKWithCost.html#4476" class="Bound">ρ</a> <a id="4505" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="4507" href="Untyped.CEKWithCost.html#4478" class="Bound">t</a><a id="4508" class="Symbol">)</a> <a id="4510" class="Comment">-- this recursive call could be inlined</a>
                                                                <a id="4614" class="Comment">-- in order to make evident that this is a single step </a>
                                                                <a id="4734" class="Comment">-- but this would make the definition much longer.</a>
<a id="4785" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4791" class="Symbol">((</a><a id="4793" href="Untyped.CEKWithCost.html#4793" class="Bound">s</a> <a id="4795" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4797" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="4803" class="Symbol">)</a> <a id="4805" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4807" href="Untyped.CEK.html#1492" class="InductiveConstructor">V-ƛ</a> <a id="4811" class="Symbol">_</a> <a id="4813" class="Symbol">_)</a>              <a id="4829" class="Symbol">=</a> <a id="4831" href="Utils.html#2913" class="Field">return</a> <a id="4838" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="4840" class="Comment">-- lambda in delay position</a>
<a id="4868" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4874" class="Symbol">((</a><a id="4876" href="Untyped.CEKWithCost.html#4876" class="Bound">s</a> <a id="4878" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4880" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="4886" class="Symbol">)</a> <a id="4888" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4890" href="Untyped.CEK.html#1533" class="InductiveConstructor">V-con</a> <a id="4896" class="Symbol">_</a> <a id="4898" class="Symbol">_)</a>            <a id="4912" class="Symbol">=</a> <a id="4914" href="Utils.html#2913" class="Field">return</a> <a id="4921" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="4923" class="Comment">-- constant in delay position</a>
<a id="4953" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="4959" class="Symbol">((</a><a id="4961" href="Untyped.CEKWithCost.html#4961" class="Bound">s</a> <a id="4963" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="4965" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="4971" class="Symbol">)</a> <a id="4973" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="4975" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="4980" href="Untyped.CEKWithCost.html#4980" class="Bound">b</a> <a id="4982" href="Untyped.CEKWithCost.html#4982" class="Bound">bapp</a><a id="4986" class="Symbol">)</a>          <a id="4997" class="Symbol">=</a> <a id="4999" href="Utils.html#2913" class="Field">return</a> <a id="5006" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5008" class="Comment">-- function in delay position</a>
<a id="5038" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5044" class="Symbol">((</a><a id="5046" href="Untyped.CEKWithCost.html#5046" class="Bound">s</a> <a id="5048" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5050" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="5056" class="Symbol">)</a> <a id="5058" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5060" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="5069" href="Untyped.CEKWithCost.html#5069" class="Bound">i</a> <a id="5071" href="Untyped.CEKWithCost.html#5071" class="Bound">vs</a><a id="5073" class="Symbol">)</a>        <a id="5082" class="Symbol">=</a> <a id="5084" href="Utils.html#2913" class="Field">return</a> <a id="5091" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5093" class="Comment">-- SOP in delay position</a>
<a id="5118" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5124" class="Symbol">((</a><a id="5126" href="Untyped.CEKWithCost.html#5126" class="Bound">s</a> <a id="5128" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5130" href="Untyped.CEK.html#3426" class="InductiveConstructor">constr-</a> <a id="5138" href="Untyped.CEKWithCost.html#5138" class="Bound">i</a> <a id="5140" href="Untyped.CEKWithCost.html#5140" class="Bound">vs</a> <a id="5143" href="Untyped.CEKWithCost.html#5143" class="Bound">ρ</a> <a id="5145" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="5147" class="Symbol">)</a> <a id="5149" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5151" href="Untyped.CEKWithCost.html#5151" class="Bound">v</a><a id="5152" class="Symbol">)</a>         <a id="5162" class="Symbol">=</a> <a id="5164" href="Utils.html#2913" class="Field">return</a> <a id="5171" class="Symbol">(</a><a id="5172" href="Untyped.CEKWithCost.html#5126" class="Bound">s</a> <a id="5174" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5176" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="5185" href="Untyped.CEKWithCost.html#5138" class="Bound">i</a> <a id="5187" class="Symbol">(</a><a id="5188" href="Untyped.CEKWithCost.html#5140" class="Bound">vs</a> <a id="5191" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5193" href="Untyped.CEKWithCost.html#5151" class="Bound">v</a><a id="5194" class="Symbol">))</a>
<a id="5197" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5203" class="Symbol">((</a><a id="5205" href="Untyped.CEKWithCost.html#5205" class="Bound">s</a> <a id="5207" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5209" href="Untyped.CEK.html#3426" class="InductiveConstructor">constr-</a> <a id="5217" href="Untyped.CEKWithCost.html#5217" class="Bound">i</a> <a id="5219" href="Untyped.CEKWithCost.html#5219" class="Bound">vs</a> <a id="5222" href="Untyped.CEKWithCost.html#5222" class="Bound">ρ</a> <a id="5224" class="Symbol">(</a><a id="5225" href="Untyped.CEKWithCost.html#5225" class="Bound">x</a> <a id="5227" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="5229" href="Untyped.CEKWithCost.html#5229" class="Bound">ts</a><a id="5231" class="Symbol">))</a> <a id="5234" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5236" href="Untyped.CEKWithCost.html#5236" class="Bound">v</a><a id="5237" class="Symbol">)</a>   <a id="5241" class="Symbol">=</a> <a id="5243" href="Utils.html#2913" class="Field">return</a> <a id="5250" class="Symbol">((</a><a id="5252" href="Untyped.CEKWithCost.html#5205" class="Bound">s</a> <a id="5254" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5256" href="Untyped.CEK.html#3426" class="InductiveConstructor">constr-</a> <a id="5264" href="Untyped.CEKWithCost.html#5217" class="Bound">i</a> <a id="5266" class="Symbol">(</a><a id="5267" href="Untyped.CEKWithCost.html#5219" class="Bound">vs</a> <a id="5270" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5272" href="Untyped.CEKWithCost.html#5236" class="Bound">v</a><a id="5273" class="Symbol">)</a> <a id="5275" href="Untyped.CEKWithCost.html#5222" class="Bound">ρ</a> <a id="5277" href="Untyped.CEKWithCost.html#5229" class="Bound">ts</a><a id="5279" class="Symbol">)</a><a id="5280" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="5282" href="Untyped.CEKWithCost.html#5222" class="Bound">ρ</a> <a id="5284" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="5286" href="Untyped.CEKWithCost.html#5225" class="Bound">x</a><a id="5287" class="Symbol">)</a>
<a id="5289" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5295" class="Symbol">((</a><a id="5297" href="Untyped.CEKWithCost.html#5297" class="Bound">s</a> <a id="5299" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5301" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="5307" href="Untyped.CEKWithCost.html#5307" class="Bound">ρ</a> <a id="5309" href="Untyped.CEKWithCost.html#5309" class="Bound">ts</a><a id="5311" class="Symbol">)</a> <a id="5313" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5315" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="5324" href="Untyped.CEKWithCost.html#5324" class="Bound">i</a> <a id="5326" href="Untyped.CEKWithCost.html#5326" class="Bound">vs</a><a id="5328" class="Symbol">)</a>    <a id="5333" class="Symbol">=</a> <a id="5335" href="Utils.html#2913" class="Field">return</a> <a id="5342" class="Symbol">(</a><a id="5343" href="Data.Maybe.Base.html#1371" class="Function">maybe</a> <a id="5349" class="Symbol">(</a><a id="5350" href="Untyped.CEK.html#18397" class="Function">pushValueFrames</a> <a id="5366" href="Untyped.CEKWithCost.html#5297" class="Bound">s</a> <a id="5368" href="Untyped.CEKWithCost.html#5326" class="Bound">vs</a> <a id="5371" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="5373" href="Untyped.CEKWithCost.html#5307" class="Bound">ρ</a> <a id="5375" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻_</a><a id="5377" class="Symbol">)</a> <a id="5379" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5381" class="Symbol">(</a><a id="5382" href="Untyped.CEK.html#18540" class="Function">lookup?</a> <a id="5390" href="Untyped.CEKWithCost.html#5324" class="Bound">i</a> <a id="5392" href="Untyped.CEKWithCost.html#5309" class="Bound">ts</a><a id="5394" class="Symbol">))</a>
<a id="5397" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5403" class="Symbol">((</a><a id="5405" href="Untyped.CEKWithCost.html#5405" class="Bound">s</a> <a id="5407" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5409" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="5415" href="Untyped.CEKWithCost.html#5415" class="Bound">ρ</a> <a id="5417" href="Untyped.CEKWithCost.html#5417" class="Bound">ts</a><a id="5419" class="Symbol">)</a> <a id="5421" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5423" href="Untyped.CEK.html#1492" class="InductiveConstructor">V-ƛ</a> <a id="5427" class="Symbol">_</a> <a id="5429" class="Symbol">_)</a>          <a id="5441" class="Symbol">=</a> <a id="5443" href="Utils.html#2913" class="Field">return</a> <a id="5450" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5452" class="Comment">-- case of lambda</a>
<a id="5470" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5476" class="Symbol">((</a><a id="5478" href="Untyped.CEKWithCost.html#5478" class="Bound">s</a> <a id="5480" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5482" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="5488" href="Untyped.CEKWithCost.html#5488" class="Bound">ρ</a> <a id="5490" href="Untyped.CEKWithCost.html#5490" class="Bound">ts</a><a id="5492" class="Symbol">)</a> <a id="5494" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5496" href="Untyped.CEK.html#1533" class="InductiveConstructor">V-con</a> <a id="5502" class="Symbol">_</a> <a id="5504" class="Symbol">_)</a>        <a id="5514" class="Symbol">=</a> <a id="5516" href="Utils.html#2913" class="Field">return</a> <a id="5523" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5525" class="Comment">-- case of constant</a>
<a id="5545" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5551" class="Symbol">((</a><a id="5553" href="Untyped.CEKWithCost.html#5553" class="Bound">s</a> <a id="5555" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5557" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="5563" href="Untyped.CEKWithCost.html#5563" class="Bound">ρ</a> <a id="5565" href="Untyped.CEKWithCost.html#5565" class="Bound">ts</a><a id="5567" class="Symbol">)</a> <a id="5569" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5571" href="Untyped.CEK.html#1576" class="InductiveConstructor">V-delay</a> <a id="5579" class="Symbol">_</a> <a id="5581" class="Symbol">_)</a>      <a id="5589" class="Symbol">=</a> <a id="5591" href="Utils.html#2913" class="Field">return</a> <a id="5598" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5600" class="Comment">-- case of delay</a>
<a id="5617" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5623" class="Symbol">((</a><a id="5625" href="Untyped.CEKWithCost.html#5625" class="Bound">s</a> <a id="5627" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5629" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="5635" href="Untyped.CEKWithCost.html#5635" class="Bound">ρ</a> <a id="5637" href="Untyped.CEKWithCost.html#5637" class="Bound">ts</a><a id="5639" class="Symbol">)</a> <a id="5641" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5643" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="5648" class="Symbol">_</a> <a id="5650" class="Symbol">_)</a>         <a id="5661" class="Symbol">=</a> <a id="5663" href="Utils.html#2913" class="Field">return</a> <a id="5670" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5672" class="Comment">-- case of builtin value</a>
<a id="5697" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5703" class="Symbol">((</a><a id="5705" href="Untyped.CEKWithCost.html#5705" class="Bound">s</a> <a id="5707" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5709" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="5715" href="Untyped.CEKWithCost.html#5715" class="Bound">ρ</a> <a id="5717" href="Untyped.CEKWithCost.html#5717" class="Bound">ts</a><a id="5719" class="Symbol">)</a> <a id="5721" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5723" href="Untyped.CEK.html#1824" class="InductiveConstructor">V-IΠ</a> <a id="5728" class="Symbol">_</a> <a id="5730" class="Symbol">_)</a>         <a id="5741" class="Symbol">=</a> <a id="5743" href="Utils.html#2913" class="Field">return</a> <a id="5750" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="5752" class="Comment">-- case of delayed builtin</a>
<a id="5779" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="5785" class="Symbol">((</a><a id="5787" href="Untyped.CEKWithCost.html#5787" class="Bound">s</a> <a id="5789" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="5791" class="Symbol">(</a><a id="5792" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="5797" href="Untyped.CEKWithCost.html#5797" class="Bound">b</a> <a id="5799" class="Symbol">{</a><a id="5800" class="Argument">am</a> <a id="5803" class="Symbol">=</a> <a id="5805" class="Number">0</a><a id="5806" class="Symbol">}</a> <a id="5808" href="Untyped.CEKWithCost.html#5808" class="Bound">bapp</a> <a id="5813" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="5815" class="Symbol">))</a> <a id="5818" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="5820" href="Untyped.CEKWithCost.html#5820" class="Bound">v</a><a id="5821" class="Symbol">)</a> <a id="5823" class="Symbol">=</a> <a id="5825" class="Keyword">do</a> <a id="5828" class="Comment">--fully applied builtin function</a>
          <a id="5871" class="Keyword">let</a> <a id="5875" href="Untyped.CEKWithCost.html#5875" class="Bound">bapp&#39;</a> <a id="5881" class="Symbol">=</a> <a id="5883" href="Untyped.CEK.html#17713" class="Function">mkFullyAppliedBuiltin</a> <a id="5905" class="Symbol">(</a><a id="5906" href="Untyped.CEK.html#2083" class="InductiveConstructor">app</a> <a id="5910" href="Untyped.CEKWithCost.html#5808" class="Bound">bapp</a> <a id="5915" href="Untyped.CEKWithCost.html#5820" class="Bound">v</a><a id="5916" class="Symbol">)</a> <a id="5918" class="Comment">-- proof that b is fully applied</a>
          <a id="5961" href="Untyped.CEKWithCost.html#2426" class="Function">spendBuiltin</a> <a id="5974" href="Untyped.CEKWithCost.html#5797" class="Bound">b</a> <a id="5976" href="Untyped.CEKWithCost.html#5875" class="Bound">bapp&#39;</a> 
          <a id="5993" href="Utils.html#2913" class="Field">return</a> <a id="6000" class="Symbol">(</a><a id="6001" href="Utils.html#1263" class="Function">either</a> <a id="6008" class="Symbol">(</a><a id="6009" href="Untyped.CEK.html#4264" class="Function">BUILTIN</a> <a id="6017" href="Untyped.CEKWithCost.html#5797" class="Bound">b</a> <a id="6019" href="Untyped.CEKWithCost.html#5875" class="Bound">bapp&#39;</a><a id="6024" class="Symbol">)</a> <a id="6026" class="Symbol">(λ</a> <a id="6029" href="Untyped.CEKWithCost.html#6029" class="Bound">_</a> <a id="6031" class="Symbol">→</a>  <a id="6034" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a><a id="6035" class="Symbol">)</a> <a id="6037" class="Symbol">(</a><a id="6038" href="Untyped.CEKWithCost.html#5787" class="Bound">s</a> <a id="6040" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅_</a><a id="6042" class="Symbol">))</a>
<a id="6045" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="6051" class="Symbol">((</a><a id="6053" href="Untyped.CEKWithCost.html#6053" class="Bound">s</a> <a id="6055" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="6057" class="Symbol">(</a><a id="6058" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="6063" href="Untyped.CEKWithCost.html#6063" class="Bound">b</a> <a id="6065" class="Symbol">{</a><a id="6066" class="Argument">am</a> <a id="6069" class="Symbol">=</a> <a id="6071" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6075" class="Symbol">_}</a> <a id="6078" href="Untyped.CEKWithCost.html#6078" class="Bound">bapp</a> <a id="6083" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="6085" class="Symbol">))</a> <a id="6088" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="6090" href="Untyped.CEKWithCost.html#6090" class="Bound">v</a><a id="6091" class="Symbol">)</a> <a id="6093" class="Symbol">=</a>  <a id="6096" class="Comment">--partially applied builtin function</a>
          <a id="6143" href="Utils.html#2913" class="Field">return</a> <a id="6150" class="Symbol">(</a><a id="6151" href="Untyped.CEKWithCost.html#6053" class="Bound">s</a> <a id="6153" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="6155" href="Untyped.CEK.html#3847" class="Function">V-I</a> <a id="6159" href="Untyped.CEKWithCost.html#6063" class="Bound">b</a> <a id="6161" class="Symbol">(</a><a id="6162" href="Untyped.CEK.html#2083" class="InductiveConstructor">app</a> <a id="6166" href="Untyped.CEKWithCost.html#6078" class="Bound">bapp</a> <a id="6171" href="Untyped.CEKWithCost.html#6090" class="Bound">v</a><a id="6172" class="Symbol">))</a>

<a id="6176" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="6182" class="Symbol">(</a><a id="6183" href="Untyped.CEK.html#3661" class="InductiveConstructor">□</a> <a id="6185" href="Untyped.CEKWithCost.html#6185" class="Bound">v</a><a id="6186" class="Symbol">)</a>               <a id="6202" class="Symbol">=</a> <a id="6204" href="Utils.html#2913" class="Field">return</a> <a id="6211" class="Symbol">(</a><a id="6212" href="Untyped.CEK.html#3661" class="InductiveConstructor">□</a> <a id="6214" href="Untyped.CEKWithCost.html#6185" class="Bound">v</a><a id="6215" class="Symbol">)</a>
<a id="6217" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="6223" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a>                   <a id="6243" class="Symbol">=</a> <a id="6245" href="Utils.html#2913" class="Field">return</a> <a id="6252" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a>

<a id="stepperC-internal"></a><a id="6255" href="Untyped.CEKWithCost.html#6255" class="Function">stepperC-internal</a> <a id="6273" class="Symbol">:</a> <a id="6275" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6277" class="Symbol">→</a> <a id="6279" class="Symbol">(</a><a id="6280" href="Untyped.CEKWithCost.html#6280" class="Bound">s</a> <a id="6282" class="Symbol">:</a> <a id="6284" href="Untyped.CEK.html#3547" class="Datatype">State</a><a id="6289" class="Symbol">)</a> <a id="6291" class="Symbol">→</a> <a id="6293" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="6298" class="Symbol">(</a><a id="6299" href="Utils.html#1126" class="Datatype">Either</a> <a id="6306" href="Utils.html#4362" class="Datatype">RuntimeError</a> <a id="6319" href="Untyped.CEK.html#3547" class="Datatype">State</a><a id="6324" class="Symbol">)</a>
<a id="6326" href="Untyped.CEKWithCost.html#6255" class="Function">stepperC-internal</a> <a id="6344" class="Number">0</a>       <a id="6352" href="Untyped.CEKWithCost.html#6352" class="Bound">s</a> <a id="6354" class="Symbol">=</a> <a id="6356" href="Utils.html#2913" class="Field">return</a> <a id="6363" class="Symbol">(</a><a id="6364" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="6369" href="Utils.html#4389" class="InductiveConstructor">gasError</a><a id="6377" class="Symbol">)</a>
<a id="6379" href="Untyped.CEKWithCost.html#6255" class="Function">stepperC-internal</a> <a id="6397" class="Symbol">(</a><a id="6398" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="6402" href="Untyped.CEKWithCost.html#6402" class="Bound">n</a><a id="6403" class="Symbol">)</a> <a id="6405" href="Untyped.CEKWithCost.html#6405" class="Bound">s</a> <a id="6407" class="Symbol">=</a> <a id="6409" class="Keyword">do</a>
       <a id="6419" href="Untyped.CEKWithCost.html#6419" class="Bound">s&#39;</a> <a id="6422" href="Utils.html#2941" class="Field Operator">←</a> <a id="6424" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="6430" href="Untyped.CEKWithCost.html#6405" class="Bound">s</a> 
       <a id="6440" href="Untyped.CEKWithCost.html#6463" class="Function">go</a> <a id="6443" href="Untyped.CEKWithCost.html#6419" class="Bound">s&#39;</a>
    <a id="6450" class="Keyword">where</a>
       <a id="6463" href="Untyped.CEKWithCost.html#6463" class="Function">go</a> <a id="6466" class="Symbol">:</a> <a id="6468" class="Symbol">(</a><a id="6469" href="Untyped.CEKWithCost.html#6469" class="Bound">t</a> <a id="6471" class="Symbol">:</a> <a id="6473" href="Untyped.CEK.html#3547" class="Datatype">State</a><a id="6478" class="Symbol">)</a> <a id="6480" class="Symbol">→</a> <a id="6482" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="6487" class="Symbol">(</a><a id="6488" href="Utils.html#1126" class="Datatype">Either</a> <a id="6495" href="Utils.html#4362" class="Datatype">RuntimeError</a> <a id="6508" href="Untyped.CEK.html#3547" class="Datatype">State</a><a id="6513" class="Symbol">)</a>
       <a id="6522" href="Untyped.CEKWithCost.html#6463" class="Function">go</a> <a id="6525" class="Symbol">(</a><a id="6526" href="Untyped.CEK.html#3661" class="InductiveConstructor">□</a> <a id="6528" href="Untyped.CEKWithCost.html#6528" class="Bound">v</a><a id="6529" class="Symbol">)</a> <a id="6531" class="Symbol">=</a> <a id="6533" href="Utils.html#2913" class="Field">return</a> <a id="6540" class="Symbol">(</a><a id="6541" href="Utils.html#1183" class="InductiveConstructor">inj₂</a> <a id="6546" class="Symbol">(</a><a id="6547" href="Untyped.CEK.html#3661" class="InductiveConstructor">□</a> <a id="6549" href="Untyped.CEKWithCost.html#6528" class="Bound">v</a><a id="6550" class="Symbol">))</a>
       <a id="6560" href="Untyped.CEKWithCost.html#6463" class="Function">go</a> <a id="6563" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a>     <a id="6569" class="Symbol">=</a> <a id="6571" href="Utils.html#2913" class="Field">return</a> <a id="6578" class="Symbol">(</a><a id="6579" href="Utils.html#1183" class="InductiveConstructor">inj₂</a> <a id="6584" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a><a id="6585" class="Symbol">)</a>
       <a id="6594" href="Untyped.CEKWithCost.html#6463" class="CatchallClause Function">go</a><a id="6596" class="CatchallClause"> </a><a id="6597" href="Untyped.CEKWithCost.html#6597" class="CatchallClause Bound">s&#39;</a>    <a id="6603" class="Symbol">=</a> <a id="6605" href="Untyped.CEKWithCost.html#6255" class="Function">stepperC-internal</a> <a id="6623" href="Untyped.CEKWithCost.html#6402" class="Bound">n</a> <a id="6625" href="Untyped.CEKWithCost.html#6597" class="Bound">s&#39;</a>

<a id="stepperC"></a><a id="6629" href="Untyped.CEKWithCost.html#6629" class="Function">stepperC</a> <a id="6638" class="Symbol">:</a> <a id="6640" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="6642" class="Symbol">→</a> <a id="6644" class="Symbol">(</a><a id="6645" href="Untyped.CEKWithCost.html#6645" class="Bound">s</a> <a id="6647" class="Symbol">:</a> <a id="6649" href="Untyped.CEK.html#3547" class="Datatype">State</a><a id="6654" class="Symbol">)</a> <a id="6656" class="Symbol">→</a> <a id="6658" href="Untyped.CEKWithCost.html#1109" class="Function">CekM</a> <a id="6663" class="Symbol">(</a><a id="6664" href="Utils.html#1126" class="Datatype">Either</a> <a id="6671" href="Utils.html#4362" class="Datatype">RuntimeError</a> <a id="6684" href="Untyped.CEK.html#3547" class="Datatype">State</a><a id="6689" class="Symbol">)</a>
<a id="6691" href="Untyped.CEKWithCost.html#6629" class="Function">stepperC</a> <a id="6700" href="Untyped.CEKWithCost.html#6700" class="Bound">n</a> <a id="6702" href="Untyped.CEKWithCost.html#6702" class="Bound">s</a> <a id="6704" class="Symbol">=</a> <a id="6706" class="Keyword">do</a> 
       <a id="6717" href="Untyped.CEKWithCost.html#1572" class="Function">spendStartupCost</a> 
       <a id="6742" href="Untyped.CEKWithCost.html#6255" class="Function">stepperC-internal</a> <a id="6760" href="Untyped.CEKWithCost.html#6700" class="Bound">n</a> <a id="6762" href="Untyped.CEKWithCost.html#6702" class="Bound">s</a>
</pre>
<h2 id="proof-of-equivalence-between-cek-machine-with-and-without-costs">Proof of equivalence between CEK machine with and without costs</h2>

<pre class="Agda"><a id="cekStepEquivalence"></a><a id="6841" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="6860" class="Symbol">:</a> <a id="6862" class="Symbol">∀</a> <a id="6864" class="Symbol">(</a><a id="6865" href="Untyped.CEKWithCost.html#6865" class="Bound">s</a> <a id="6867" class="Symbol">:</a> <a id="6869" href="Untyped.CEK.html#3547" class="Datatype">State</a><a id="6874" class="Symbol">)</a> <a id="6876" class="Symbol">→</a> <a id="6878" href="Untyped.CEK.html#18673" class="Function">step</a> <a id="6883" href="Untyped.CEKWithCost.html#6865" class="Bound">s</a> <a id="6885" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="6887" href="Utils.html#4023" class="Field">wrvalue</a> <a id="6895" class="Symbol">(</a><a id="6896" href="Untyped.CEKWithCost.html#2700" class="Function">stepC</a> <a id="6902" href="Untyped.CEKWithCost.html#6865" class="Bound">s</a><a id="6903" class="Symbol">)</a> 
<a id="6906" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="6925" class="Symbol">(</a><a id="6926" href="Untyped.CEKWithCost.html#6926" class="Bound">s</a> <a id="6928" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="6930" href="Untyped.CEKWithCost.html#6930" class="Bound">ρ</a> <a id="6932" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="6934" href="Untyped.html#1322" class="InductiveConstructor">`</a> <a id="6936" class="Symbol">_)</a> <a id="6939" class="Symbol">=</a> <a id="6941" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="6946" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="6965" class="Symbol">(</a><a id="6966" href="Untyped.CEKWithCost.html#6966" class="Bound">s</a> <a id="6968" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="6970" href="Untyped.CEKWithCost.html#6970" class="Bound">ρ</a> <a id="6972" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="6974" href="Untyped.html#1338" class="InductiveConstructor">ƛ</a> <a id="6976" class="Symbol">_)</a> <a id="6979" class="Symbol">=</a> <a id="6981" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="6986" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7005" class="Symbol">(</a><a id="7006" href="Untyped.CEKWithCost.html#7006" class="Bound">s</a> <a id="7008" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7010" href="Untyped.CEKWithCost.html#7010" class="Bound">ρ</a> <a id="7012" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7014" class="Symbol">(_</a> <a id="7017" href="Untyped.html#1362" class="InductiveConstructor Operator">·</a> <a id="7019" class="Symbol">_))</a> <a id="7023" class="Symbol">=</a> <a id="7025" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7030" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7049" class="Symbol">(</a><a id="7050" href="Untyped.CEKWithCost.html#7050" class="Bound">s</a> <a id="7052" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7054" href="Untyped.CEKWithCost.html#7054" class="Bound">ρ</a> <a id="7056" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7058" href="Untyped.html#1386" class="InductiveConstructor">force</a> <a id="7064" class="Symbol">_)</a> <a id="7067" class="Symbol">=</a> <a id="7069" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7074" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7093" class="Symbol">(</a><a id="7094" href="Untyped.CEKWithCost.html#7094" class="Bound">s</a> <a id="7096" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7098" href="Untyped.CEKWithCost.html#7098" class="Bound">ρ</a> <a id="7100" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7102" href="Untyped.html#1406" class="InductiveConstructor">delay</a> <a id="7108" class="Symbol">_)</a> <a id="7111" class="Symbol">=</a> <a id="7113" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7118" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7137" class="Symbol">(</a><a id="7138" href="Untyped.CEKWithCost.html#7138" class="Bound">s</a> <a id="7140" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7142" href="Untyped.CEKWithCost.html#7142" class="Bound">ρ</a> <a id="7144" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7146" href="Untyped.html#1426" class="InductiveConstructor">con</a> <a id="7150" class="Symbol">(</a><a id="7151" href="RawU.html#7660" class="InductiveConstructor">tmCon</a> <a id="7157" class="Symbol">_</a> <a id="7159" class="Symbol">_))</a> <a id="7163" class="Symbol">=</a> <a id="7165" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7170" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7189" class="Symbol">(</a><a id="7190" href="Untyped.CEKWithCost.html#7190" class="Bound">s</a> <a id="7192" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7194" href="Untyped.CEKWithCost.html#7194" class="Bound">ρ</a> <a id="7196" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7198" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="7205" class="Symbol">_</a> <a id="7207" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="7209" class="Symbol">)</a> <a id="7211" class="Symbol">=</a> <a id="7213" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7218" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7237" class="Symbol">(</a><a id="7238" href="Untyped.CEKWithCost.html#7238" class="Bound">s</a> <a id="7240" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7242" href="Untyped.CEKWithCost.html#7242" class="Bound">ρ</a> <a id="7244" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7246" href="Untyped.html#1446" class="InductiveConstructor">constr</a> <a id="7253" class="Symbol">_</a> <a id="7255" class="Symbol">(_</a> <a id="7258" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="7260" class="Symbol">_))</a> <a id="7264" class="Symbol">=</a> <a id="7266" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7271" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7290" class="Symbol">(</a><a id="7291" href="Untyped.CEKWithCost.html#7291" class="Bound">s</a> <a id="7293" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7295" href="Untyped.CEKWithCost.html#7295" class="Bound">ρ</a> <a id="7297" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7299" href="Untyped.html#1493" class="InductiveConstructor">case</a> <a id="7304" class="Symbol">_</a> <a id="7306" class="Symbol">_)</a> <a id="7309" class="Symbol">=</a> <a id="7311" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7316" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7335" class="Symbol">(</a><a id="7336" href="Untyped.CEKWithCost.html#7336" class="Bound">s</a> <a id="7338" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7340" href="Untyped.CEKWithCost.html#7340" class="Bound">ρ</a> <a id="7342" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7344" href="Untyped.html#1541" class="InductiveConstructor">builtin</a> <a id="7352" class="Symbol">_)</a> <a id="7355" class="Symbol">=</a> <a id="7357" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7362" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7381" class="Symbol">(</a><a id="7382" href="Untyped.CEKWithCost.html#7382" class="Bound">s</a> <a id="7384" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="7386" href="Untyped.CEKWithCost.html#7386" class="Bound">ρ</a> <a id="7388" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="7390" href="Untyped.html#1573" class="InductiveConstructor">error</a><a id="7395" class="Symbol">)</a> <a id="7397" class="Symbol">=</a> <a id="7399" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7404" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7423" class="Symbol">(</a><a id="7424" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a> <a id="7426" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7428" class="Symbol">_)</a> <a id="7431" class="Symbol">=</a> <a id="7433" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7438" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7457" class="Symbol">((</a><a id="7459" href="Untyped.CEKWithCost.html#7459" class="Bound">s</a> <a id="7461" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7463" href="Untyped.CEK.html#3330" class="InductiveConstructor">-·</a> <a id="7466" class="Symbol">_</a> <a id="7468" class="Symbol">_)</a> <a id="7471" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7473" class="Symbol">_)</a> <a id="7476" class="Symbol">=</a> <a id="7478" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7483" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7502" class="Symbol">((</a><a id="7504" href="Untyped.CEKWithCost.html#7504" class="Bound">s</a> <a id="7506" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7508" href="Untyped.CEK.html#3365" class="InductiveConstructor">-·v</a> <a id="7512" class="Symbol">_)</a> <a id="7515" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7517" class="Symbol">_)</a> <a id="7520" class="Symbol">=</a> <a id="7522" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7527" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7546" class="Symbol">((</a><a id="7548" href="Untyped.CEKWithCost.html#7548" class="Bound">s</a> <a id="7550" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7552" class="Symbol">(</a><a id="7553" href="Untyped.CEK.html#1492" class="InductiveConstructor">V-ƛ</a> <a id="7557" class="Symbol">_</a> <a id="7559" class="Symbol">_</a> <a id="7561" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="7563" class="Symbol">))</a> <a id="7566" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7568" class="Symbol">_)</a> <a id="7571" class="Symbol">=</a> <a id="7573" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7578" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7597" class="Symbol">((</a><a id="7599" href="Untyped.CEKWithCost.html#7599" class="Bound">s</a> <a id="7601" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7603" class="Symbol">(</a><a id="7604" href="Untyped.CEK.html#1533" class="InductiveConstructor">V-con</a> <a id="7610" class="Symbol">_</a> <a id="7612" class="Symbol">_</a> <a id="7614" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="7616" class="Symbol">))</a> <a id="7619" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7621" class="Symbol">_)</a> <a id="7624" class="Symbol">=</a> <a id="7626" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7631" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7650" class="Symbol">((</a><a id="7652" href="Untyped.CEKWithCost.html#7652" class="Bound">s</a> <a id="7654" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7656" class="Symbol">(</a><a id="7657" href="Untyped.CEK.html#1576" class="InductiveConstructor">V-delay</a> <a id="7665" class="Symbol">_</a> <a id="7667" class="Symbol">_</a> <a id="7669" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="7671" class="Symbol">))</a> <a id="7674" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7676" class="Symbol">_)</a> <a id="7679" class="Symbol">=</a> <a id="7681" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7686" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7705" class="Symbol">((</a><a id="7707" href="Untyped.CEKWithCost.html#7707" class="Bound">s</a> <a id="7709" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7711" class="Symbol">(</a><a id="7712" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="7721" class="Symbol">_</a> <a id="7723" class="Symbol">_</a> <a id="7725" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="7727" class="Symbol">))</a> <a id="7730" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7732" class="Symbol">_)</a> <a id="7735" class="Symbol">=</a> <a id="7737" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7742" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7761" class="Symbol">((</a><a id="7763" href="Untyped.CEKWithCost.html#7763" class="Bound">s</a> <a id="7765" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7767" class="Symbol">(</a><a id="7768" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="7773" href="Untyped.CEKWithCost.html#7773" class="Bound">b</a> <a id="7775" class="Symbol">{</a><a id="7776" class="Argument">am</a> <a id="7779" class="Symbol">=</a> <a id="7781" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a><a id="7785" class="Symbol">}</a> <a id="7787" href="Untyped.CEKWithCost.html#7787" class="Bound">x</a> <a id="7789" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="7791" class="Symbol">))</a> <a id="7794" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7796" href="Untyped.CEKWithCost.html#7796" class="Bound">V</a><a id="7797" class="Symbol">)</a> <a id="7799" class="Keyword">with</a> <a id="7804" href="Untyped.CEK.html#18143" class="Function">BUILTIN&#39;</a> <a id="7813" href="Untyped.CEKWithCost.html#7773" class="Bound">b</a> <a id="7815" class="Symbol">(</a><a id="7816" href="Untyped.CEK.html#2083" class="InductiveConstructor">app</a> <a id="7820" href="Untyped.CEKWithCost.html#7787" class="Bound">x</a> <a id="7822" href="Untyped.CEKWithCost.html#7796" class="Bound">V</a><a id="7823" class="Symbol">)</a>
<a id="7825" class="Symbol">...</a> <a id="7829" class="Symbol">|</a> <a id="7831" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="7836" class="Symbol">_</a> <a id="7838" class="Symbol">=</a> <a id="7840" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7845" class="Symbol">...</a> <a id="7849" class="Symbol">|</a> <a id="7851" href="Utils.html#1183" class="InductiveConstructor">inj₂</a> <a id="7856" class="Symbol">_</a> <a id="7858" class="Symbol">=</a> <a id="7860" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7865" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7884" class="Symbol">((</a><a id="7886" href="Untyped.CEKWithCost.html#7886" class="Bound">s</a> <a id="7888" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7890" class="Symbol">(</a><a id="7891" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="7896" class="Symbol">_</a> <a id="7898" class="Symbol">{</a><a id="7899" class="Argument">am</a> <a id="7902" class="Symbol">=</a> <a id="7904" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="7908" class="Symbol">_}</a> <a id="7911" class="Symbol">_</a> <a id="7913" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="7915" class="Symbol">))</a> <a id="7918" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7920" class="Symbol">_)</a> <a id="7923" class="Symbol">=</a> <a id="7925" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7930" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="7949" class="Symbol">((</a><a id="7951" href="Untyped.CEKWithCost.html#7951" class="Bound">s</a> <a id="7953" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="7955" class="Symbol">(</a><a id="7956" href="Untyped.CEK.html#1824" class="InductiveConstructor">V-IΠ</a> <a id="7961" class="Symbol">_</a> <a id="7963" class="Symbol">_</a> <a id="7965" href="Untyped.CEK.html#3387" class="InductiveConstructor Operator">·-</a><a id="7967" class="Symbol">))</a> <a id="7970" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="7972" class="Symbol">_)</a> <a id="7975" class="Symbol">=</a> <a id="7977" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="7982" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8001" class="Symbol">((</a><a id="8003" href="Untyped.CEKWithCost.html#8003" class="Bound">s</a> <a id="8005" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8007" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="8013" class="Symbol">)</a> <a id="8015" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8017" href="Untyped.CEK.html#1492" class="InductiveConstructor">V-ƛ</a> <a id="8021" class="Symbol">_</a> <a id="8023" class="Symbol">_)</a> <a id="8026" class="Symbol">=</a> <a id="8028" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8033" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8052" class="Symbol">((</a><a id="8054" href="Untyped.CEKWithCost.html#8054" class="Bound">s</a> <a id="8056" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8058" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="8064" class="Symbol">)</a> <a id="8066" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8068" href="Untyped.CEK.html#1533" class="InductiveConstructor">V-con</a> <a id="8074" class="Symbol">_</a> <a id="8076" class="Symbol">_)</a> <a id="8079" class="Symbol">=</a> <a id="8081" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8086" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8105" class="Symbol">((</a><a id="8107" href="Untyped.CEKWithCost.html#8107" class="Bound">s</a> <a id="8109" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8111" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="8117" class="Symbol">)</a> <a id="8119" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8121" href="Untyped.CEK.html#1576" class="InductiveConstructor">V-delay</a> <a id="8129" href="Untyped.CEKWithCost.html#8129" class="Bound">ρ</a> <a id="8131" href="Untyped.CEKWithCost.html#8131" class="Bound">x</a><a id="8132" class="Symbol">)</a> <a id="8134" class="Symbol">=</a> <a id="8136" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8155" class="Symbol">(</a><a id="8156" href="Untyped.CEKWithCost.html#8107" class="Bound">s</a> <a id="8158" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="8160" href="Untyped.CEKWithCost.html#8129" class="Bound">ρ</a> <a id="8162" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="8164" href="Untyped.CEKWithCost.html#8131" class="Bound">x</a><a id="8165" class="Symbol">)</a>
<a id="8167" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8186" class="Symbol">((</a><a id="8188" href="Untyped.CEKWithCost.html#8188" class="Bound">s</a> <a id="8190" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8192" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="8198" class="Symbol">)</a> <a id="8200" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8202" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="8211" class="Symbol">_</a> <a id="8213" class="Symbol">_)</a> <a id="8216" class="Symbol">=</a> <a id="8218" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8223" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8242" class="Symbol">((</a><a id="8244" href="Untyped.CEKWithCost.html#8244" class="Bound">s</a> <a id="8246" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8248" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="8254" class="Symbol">)</a> <a id="8256" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8258" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="8263" class="Symbol">_</a> <a id="8265" class="Symbol">_)</a> <a id="8268" class="Symbol">=</a> <a id="8270" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8275" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8294" class="Symbol">((</a><a id="8296" href="Untyped.CEKWithCost.html#8296" class="Bound">s</a> <a id="8298" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8300" href="Untyped.CEK.html#3409" class="InductiveConstructor">force-</a><a id="8306" class="Symbol">)</a> <a id="8308" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8310" href="Untyped.CEK.html#1824" class="InductiveConstructor">V-IΠ</a> <a id="8315" class="Symbol">_</a> <a id="8317" class="Symbol">_)</a> <a id="8320" class="Symbol">=</a> <a id="8322" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8327" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8346" class="Symbol">((</a><a id="8348" href="Untyped.CEKWithCost.html#8348" class="Bound">s</a> <a id="8350" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8352" href="Untyped.CEK.html#3426" class="InductiveConstructor">constr-</a> <a id="8360" class="Symbol">_</a> <a id="8362" class="Symbol">_</a> <a id="8364" class="Symbol">_</a> <a id="8366" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="8368" class="Symbol">)</a> <a id="8370" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8372" class="Symbol">_)</a> <a id="8375" class="Symbol">=</a> <a id="8377" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8382" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8401" class="Symbol">((</a><a id="8403" href="Untyped.CEKWithCost.html#8403" class="Bound">s</a> <a id="8405" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8407" href="Untyped.CEK.html#3426" class="InductiveConstructor">constr-</a> <a id="8415" class="Symbol">_</a> <a id="8417" class="Symbol">_</a> <a id="8419" class="Symbol">_</a> <a id="8421" class="Symbol">(_</a> <a id="8424" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="8426" class="Symbol">_))</a> <a id="8430" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8432" class="Symbol">_)</a> <a id="8435" class="Symbol">=</a> <a id="8437" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8442" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8461" class="Symbol">((</a><a id="8463" href="Untyped.CEKWithCost.html#8463" class="Bound">s</a> <a id="8465" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8467" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="8473" class="Symbol">_</a> <a id="8475" class="Symbol">_)</a> <a id="8478" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8480" href="Untyped.CEK.html#1492" class="InductiveConstructor">V-ƛ</a> <a id="8484" class="Symbol">_</a> <a id="8486" class="Symbol">_)</a> <a id="8489" class="Symbol">=</a> <a id="8491" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8496" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8515" class="Symbol">((</a><a id="8517" href="Untyped.CEKWithCost.html#8517" class="Bound">s</a> <a id="8519" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8521" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="8527" class="Symbol">_</a> <a id="8529" class="Symbol">_)</a> <a id="8532" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8534" href="Untyped.CEK.html#1533" class="InductiveConstructor">V-con</a> <a id="8540" class="Symbol">_</a> <a id="8542" class="Symbol">_)</a> <a id="8545" class="Symbol">=</a> <a id="8547" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8552" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8571" class="Symbol">((</a><a id="8573" href="Untyped.CEKWithCost.html#8573" class="Bound">s</a> <a id="8575" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8577" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="8583" class="Symbol">_</a> <a id="8585" class="Symbol">_)</a> <a id="8588" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8590" href="Untyped.CEK.html#1576" class="InductiveConstructor">V-delay</a> <a id="8598" class="Symbol">_</a> <a id="8600" class="Symbol">_)</a> <a id="8603" class="Symbol">=</a> <a id="8605" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8610" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8629" class="Symbol">((</a><a id="8631" href="Untyped.CEKWithCost.html#8631" class="Bound">s</a> <a id="8633" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8635" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="8641" class="Symbol">_</a> <a id="8643" class="Symbol">_)</a> <a id="8646" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8648" href="Untyped.CEK.html#1615" class="InductiveConstructor">V-constr</a> <a id="8657" class="Symbol">_</a> <a id="8659" class="Symbol">_)</a> <a id="8662" class="Symbol">=</a> <a id="8664" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8669" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8688" class="Symbol">((</a><a id="8690" href="Untyped.CEKWithCost.html#8690" class="Bound">s</a> <a id="8692" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8694" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="8700" class="Symbol">_</a> <a id="8702" class="Symbol">_)</a> <a id="8705" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8707" href="Untyped.CEK.html#1665" class="InductiveConstructor">V-I⇒</a> <a id="8712" class="Symbol">_</a> <a id="8714" class="Symbol">_)</a> <a id="8717" class="Symbol">=</a> <a id="8719" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8724" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8743" class="Symbol">((</a><a id="8745" href="Untyped.CEKWithCost.html#8745" class="Bound">s</a> <a id="8747" href="Untyped.CEK.html#1222" class="InductiveConstructor Operator">,</a> <a id="8749" href="Untyped.CEK.html#3492" class="InductiveConstructor">case-</a> <a id="8755" class="Symbol">_</a> <a id="8757" class="Symbol">_)</a> <a id="8760" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="8762" href="Untyped.CEK.html#1824" class="InductiveConstructor">V-IΠ</a> <a id="8767" class="Symbol">_</a> <a id="8769" class="Symbol">_)</a> <a id="8772" class="Symbol">=</a> <a id="8774" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8779" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8798" class="Symbol">(</a><a id="8799" href="Untyped.CEK.html#3661" class="InductiveConstructor">□</a> <a id="8801" class="Symbol">_)</a> <a id="8804" class="Symbol">=</a> <a id="8806" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="8811" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="8830" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="8832" class="Symbol">=</a> <a id="8834" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>

<a id="cekStepperEquivalence"></a><a id="8840" href="Untyped.CEKWithCost.html#8840" class="Function">cekStepperEquivalence</a> <a id="8862" class="Symbol">:</a> <a id="8864" class="Symbol">∀</a> <a id="8866" href="Untyped.CEKWithCost.html#8866" class="Bound">n</a> <a id="8868" href="Untyped.CEKWithCost.html#8868" class="Bound">s</a> <a id="8870" class="Symbol">→</a> <a id="8872" href="Untyped.CEK.html#21068" class="Function">stepper</a> <a id="8880" href="Untyped.CEKWithCost.html#8866" class="Bound">n</a> <a id="8882" href="Untyped.CEKWithCost.html#8868" class="Bound">s</a> <a id="8884" href="Agda.Builtin.Equality.html#150" class="Datatype Operator">≡</a> <a id="8886" href="Utils.html#4023" class="Field">wrvalue</a> <a id="8894" class="Symbol">(</a><a id="8895" href="Untyped.CEKWithCost.html#6629" class="Function">stepperC</a> <a id="8904" href="Untyped.CEKWithCost.html#8866" class="Bound">n</a> <a id="8906" href="Untyped.CEKWithCost.html#8868" class="Bound">s</a><a id="8907" class="Symbol">)</a> 
<a id="8910" href="Untyped.CEKWithCost.html#8840" class="Function">cekStepperEquivalence</a> <a id="8932" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="8937" href="Untyped.CEKWithCost.html#8937" class="Bound">s</a> <a id="8939" class="Symbol">=</a> <a id="8941" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a> 
<a id="8947" href="Untyped.CEKWithCost.html#8840" class="Function">cekStepperEquivalence</a> <a id="8969" class="Symbol">(</a><a id="8970" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="8974" href="Untyped.CEKWithCost.html#8974" class="Bound">n</a><a id="8975" class="Symbol">)</a> <a id="8977" href="Untyped.CEKWithCost.html#8977" class="Bound">s</a> <a id="8979" class="Keyword">rewrite</a> <a id="8987" href="Relation.Binary.PropositionalEquality.Core.html#1693" class="Function">sym</a> <a id="8991" class="Symbol">(</a><a id="8992" href="Untyped.CEKWithCost.html#6841" class="Function">cekStepEquivalence</a> <a id="9011" href="Untyped.CEKWithCost.html#8977" class="Bound">s</a><a id="9012" class="Symbol">)</a> <a id="9014" class="Keyword">with</a> <a id="9019" href="Untyped.CEK.html#18673" class="Function">step</a> <a id="9024" href="Untyped.CEKWithCost.html#8977" class="Bound">s</a> 
<a id="9027" class="Symbol">...</a> <a id="9031" class="Symbol">|</a> <a id="9033" href="Untyped.CEKWithCost.html#9033" class="Bound">s</a> <a id="9035" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="9037" href="Untyped.CEKWithCost.html#9037" class="Bound">ρ</a> <a id="9039" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="9041" href="Untyped.CEKWithCost.html#9041" class="Bound">t</a> <a id="9043" class="Symbol">=</a> <a id="9045" href="Untyped.CEKWithCost.html#8840" class="Function">cekStepperEquivalence</a> <a id="9067" class="Bound">n</a> <a id="9069" class="Symbol">(</a><a id="9070" href="Untyped.CEKWithCost.html#9033" class="Bound">s</a> <a id="9072" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">;</a> <a id="9074" href="Untyped.CEKWithCost.html#9037" class="Bound">ρ</a> <a id="9076" href="Untyped.CEK.html#3567" class="InductiveConstructor Operator">▻</a> <a id="9078" href="Untyped.CEKWithCost.html#9041" class="Bound">t</a><a id="9079" class="Symbol">)</a>
<a id="9081" class="Symbol">...</a> <a id="9085" class="Symbol">|</a> <a id="9087" href="Untyped.CEKWithCost.html#9087" class="Bound">s</a> <a id="9089" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="9091" href="Untyped.CEKWithCost.html#9091" class="Bound">v</a> <a id="9093" class="Symbol">=</a> <a id="9095" href="Untyped.CEKWithCost.html#8840" class="Function">cekStepperEquivalence</a> <a id="9117" class="Bound">n</a>  <a id="9120" class="Symbol">(</a><a id="9121" href="Untyped.CEKWithCost.html#9087" class="Bound">s</a> <a id="9123" href="Untyped.CEK.html#3623" class="InductiveConstructor Operator">◅</a> <a id="9125" href="Untyped.CEKWithCost.html#9091" class="Bound">v</a><a id="9126" class="Symbol">)</a>
<a id="9128" class="Symbol">...</a> <a id="9132" class="Symbol">|</a> <a id="9134" href="Untyped.CEK.html#3661" class="InductiveConstructor">□</a> <a id="9136" href="Untyped.CEKWithCost.html#9136" class="Bound">x</a> <a id="9138" class="Symbol">=</a> <a id="9140" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
<a id="9145" class="Symbol">...</a> <a id="9149" class="Symbol">|</a> <a id="9151" href="Untyped.CEK.html#3681" class="InductiveConstructor">◆</a> <a id="9153" class="Symbol">=</a> <a id="9155" href="Agda.Builtin.Equality.html#207" class="InductiveConstructor">refl</a>
</pre>

    </section>
  </body>
</html>