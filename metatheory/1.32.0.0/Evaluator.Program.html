<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Program Evaluators</title>
    <link rel="stylesheet" href="./Agda.css">
  </head>
  <body>
    <h1>Program Evaluators</h1>
    <section>
      <h1 id="evaluators-for-programs">Evaluators for Programs</h1>

<pre class="Agda"><a id="79" class="Keyword">module</a> <a id="86" href="Evaluator.Program.html" class="Module">Evaluator.Program</a> <a id="104" class="Keyword">where</a>
</pre>
<h2 id="imports">Imports</h2>

<pre class="Agda"><a id="131" class="Keyword">open</a> <a id="136" class="Keyword">import</a> <a id="143" href="Function.html" class="Module">Function</a> <a id="152" class="Keyword">using</a> <a id="158" class="Symbol">(</a><a id="159" href="Function.Base.html#1928" class="Function Operator">_$_</a><a id="162" class="Symbol">;</a><a id="163" href="Function.Base.html#1040" class="Function Operator">_∘_</a><a id="166" class="Symbol">)</a>
<a id="168" class="Keyword">open</a> <a id="173" class="Keyword">import</a> <a id="180" href="Data.String.html" class="Module">Data.String</a> <a id="192" class="Keyword">using</a> <a id="198" class="Symbol">(</a><a id="199" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="205" class="Symbol">;</a><a id="206" href="Data.String.Base.html#2375" class="Function Operator">_++_</a><a id="210" class="Symbol">)</a>
<a id="212" class="Keyword">open</a> <a id="217" class="Keyword">import</a> <a id="224" href="Agda.Builtin.Nat.html" class="Module">Agda.Builtin.Nat</a>
<a id="241" class="Keyword">open</a> <a id="246" class="Keyword">import</a> <a id="253" href="Data.Product.html" class="Module">Data.Product</a> <a id="266" class="Keyword">using</a> <a id="272" class="Symbol">(</a><a id="273" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a><a id="274" class="Symbol">)</a> <a id="276" class="Keyword">renaming</a> <a id="285" class="Symbol">(</a><a id="286" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">_,_</a> <a id="290" class="Symbol">to</a> <a id="293" class="InductiveConstructor Operator">_,,_</a><a id="297" class="Symbol">)</a>
<a id="299" class="Keyword">open</a> <a id="304" class="Keyword">import</a> <a id="311" href="Data.Empty.html" class="Module">Data.Empty</a> <a id="322" class="Keyword">using</a> <a id="328" class="Symbol">(</a><a id="329" href="Data.Empty.html#535" class="Datatype">⊥</a><a id="330" class="Symbol">)</a> 

<a id="334" class="Keyword">open</a> <a id="339" class="Keyword">import</a> <a id="346" href="Type.html" class="Module">Type</a> <a id="351" class="Keyword">using</a> <a id="357" class="Symbol">(</a><a id="358" href="Type.html#515" class="Datatype">Ctx⋆</a><a id="362" class="Symbol">;</a><a id="363" href="Type.html#534" class="InductiveConstructor">∅</a><a id="364" class="Symbol">;</a><a id="365" href="Type.html#545" class="InductiveConstructor Operator">_,⋆_</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="Check.html" class="Module">Check</a> <a id="389" class="Keyword">using</a> <a id="395" class="Symbol">(</a><a id="396" href="Check.html#2133" class="Datatype">TypeError</a><a id="405" class="Symbol">;</a><a id="406" href="Check.html#17852" class="Function">inferType</a><a id="415" class="Symbol">;</a><a id="416" href="Check.html#8702" class="Function">inferKind</a><a id="425" class="Symbol">;</a><a id="426" href="Check.html#3310" class="Function">decKind</a><a id="433" class="Symbol">;</a><a id="434" href="Check.html#8626" class="Function">checkKind</a><a id="443" class="Symbol">;</a><a id="444" href="Check.html#17758" class="Function">checkType</a><a id="453" class="Symbol">)</a>
<a id="455" class="Keyword">open</a> <a id="460" href="Check.html#2133" class="Module">TypeError</a> <a id="470" class="Comment">-- Bring all TypeError constructors in scope.</a>

<a id="517" class="Keyword">open</a> <a id="522" class="Keyword">import</a> <a id="529" href="Scoped.Extrication.html" class="Module">Scoped.Extrication</a> <a id="548" class="Keyword">using</a> <a id="554" class="Symbol">(</a><a id="555" href="Scoped.Extrication.html#1317" class="Function">extricateNf⋆</a><a id="567" class="Symbol">;</a><a id="568" href="Scoped.Extrication.html#3032" class="Function">extricate</a><a id="577" class="Symbol">)</a>
<a id="579" class="Keyword">open</a> <a id="584" class="Keyword">import</a> <a id="591" href="Type.BetaNormal.html" class="Module">Type.BetaNormal</a> <a id="607" class="Keyword">using</a> <a id="613" class="Symbol">(</a><a id="614" href="Type.BetaNormal.html#1046" class="Datatype Operator">_⊢Nf⋆_</a><a id="620" class="Symbol">)</a>
<a id="622" class="Keyword">import</a> <a id="629" href="Untyped.html" class="Module">Untyped</a> <a id="637" class="Symbol">as</a> <a id="640" class="Module">U</a> <a id="642" class="Keyword">using</a> <a id="648" class="Symbol">(</a><a id="649" href="Untyped.html#1295" class="Datatype Operator">_⊢</a><a id="651" class="Symbol">;</a><a id="652" href="Untyped.html#5840" class="Function">scopeCheckU0</a><a id="664" class="Symbol">;</a><a id="665" href="Untyped.html#4512" class="Function">extricateU0</a><a id="676" class="Symbol">;</a><a id="677" href="Untyped.html#6023" class="Function">decUTm</a><a id="683" class="Symbol">)</a>
<a id="685" class="Keyword">import</a> <a id="692" href="Untyped.CEKWithCost.html" class="Module">Untyped.CEKWithCost</a> <a id="712" class="Symbol">as</a> <a id="715" class="Module">U</a> <a id="717" class="Keyword">using</a> <a id="723" class="Symbol">(</a><a id="724" href="Untyped.CEKWithCost.html#6629" class="Function">stepperC</a><a id="732" class="Symbol">)</a>
<a id="734" class="Keyword">open</a> <a id="739" class="Keyword">import</a> <a id="746" href="Cost.Base.html" class="Module">Cost.Base</a>
<a id="756" class="Keyword">open</a> <a id="761" class="Keyword">import</a> <a id="768" href="Cost.html" class="Module">Cost</a> <a id="773" class="Keyword">using</a> <a id="779" class="Symbol">(</a><a id="780" href="Cost.html#1959" class="Record">ExBudget</a><a id="788" class="Symbol">;</a><a id="789" href="Cost.html#4652" class="Function">machineParameters</a><a id="806" class="Symbol">;</a><a id="807" href="Cost.html#6864" class="Function">tallyingMachineParameters</a><a id="832" class="Symbol">;</a><a id="833" href="Cost.html#4867" class="Function">countingReport</a><a id="847" class="Symbol">;</a><a id="848" href="Cost.html#7117" class="Function">tallyingReport</a><a id="862" class="Symbol">;</a><a id="863" href="Cost.html#3611" class="Function">CostModel</a><a id="872" class="Symbol">)</a>
<a id="874" class="Keyword">open</a> <a id="879" class="Keyword">import</a> <a id="886" href="Cost.Raw.html" class="Module">Cost.Raw</a> <a id="895" class="Keyword">using</a> <a id="901" class="Symbol">(</a><a id="902" href="Cost.Raw.html#5784" class="Function">RawCostModel</a><a id="914" class="Symbol">)</a>
<a id="916" class="Keyword">open</a> <a id="921" class="Keyword">import</a> <a id="928" href="Cost.Model.html" class="Module">Cost.Model</a> <a id="939" class="Keyword">using</a> <a id="945" class="Symbol">(</a><a id="946" href="Cost.Model.html#9634" class="Function">createMap</a><a id="955" class="Symbol">)</a>
<a id="957" class="Keyword">import</a> <a id="964" href="RawU.html" class="Module">RawU</a> <a id="969" class="Symbol">as</a> <a id="972" class="Module">U</a> <a id="974" class="Keyword">using</a> <a id="980" class="Symbol">(</a><a id="981" href="RawU.html#6191" class="Datatype">Untyped</a><a id="988" class="Symbol">)</a>

<a id="991" class="Keyword">open</a> <a id="996" class="Keyword">import</a> <a id="1003" href="Untyped.CEK.html" class="Module">Untyped.CEK</a> <a id="1015" class="Symbol">as</a> <a id="1018" class="Module">U</a> <a id="1020" class="Keyword">using</a> <a id="1026" class="Symbol">(</a><a id="1027" href="Untyped.CEK.html#23095" class="Function">stepper</a><a id="1034" class="Symbol">;</a><a id="1035" href="Untyped.CEK.html#1178" class="Datatype">Stack</a><a id="1040" class="Symbol">;</a><a id="1041" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a><a id="1042" class="Symbol">;</a><a id="1043" href="Untyped.CEK.html#1281" class="Datatype">Env</a><a id="1046" class="Symbol">;</a><a id="1047" href="Untyped.CEK.html#1305" class="InductiveConstructor">[]</a><a id="1049" class="Symbol">;</a><a id="1050" href="Untyped.CEK.html#3540" class="Datatype">State</a><a id="1055" class="Symbol">)</a>
<a id="1057" class="Keyword">open</a> <a id="1062" href="Untyped.CEK.html#3540" class="Module">U.State</a>

<a id="1071" class="Keyword">open</a> <a id="1076" class="Keyword">import</a> <a id="1083" href="Raw.html" class="Module">Raw</a> <a id="1087" class="Keyword">using</a> <a id="1093" class="Symbol">(</a><a id="1094" href="Raw.html#1435" class="Datatype">RawTm</a><a id="1099" class="Symbol">;</a><a id="1100" href="Raw.html#810" class="Datatype">RawTy</a><a id="1105" class="Symbol">;</a><a id="1106" href="Raw.html#5736" class="Function">rawPrinter</a><a id="1116" class="Symbol">;</a><a id="1117" href="Raw.html#4707" class="Function">rawTyPrinter</a><a id="1129" class="Symbol">;</a><a id="1130" href="Raw.html#2640" class="Function">decRTy</a><a id="1136" class="Symbol">;</a><a id="1137" href="Raw.html#3453" class="Function">decRTm</a><a id="1143" class="Symbol">)</a>
<a id="1145" class="Keyword">open</a> <a id="1150" class="Keyword">import</a> <a id="1157" href="Scoped.html" class="Module">Scoped</a> <a id="1164" class="Keyword">using</a> <a id="1170" class="Symbol">(</a><a id="1171" href="Scoped.html#7731" class="Postulate">FreeVariableError</a><a id="1188" class="Symbol">;</a><a id="1189" href="Scoped.html#7826" class="Datatype">ScopeError</a><a id="1199" class="Symbol">;</a><a id="1200" href="Scoped.html#7875" class="InductiveConstructor">freeVariableError</a><a id="1217" class="Symbol">;</a><a id="1218" href="Scoped.html#10975" class="Function">extricateScopeTy</a><a id="1234" class="Symbol">;</a><a id="1235" href="Scoped.html#6898" class="Datatype">ScopedTm</a><a id="1243" class="Symbol">;</a><a id="1244" href="Scoped.html#1416" class="Datatype">Weirdℕ</a><a id="1250" class="Symbol">;</a><a id="1251" href="Scoped.html#9734" class="Function">scopeCheckTm</a><a id="1263" class="Symbol">;</a><a id="1264" href="Scoped.html#4361" class="Function">shifter</a><a id="1271" class="Symbol">;</a><a id="1272" href="Scoped.html#6020" class="Function">unshifter</a><a id="1281" class="Symbol">;</a><a id="1282" href="Scoped.html#11954" class="Function">extricateScope</a><a id="1296" class="Symbol">;</a><a id="1297" href="Scoped.html#5195" class="Function">unshifterTy</a><a id="1308" class="Symbol">;</a><a id="1309" href="Scoped.html#8558" class="Function">scopeCheckTy</a><a id="1321" class="Symbol">;</a><a id="1322" href="Scoped.html#3560" class="Function">shifterTy</a><a id="1331" class="Symbol">)</a>
<a id="1333" class="Keyword">open</a> <a id="1338" href="Scoped.html#1416" class="Module">Weirdℕ</a> <a id="1345" class="Comment">-- Bring Weirdℕ constructors in scope</a>
<a id="1383" class="Keyword">open</a> <a id="1388" class="Keyword">import</a> <a id="1395" href="Utils.html" class="Module">Utils</a> <a id="1401" class="Keyword">using</a> <a id="1407" class="Symbol">(</a><a id="1408" href="Utils.html#1126" class="Datatype">Either</a><a id="1414" class="Symbol">;</a><a id="1415" href="Utils.html#1159" class="InductiveConstructor">inj₁</a><a id="1419" class="Symbol">;</a><a id="1420" href="Utils.html#1183" class="InductiveConstructor">inj₂</a><a id="1424" class="Symbol">;</a><a id="1425" href="Utils.html#3700" class="Function">withE</a><a id="1430" class="Symbol">;</a><a id="1431" href="Utils.html#6802" class="Datatype">Kind</a><a id="1435" class="Symbol">;</a><a id="1436" href="Utils.html#6821" class="InductiveConstructor">*</a><a id="1437" class="Symbol">;</a><a id="1438" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a><a id="1443" class="Symbol">;</a><a id="1444" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a><a id="1451" class="Symbol">;</a><a id="1452" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1456" class="Symbol">;</a><a id="1457" href="Utils.html#2866" class="Record">Monad</a><a id="1462" class="Symbol">;</a><a id="1463" href="Utils.html#4362" class="Datatype">RuntimeError</a><a id="1475" class="Symbol">;</a><a id="1476" href="Utils.html#3815" class="Function">dec2Either</a><a id="1486" class="Symbol">;</a><a id="1487" href="Utils.html#4005" class="InductiveConstructor Operator">_,_</a><a id="1490" class="Symbol">)</a>
<a id="1492" class="Keyword">open</a> <a id="1497" href="Utils.html#4362" class="Module">RuntimeError</a>
<a id="1510" class="Keyword">open</a> <a id="1515" href="Utils.html#2866" class="Module">Monad</a> <a id="1521" class="Symbol"></a>

<a id="1530" class="Keyword">open</a> <a id="1535" class="Keyword">import</a> <a id="1542" href="Algorithmic.html" class="Module">Algorithmic</a> <a id="1554" class="Keyword">using</a> <a id="1560" class="Symbol">(</a><a id="1561" href="Algorithmic.html#5298" class="Datatype Operator">_⊢_</a><a id="1564" class="Symbol">;</a><a id="1565" href="Algorithmic.html#1668" class="InductiveConstructor">∅</a><a id="1566" class="Symbol">;</a><a id="1567" href="Algorithmic.html#7652" class="InductiveConstructor">error</a><a id="1572" class="Symbol">)</a>

<a id="1575" class="Keyword">open</a> <a id="1580" class="Keyword">import</a> <a id="1587" href="Algorithmic.CK.html" class="Module">Algorithmic.CK</a> <a id="1602" class="Keyword">using</a> <a id="1608" class="Symbol">(</a><a id="1609" href="Algorithmic.CK.html#4621" class="Function">stepper</a><a id="1616" class="Symbol">;</a><a id="1617" href="Algorithmic.CK.html#1314" class="Datatype">State</a><a id="1622" class="Symbol">;</a><a id="1623" href="Algorithmic.CK.html#1127" class="Datatype">Stack</a><a id="1628" class="Symbol">;</a><a id="1629" href="Algorithmic.CK.html#1178" class="InductiveConstructor">ε</a><a id="1630" class="Symbol">)</a>
<a id="1632" class="Keyword">open</a> <a id="1637" href="Algorithmic.CK.html#1314" class="Module">Algorithmic.CK.State</a>

<a id="1659" class="Keyword">open</a> <a id="1664" class="Keyword">import</a> <a id="1671" href="Algorithmic.CEK.html" class="Module">Algorithmic.CEK</a> <a id="1687" class="Keyword">using</a> <a id="1693" class="Symbol">(</a><a id="1694" href="Algorithmic.CEK.html#19732" class="Function">stepper</a><a id="1701" class="Symbol">;</a><a id="1702" href="Algorithmic.CEK.html#17331" class="Datatype">State</a><a id="1707" class="Symbol">;</a><a id="1708" href="Algorithmic.CEK.html#17200" class="Datatype">Stack</a><a id="1713" class="Symbol">;</a><a id="1714" href="Algorithmic.CEK.html#17252" class="InductiveConstructor">ε</a><a id="1715" class="Symbol">;</a><a id="1716" href="Algorithmic.CEK.html#1846" class="Datatype">Env</a><a id="1719" class="Symbol">;</a><a id="1720" href="Algorithmic.CEK.html#3849" class="InductiveConstructor">[]</a><a id="1722" class="Symbol">)</a>
<a id="1724" class="Keyword">open</a> <a id="1729" href="Algorithmic.CEK.html#17331" class="Module">Algorithmic.CEK.State</a>

<a id="1752" class="Keyword">open</a> <a id="1757" class="Keyword">import</a> <a id="1764" href="Algorithmic.Erasure.html" class="Module">Algorithmic.Erasure</a> <a id="1784" class="Keyword">using</a> <a id="1790" class="Symbol">(</a><a id="1791" href="Algorithmic.Erasure.html#2236" class="Function">erase</a><a id="1796" class="Symbol">)</a>
<a id="1798" class="Keyword">import</a> <a id="1805" href="Algorithmic.Evaluation.html" class="Module">Algorithmic.Evaluation</a> <a id="1828" class="Symbol">as</a> <a id="1831" class="Module">L</a> <a id="1833" class="Keyword">using</a><a id="1838" class="Symbol">(</a><a id="1839" href="Algorithmic.Evaluation.html#2114" class="Function">stepper</a><a id="1846" class="Symbol">)</a>

<a id="1849" class="Keyword">open</a> <a id="1854" class="Keyword">import</a> <a id="1861" href="Evaluator.Base.html" class="Module">Evaluator.Base</a> <a id="1876" class="Keyword">using</a> <a id="1882" class="Symbol">(</a><a id="1883" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a><a id="1888" class="Symbol">;</a><a id="1889" href="Evaluator.Base.html#1463" class="Function">uglyTypeError</a><a id="1902" class="Symbol">;</a><a id="1903" href="Evaluator.Base.html#3063" class="Function">maxsteps</a><a id="1911" class="Symbol">;</a><a id="1912" href="Evaluator.Base.html#802" class="Postulate">prettyPrintUTm</a><a id="1926" class="Symbol">;</a><a id="1927" href="Evaluator.Base.html#735" class="Postulate">prettyPrintTm</a><a id="1940" class="Symbol">;</a><a id="1941" href="Evaluator.Base.html#768" class="Postulate">prettyPrintTy</a><a id="1954" class="Symbol">;</a><a id="1955" href="Evaluator.Base.html#490" class="Postulate">ParseError</a><a id="1965" class="Symbol">)</a>
<a id="1967" class="Keyword">open</a> <a id="1972" href="Evaluator.Base.html#1242" class="Module">ERROR</a>
</pre>
<h2 id="imports-from-haskell">Imports from Haskell</h2>

<pre class="Agda"><a id="2012" class="Symbol">{-#</a> <a id="2016" class="Keyword">FOREIGN</a> <a id="2024" class="Pragma">GHC</a> <a id="2028" class="Pragma">import</a> <a id="2035" class="Pragma">PlutusCore.Executable.Common</a>  <a id="2065" class="Symbol">#-}</a>
<a id="2069" class="Symbol">{-#</a> <a id="2073" class="Keyword">FOREIGN</a> <a id="2081" class="Pragma">GHC</a> <a id="2085" class="Pragma">import</a> <a id="2092" class="Pragma">PlutusCore.Executable.Parsers</a> <a id="2122" class="Symbol">#-}</a>

<a id="2127" class="Keyword">postulate</a>
   <a id="Format"></a><a id="2140" href="Evaluator.Program.html#2140" class="Postulate">Format</a> <a id="2147" class="Symbol">:</a> <a id="2149" href="Agda.Primitive.html#388" class="Primitive">Set</a>
   <a id="Input"></a><a id="2156" href="Evaluator.Program.html#2156" class="Postulate">Input</a> <a id="2162" class="Symbol">:</a> <a id="2164" href="Agda.Primitive.html#388" class="Primitive">Set</a>

<a id="2169" class="Symbol">{-#</a> <a id="2173" class="Keyword">COMPILE</a> <a id="2181" class="Keyword">GHC</a> <a id="2185" href="Evaluator.Program.html#2140" class="Postulate">Format</a> <a id="2192" class="Pragma">=</a> <a id="2194" class="Pragma">type</a> <a id="2199" class="Pragma">Format</a> <a id="2206" class="Symbol">#-}</a>
<a id="2210" class="Symbol">{-#</a> <a id="2214" class="Keyword">COMPILE</a> <a id="2222" class="Keyword">GHC</a> <a id="2226" href="Evaluator.Program.html#2156" class="Postulate">Input</a> <a id="2232" class="Pragma">=</a> <a id="2234" class="Pragma">type</a> <a id="2239" class="Pragma">Input</a> <a id="2245" class="Symbol">#-}</a>

<a id="2250" class="Keyword">postulate</a>
  <a id="ProgramN"></a><a id="2262" href="Evaluator.Program.html#2262" class="Postulate">ProgramN</a> <a id="2271" class="Symbol">:</a> <a id="2273" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="Program"></a><a id="2279" href="Evaluator.Program.html#2279" class="Postulate">Program</a> <a id="2287" class="Symbol">:</a> <a id="2289" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="convP"></a><a id="2295" href="Evaluator.Program.html#2295" class="Postulate">convP</a> <a id="2301" class="Symbol">:</a> <a id="2303" href="Evaluator.Program.html#2279" class="Postulate">Program</a> <a id="2311" class="Symbol">→</a> <a id="2313" href="Raw.html#1435" class="Datatype">RawTm</a>
  <a id="deBruijnify"></a><a id="2321" href="Evaluator.Program.html#2321" class="Postulate">deBruijnify</a> <a id="2333" class="Symbol">:</a> <a id="2335" href="Evaluator.Program.html#2262" class="Postulate">ProgramN</a> <a id="2344" class="Symbol">→</a> <a id="2346" href="Utils.html#1126" class="Datatype">Either</a> <a id="2353" href="Scoped.html#7731" class="Postulate">FreeVariableError</a> <a id="2371" href="Evaluator.Program.html#2279" class="Postulate">Program</a>

  <a id="ProgramNU"></a><a id="2382" href="Evaluator.Program.html#2382" class="Postulate">ProgramNU</a> <a id="2392" class="Symbol">:</a> <a id="2394" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="ProgramU"></a><a id="2400" href="Evaluator.Program.html#2400" class="Postulate">ProgramU</a> <a id="2409" class="Symbol">:</a> <a id="2411" href="Agda.Primitive.html#388" class="Primitive">Set</a>
  <a id="deBruijnifyU"></a><a id="2417" href="Evaluator.Program.html#2417" class="Postulate">deBruijnifyU</a> <a id="2430" class="Symbol">:</a> <a id="2432" href="Evaluator.Program.html#2382" class="Postulate">ProgramNU</a> <a id="2442" class="Symbol">→</a> <a id="2444" href="Utils.html#1126" class="Datatype">Either</a> <a id="2451" href="Scoped.html#7731" class="Postulate">FreeVariableError</a> <a id="2469" href="Evaluator.Program.html#2400" class="Postulate">ProgramU</a>
  <a id="convPU"></a><a id="2480" href="Evaluator.Program.html#2480" class="Postulate">convPU</a> <a id="2487" class="Symbol">:</a> <a id="2489" href="Evaluator.Program.html#2400" class="Postulate">ProgramU</a> <a id="2498" class="Symbol">→</a> <a id="2500" href="RawU.html#6191" class="Datatype">U.Untyped</a>

<a id="2511" class="Symbol">{-#</a> <a id="2515" class="Keyword">FOREIGN</a> <a id="2523" class="Pragma">GHC</a> <a id="2527" class="Pragma">import</a> <a id="2534" class="Pragma">PlutusCore.DeBruijn</a> <a id="2554" class="Symbol">#-}</a>
<a id="2558" class="Symbol">{-#</a> <a id="2562" class="Keyword">FOREIGN</a> <a id="2570" class="Pragma">GHC</a> <a id="2574" class="Pragma">import</a> <a id="2581" class="Pragma">qualified</a> <a id="2591" class="Pragma">UntypedPlutusCore</a> <a id="2609" class="Pragma">as</a> <a id="2612" class="Pragma">U</a> <a id="2614" class="Symbol">#-}</a>
<a id="2618" class="Symbol">{-#</a> <a id="2622" class="Keyword">FOREIGN</a> <a id="2630" class="Pragma">GHC</a> <a id="2634" class="Pragma">import</a> <a id="2641" class="Pragma">qualified</a> <a id="2651" class="Pragma">UntypedPlutusCore.Parser</a> <a id="2676" class="Pragma">as</a> <a id="2679" class="Pragma">U</a> <a id="2681" class="Symbol">#-}</a>
<a id="2685" class="Symbol">{-#</a> <a id="2689" class="Keyword">FOREIGN</a> <a id="2697" class="Pragma">GHC</a> <a id="2701" class="Pragma">import</a> <a id="2708" class="Pragma">qualified</a> <a id="2718" class="Pragma">Untyped</a> <a id="2726" class="Pragma">as</a> <a id="2729" class="Pragma">U</a> <a id="2731" class="Symbol">#-}</a>
<a id="2735" class="Symbol">{-#</a> <a id="2739" class="Keyword">FOREIGN</a> <a id="2747" class="Pragma">GHC</a> <a id="2751" class="Pragma">import</a> <a id="2758" class="Pragma">Raw</a> <a id="2762" class="Symbol">#-}</a>
<a id="2766" class="Symbol">{-#</a> <a id="2770" class="Keyword">FOREIGN</a> <a id="2778" class="Pragma">GHC</a> <a id="2782" class="Pragma">import</a> <a id="2789" class="Pragma">PlutusCore</a> <a id="2800" class="Symbol">#-}</a>
<a id="2804" class="Symbol">{-#</a> <a id="2808" class="Keyword">FOREIGN</a> <a id="2816" class="Pragma">GHC</a> <a id="2820" class="Pragma">import</a> <a id="2827" class="Pragma">Data.Bifunctor</a> <a id="2842" class="Symbol">#-}</a>
<a id="2846" class="Symbol">{-#</a> <a id="2850" class="Keyword">FOREIGN</a> <a id="2858" class="Pragma">GHC</a> <a id="2862" class="Pragma">import</a> <a id="2869" class="Pragma">Data.Functor</a> <a id="2882" class="Symbol">#-}</a>
<a id="2886" class="Symbol">{-#</a> <a id="2890" class="Keyword">FOREIGN</a> <a id="2898" class="Pragma">GHC</a> <a id="2902" class="Pragma">import</a> <a id="2909" class="Pragma">Data.Either</a> <a id="2921" class="Symbol">#-}</a>
<a id="2925" class="Symbol">{-#</a> <a id="2929" class="Keyword">FOREIGN</a> <a id="2937" class="Pragma">GHC</a> <a id="2941" class="Pragma">import</a> <a id="2948" class="Pragma">Control.Monad.Trans.Except</a> <a id="2975" class="Symbol">#-}</a>

<a id="2980" class="Symbol">{-#</a> <a id="2984" class="Keyword">COMPILE</a> <a id="2992" class="Keyword">GHC</a> <a id="2996" href="Evaluator.Program.html#2262" class="Postulate">ProgramN</a> <a id="3005" class="Pragma">=</a> <a id="3007" class="Pragma">type</a> <a id="3012" class="Pragma">PlutusCore.Program</a> <a id="3031" class="Pragma">TyName</a> <a id="3038" class="Pragma">Name</a> <a id="3043" class="Pragma">DefaultUni</a> <a id="3054" class="Pragma">DefaultFun</a> <a id="3065" class="Pragma">PlutusCore.SrcSpan</a> <a id="3084" class="Symbol">#-}</a>
<a id="3088" class="Symbol">{-#</a> <a id="3092" class="Keyword">COMPILE</a> <a id="3100" class="Keyword">GHC</a> <a id="3104" href="Evaluator.Program.html#2279" class="Postulate">Program</a> <a id="3112" class="Pragma">=</a> <a id="3114" class="Pragma">type</a> <a id="3119" class="Pragma">PlutusCore.Program</a> <a id="3138" class="Pragma">NamedTyDeBruijn</a> <a id="3154" class="Pragma">NamedDeBruijn</a> <a id="3168" class="Pragma">DefaultUni</a> <a id="3179" class="Pragma">DefaultFun</a> <a id="3190" class="Pragma">()</a> <a id="3193" class="Symbol">#-}</a>
<a id="3197" class="Symbol">{-#</a> <a id="3201" class="Keyword">COMPILE</a> <a id="3209" class="Keyword">GHC</a> <a id="3213" href="Evaluator.Program.html#2295" class="Postulate">convP</a> <a id="3219" class="Pragma">=</a> <a id="3221" class="Pragma">convP</a> <a id="3227" class="Symbol">#-}</a>
<a id="3231" class="Symbol">{-#</a> <a id="3235" class="Keyword">COMPILE</a> <a id="3243" class="Keyword">GHC</a> <a id="3247" href="Evaluator.Program.html#2321" class="Postulate">deBruijnify</a> <a id="3259" class="Pragma">=</a> <a id="3261" class="Pragma">\</a> <a id="3263" class="Pragma">(Program</a> <a id="3272" class="Pragma">ann</a> <a id="3276" class="Pragma">ver</a> <a id="3280" class="Pragma">tm)</a> <a id="3284" class="Pragma">-&gt;</a> <a id="3287" class="Pragma">second</a> <a id="3294" class="Pragma">(void</a> <a id="3300" class="Pragma">.</a> <a id="3302" class="Pragma">Program</a> <a id="3310" class="Pragma">ann</a> <a id="3314" class="Pragma">ver)</a> <a id="3319" class="Pragma">.</a> <a id="3321" class="Pragma">runExcept</a> <a id="3331" class="Pragma">$</a> <a id="3333" class="Pragma">deBruijnTerm</a> <a id="3346" class="Pragma">tm</a> <a id="3349" class="Symbol">#-}</a>

<a id="3354" class="Symbol">{-#</a> <a id="3358" class="Keyword">COMPILE</a> <a id="3366" class="Keyword">GHC</a> <a id="3370" href="Evaluator.Program.html#2382" class="Postulate">ProgramNU</a> <a id="3380" class="Pragma">=</a> <a id="3382" class="Pragma">type</a> <a id="3387" class="Pragma">U.Program</a> <a id="3397" class="Pragma">Name</a> <a id="3402" class="Pragma">DefaultUni</a> <a id="3413" class="Pragma">DefaultFun</a> <a id="3424" class="Pragma">PlutusCore.SrcSpan</a> <a id="3443" class="Symbol">#-}</a>
<a id="3447" class="Symbol">{-#</a> <a id="3451" class="Keyword">COMPILE</a> <a id="3459" class="Keyword">GHC</a> <a id="3463" href="Evaluator.Program.html#2400" class="Postulate">ProgramU</a> <a id="3472" class="Pragma">=</a> <a id="3474" class="Pragma">type</a> <a id="3479" class="Pragma">U.Program</a> <a id="3489" class="Pragma">NamedDeBruijn</a> <a id="3503" class="Pragma">DefaultUni</a> <a id="3514" class="Pragma">DefaultFun</a> <a id="3525" class="Pragma">()</a> <a id="3528" class="Symbol">#-}</a>
<a id="3532" class="Symbol">{-#</a> <a id="3536" class="Keyword">COMPILE</a> <a id="3544" class="Keyword">GHC</a> <a id="3548" href="Evaluator.Program.html#2417" class="Postulate">deBruijnifyU</a> <a id="3561" class="Pragma">=</a> <a id="3563" class="Pragma">\</a> <a id="3565" class="Pragma">(U.Program</a> <a id="3576" class="Pragma">ann</a> <a id="3580" class="Pragma">ver</a> <a id="3584" class="Pragma">tm)</a> <a id="3588" class="Pragma">-&gt;</a> <a id="3591" class="Pragma">second</a> <a id="3598" class="Pragma">(void</a> <a id="3604" class="Pragma">.</a> <a id="3606" class="Pragma">U.Program</a> <a id="3616" class="Pragma">ann</a> <a id="3620" class="Pragma">ver)</a> <a id="3625" class="Pragma">.</a> <a id="3627" class="Pragma">runExcept</a> <a id="3637" class="Pragma">$</a> <a id="3639" class="Pragma">U.deBruijnTerm</a> <a id="3654" class="Pragma">tm</a> <a id="3657" class="Symbol">#-}</a>
<a id="3661" class="Symbol">{-#</a> <a id="3665" class="Keyword">COMPILE</a> <a id="3673" class="Keyword">GHC</a> <a id="3677" href="Evaluator.Program.html#2480" class="Postulate">convPU</a> <a id="3684" class="Pragma">=</a> <a id="3686" class="Pragma">U.convP</a> <a id="3694" class="Symbol">#-}</a>

<a id="3699" class="Symbol">{-#</a> <a id="3703" class="Keyword">FOREIGN</a> <a id="3711" class="Pragma">GHC</a> <a id="3715" class="Pragma">import</a> <a id="3722" class="Pragma">Opts</a> <a id="3727" class="Symbol">#-}</a>
</pre>
<h2 id="evaluators">Evaluators</h2>

<pre class="Agda"><a id="3755" class="Keyword">data</a> <a id="BudgetMode"></a><a id="3760" href="Evaluator.Program.html#3760" class="Datatype">BudgetMode</a> <a id="3771" class="Symbol">(</a><a id="3772" href="Evaluator.Program.html#3772" class="Bound">A</a> <a id="3774" class="Symbol">:</a> <a id="3776" href="Agda.Primitive.html#388" class="Primitive">Set</a><a id="3779" class="Symbol">)</a> <a id="3781" class="Symbol">:</a> <a id="3783" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3787" class="Keyword">where</a> 
  <a id="BudgetMode.Silent"></a><a id="3796" href="Evaluator.Program.html#3796" class="InductiveConstructor">Silent</a>   <a id="3805" class="Symbol">:</a> <a id="3807" href="Evaluator.Program.html#3760" class="Datatype">BudgetMode</a> <a id="3818" href="Evaluator.Program.html#3772" class="Bound">A</a>
  <a id="BudgetMode.Counting"></a><a id="3822" href="Evaluator.Program.html#3822" class="InductiveConstructor">Counting</a> <a id="3831" class="Symbol">:</a> <a id="3833" href="Evaluator.Program.html#3772" class="Bound">A</a> <a id="3835" class="Symbol">→</a> <a id="3837" href="Evaluator.Program.html#3760" class="Datatype">BudgetMode</a> <a id="3848" href="Evaluator.Program.html#3772" class="Bound">A</a>
  <a id="BudgetMode.Tallying"></a><a id="3852" href="Evaluator.Program.html#3852" class="InductiveConstructor">Tallying</a> <a id="3861" class="Symbol">:</a> <a id="3863" href="Evaluator.Program.html#3772" class="Bound">A</a> <a id="3865" class="Symbol">→</a> <a id="3867" href="Evaluator.Program.html#3760" class="Datatype">BudgetMode</a> <a id="3878" href="Evaluator.Program.html#3772" class="Bound">A</a>

<a id="3881" class="Symbol">{-#</a> <a id="3885" class="Keyword">COMPILE</a> <a id="3893" class="Keyword">GHC</a> <a id="3897" href="Evaluator.Program.html#3760" class="Datatype">BudgetMode</a> <a id="3908" class="Pragma">=</a> <a id="3910" class="Pragma">data</a> <a id="3915" class="Pragma">BudgetMode</a> <a id="3926" class="Pragma">(Silent</a> <a id="3934" class="Pragma">|</a> <a id="3936" class="Pragma">Counting</a> <a id="3945" class="Pragma">|</a> <a id="3947" class="Pragma">Tallying)</a> <a id="3957" class="Symbol">#-}</a>

<a id="3962" class="Keyword">data</a> <a id="EvalMode"></a><a id="3967" href="Evaluator.Program.html#3967" class="Datatype">EvalMode</a> <a id="3976" class="Symbol">:</a> <a id="3978" href="Agda.Primitive.html#388" class="Primitive">Set</a> <a id="3982" class="Keyword">where</a>
  <a id="EvalMode.U"></a><a id="3990" href="Evaluator.Program.html#3990" class="InductiveConstructor">U</a> <a id="EvalMode.TL"></a><a id="3992" href="Evaluator.Program.html#3992" class="InductiveConstructor">TL</a> <a id="EvalMode.TCK"></a><a id="3995" href="Evaluator.Program.html#3995" class="InductiveConstructor">TCK</a> <a id="EvalMode.TCEK"></a><a id="3999" href="Evaluator.Program.html#3999" class="InductiveConstructor">TCEK</a> <a id="4004" class="Symbol">:</a> <a id="4006" href="Evaluator.Program.html#3967" class="Datatype">EvalMode</a>

<a id="4016" class="Symbol">{-#</a> <a id="4020" class="Keyword">COMPILE</a> <a id="4028" class="Keyword">GHC</a> <a id="4032" href="Evaluator.Program.html#3967" class="Datatype">EvalMode</a> <a id="4041" class="Pragma">=</a> <a id="4043" class="Pragma">data</a> <a id="4048" class="Pragma">EvalMode</a> <a id="4057" class="Pragma">(U</a> <a id="4060" class="Pragma">|</a> <a id="4062" class="Pragma">TL</a> <a id="4065" class="Pragma">|</a> <a id="4067" class="Pragma">TCK</a> <a id="4071" class="Pragma">|</a> <a id="4073" class="Pragma">TCEK)</a> <a id="4079" class="Symbol">#-}</a>

<a id="parsePLC"></a><a id="4084" href="Evaluator.Program.html#4084" class="Function">parsePLC</a> <a id="4093" class="Symbol">:</a> <a id="4095" href="Evaluator.Program.html#2262" class="Postulate">ProgramN</a> <a id="4104" class="Symbol">→</a> <a id="4106" href="Utils.html#1126" class="Datatype">Either</a> <a id="4113" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="4119" class="Symbol">(</a><a id="4120" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="4129" href="Scoped.html#1441" class="InductiveConstructor">Z</a><a id="4130" class="Symbol">)</a>
<a id="4132" href="Evaluator.Program.html#4084" class="Function">parsePLC</a> <a id="4141" href="Evaluator.Program.html#4141" class="Bound">namedprog</a> <a id="4151" class="Symbol">=</a> <a id="4153" class="Keyword">do</a>
  <a id="4158" href="Evaluator.Program.html#4158" class="Bound">prog</a> <a id="4163" href="Utils.html#2941" class="Field Operator">←</a> <a id="4165" href="Utils.html#3700" class="Function">withE</a> <a id="4171" class="Symbol">(</a><a id="4172" href="Evaluator.Base.html#1325" class="InductiveConstructor">ERROR.scopeError</a> <a id="4189" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4191" href="Scoped.html#7875" class="InductiveConstructor">freeVariableError</a><a id="4208" class="Symbol">)</a> <a id="4210" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4212" href="Evaluator.Program.html#2321" class="Postulate">deBruijnify</a> <a id="4224" href="Evaluator.Program.html#4141" class="Bound">namedprog</a>
  <a id="4236" href="Utils.html#3700" class="Function">withE</a> <a id="4242" href="Evaluator.Base.html#1325" class="InductiveConstructor">scopeError</a> <a id="4253" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4255" href="Scoped.html#9734" class="Function">scopeCheckTm</a> <a id="4268" class="Symbol">{</a><a id="4269" class="Number">0</a><a id="4270" class="Symbol">}{</a><a id="4272" href="Scoped.html#1441" class="InductiveConstructor">Z</a><a id="4273" class="Symbol">}</a> <a id="4275" class="Symbol">(</a><a id="4276" href="Scoped.html#4361" class="Function">shifter</a> <a id="4284" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="4286" class="Symbol">(</a><a id="4287" href="Evaluator.Program.html#2295" class="Postulate">convP</a> <a id="4293" href="Evaluator.Program.html#4158" class="Bound">prog</a><a id="4297" class="Symbol">))</a>
  <a id="4302" class="Comment">-- ^ FIXME: this should have an interface that guarantees that the</a>
  <a id="4371" class="Comment">-- shifter is run</a>

<a id="parseUPLC"></a><a id="4390" href="Evaluator.Program.html#4390" class="Function">parseUPLC</a> <a id="4400" class="Symbol">:</a> <a id="4402" href="Evaluator.Program.html#2382" class="Postulate">ProgramNU</a> <a id="4412" class="Symbol">→</a> <a id="4414" href="Utils.html#1126" class="Datatype">Either</a> <a id="4421" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="4427" class="Symbol">(</a><a id="4428" href="Data.Empty.html#535" class="Datatype">⊥</a> <a id="4430" href="Untyped.html#1295" class="Datatype Operator">U.⊢</a><a id="4433" class="Symbol">)</a>
<a id="4435" href="Evaluator.Program.html#4390" class="Function">parseUPLC</a> <a id="4445" href="Evaluator.Program.html#4445" class="Bound">namedprog</a> <a id="4455" class="Symbol">=</a> <a id="4457" class="Keyword">do</a>
  <a id="4462" href="Evaluator.Program.html#4462" class="Bound">prog</a> <a id="4467" href="Utils.html#2941" class="Field Operator">←</a> <a id="4469" href="Utils.html#3700" class="Function">withE</a> <a id="4475" class="Symbol">(</a><a id="4476" href="Evaluator.Base.html#1325" class="InductiveConstructor">ERROR.scopeError</a> <a id="4493" href="Function.Base.html#1040" class="Function Operator">∘</a> <a id="4495" href="Scoped.html#7875" class="InductiveConstructor">freeVariableError</a><a id="4512" class="Symbol">)</a> <a id="4514" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4516" href="Evaluator.Program.html#2417" class="Postulate">deBruijnifyU</a> <a id="4529" href="Evaluator.Program.html#4445" class="Bound">namedprog</a>
  <a id="4541" href="Utils.html#3700" class="Function">withE</a> <a id="4547" href="Evaluator.Base.html#1325" class="InductiveConstructor">scopeError</a> <a id="4558" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="4560" href="Untyped.html#5840" class="Function">U.scopeCheckU0</a> <a id="4575" class="Symbol">(</a><a id="4576" href="Evaluator.Program.html#2480" class="Postulate">convPU</a> <a id="4583" href="Evaluator.Program.html#4462" class="Bound">prog</a><a id="4587" class="Symbol">)</a>

<a id="typeCheckPLC"></a><a id="4590" href="Evaluator.Program.html#4590" class="Function">typeCheckPLC</a> <a id="4603" class="Symbol">:</a> <a id="4605" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="4614" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="4616" class="Symbol">→</a> <a id="4618" href="Utils.html#1126" class="Datatype">Either</a> <a id="4625" href="Check.html#2133" class="Datatype">TypeError</a> <a id="4635" class="Symbol">(</a><a id="4636" href="Agda.Builtin.Sigma.html#165" class="Record">Σ</a> <a id="4638" class="Symbol">(</a><a id="4639" class="InductiveConstructor">∅</a> <a id="4641" href="Type.BetaNormal.html#1046" class="Datatype Operator">⊢Nf⋆</a> <a id="4646" href="Utils.html#6821" class="InductiveConstructor">*</a><a id="4647" class="Symbol">)</a> <a id="4649" class="Symbol">(</a><a id="4650" class="InductiveConstructor">∅</a> <a id="4652" href="Algorithmic.html#5298" class="Datatype Operator">⊢_</a><a id="4654" class="Symbol">))</a>
<a id="4657" href="Evaluator.Program.html#4590" class="Function">typeCheckPLC</a> <a id="4670" href="Evaluator.Program.html#4670" class="Bound">t</a> <a id="4672" class="Symbol">=</a> <a id="4674" href="Check.html#17852" class="Function">inferType</a> <a id="4684" class="Symbol">_</a> <a id="4686" href="Evaluator.Program.html#4670" class="Bound">t</a>
</pre>
<p>Check if the term is an error term, and in that case return an ERROR.</p>

<p>This is used when evaluation of the reduction semantics has ended</p>

<pre class="Agda"><a id="checkError"></a><a id="4835" href="Evaluator.Program.html#4835" class="Function">checkError</a> <a id="4846" class="Symbol">:</a> <a id="4848" class="Symbol">∀{</a><a id="4850" href="Evaluator.Program.html#4850" class="Bound">A</a><a id="4851" class="Symbol">}</a> <a id="4853" class="Symbol">→</a> <a id="4855" class="InductiveConstructor">∅</a> <a id="4857" href="Algorithmic.html#5298" class="Datatype Operator">⊢</a> <a id="4859" href="Evaluator.Program.html#4850" class="Bound">A</a> <a id="4861" class="Symbol">→</a> <a id="4863" href="Utils.html#1126" class="Datatype">Either</a> <a id="4870" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="4876" class="Symbol">(</a><a id="4877" class="InductiveConstructor">∅</a> <a id="4879" href="Algorithmic.html#5298" class="Datatype Operator">⊢</a> <a id="4881" href="Evaluator.Program.html#4850" class="Bound">A</a> <a id="4883" class="Symbol">)</a>
<a id="4885" href="Evaluator.Program.html#4835" class="Function">checkError</a> <a id="4896" class="Symbol">(</a><a id="4897" href="Algorithmic.html#7652" class="InductiveConstructor">error</a> <a id="4903" class="Symbol">_)</a> <a id="4906" class="Symbol">=</a> <a id="4908" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="4913" class="Symbol">(</a><a id="4914" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="4927" href="Utils.html#4415" class="InductiveConstructor">userError</a><a id="4936" class="Symbol">)</a>
<a id="4938" href="Evaluator.Program.html#4835" class="CatchallClause Function">checkError</a><a id="4948" class="CatchallClause"> </a><a id="4949" href="Evaluator.Program.html#4949" class="CatchallClause Bound">t</a>         <a id="4959" class="Symbol">=</a> <a id="4961" href="Utils.html#2913" class="Field">return</a> <a id="4968" href="Evaluator.Program.html#4949" class="Bound">t</a>

<a id="executePLC"></a><a id="4971" href="Evaluator.Program.html#4971" class="Function">executePLC</a> <a id="4982" class="Symbol">:</a> <a id="4984" href="Evaluator.Program.html#3967" class="Datatype">EvalMode</a> <a id="4993" class="Symbol">→</a> <a id="4995" href="Scoped.html#6898" class="Datatype">ScopedTm</a> <a id="5004" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="5006" class="Symbol">→</a> <a id="5008" href="Utils.html#1126" class="Datatype">Either</a> <a id="5015" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="5021" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="5028" href="Evaluator.Program.html#4971" class="Function">executePLC</a> <a id="5039" href="Evaluator.Program.html#3990" class="InductiveConstructor">U</a> <a id="5041" href="Evaluator.Program.html#5041" class="Bound">t</a> <a id="5043" class="Symbol">=</a> <a id="5045" class="Keyword">do</a>
  <a id="5050" class="Symbol">(</a><a id="5051" href="Evaluator.Program.html#5051" class="Bound">A</a> <a id="5053" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="5056" href="Evaluator.Program.html#5056" class="Bound">t</a><a id="5057" class="Symbol">)</a> <a id="5059" href="Utils.html#2941" class="Field Operator">←</a> <a id="5061" href="Utils.html#3700" class="Function">withE</a> <a id="5067" class="Symbol">(λ</a> <a id="5070" href="Evaluator.Program.html#5070" class="Bound">e</a> <a id="5072" class="Symbol">→</a> <a id="5074" href="Evaluator.Base.html#1262" class="InductiveConstructor">typeError</a> <a id="5084" class="Symbol">(</a><a id="5085" href="Evaluator.Base.html#1463" class="Function">uglyTypeError</a> <a id="5099" href="Evaluator.Program.html#5070" class="Bound">e</a><a id="5100" class="Symbol">))</a> <a id="5103" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5105" href="Evaluator.Program.html#4590" class="Function">typeCheckPLC</a> <a id="5118" href="Evaluator.Program.html#5041" class="Bound">t</a>
  <a id="5122" href="Untyped.CEK.html#3654" class="InductiveConstructor">□</a> <a id="5124" href="Evaluator.Program.html#5124" class="Bound">V</a> <a id="5126" href="Utils.html#2941" class="Field Operator">←</a> <a id="5128" href="Utils.html#3700" class="Function">withE</a> <a id="5134" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="5147" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5149" href="Untyped.CEK.html#23095" class="Function">U.stepper</a> <a id="5159" href="Evaluator.Base.html#3063" class="Function">maxsteps</a> <a id="5168" class="Symbol">(</a><a id="5169" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a> <a id="5171" href="Untyped.CEK.html#3560" class="InductiveConstructor Operator">;</a> <a id="5173" href="Untyped.CEK.html#1305" class="InductiveConstructor">[]</a> <a id="5176" href="Untyped.CEK.html#3560" class="InductiveConstructor Operator">▻</a> <a id="5178" href="Algorithmic.Erasure.html#2236" class="Function">erase</a> <a id="5184" href="Evaluator.Program.html#5056" class="Bound">t</a><a id="5185" class="Symbol">)</a>
    <a id="5191" class="Keyword">where</a> <a id="5197" href="Untyped.CEK.html#3674" class="InductiveConstructor">◆</a>  <a id="5200" class="Symbol">→</a> <a id="5202" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="5207" class="Symbol">(</a><a id="5208" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="5221" href="Utils.html#4415" class="InductiveConstructor">userError</a><a id="5230" class="Symbol">)</a>
          <a id="5242" class="CatchallClause Symbol">_</a>  <a id="5245" class="Symbol">→</a> <a id="5247" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="5252" class="Symbol">(</a><a id="5253" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="5266" href="Utils.html#4389" class="InductiveConstructor">gasError</a><a id="5274" class="Symbol">)</a>
<a id="5276" class="Comment">{-
just t&#39; ← withE runtimeError $ U.stepper maxsteps (ε ; [] ▻ erase t)
    where nothing → inj₁ (runtimeError userError)
    -}</a>
  <a id="5407" href="Utils.html#2913" class="Field">return</a> <a id="5414" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5416" href="Evaluator.Base.html#802" class="Postulate">prettyPrintUTm</a> <a id="5431" class="Symbol">(</a><a id="5432" href="Untyped.html#4512" class="Function">U.extricateU0</a> <a id="5446" class="Symbol">(</a><a id="5447" href="Untyped.CEK.html#2447" class="Function">U.discharge</a> <a id="5459" href="Evaluator.Program.html#5124" class="Bound">V</a><a id="5460" class="Symbol">))</a>
<a id="5463" href="Evaluator.Program.html#4971" class="Function">executePLC</a> <a id="5474" href="Evaluator.Program.html#3992" class="InductiveConstructor">TL</a> <a id="5477" href="Evaluator.Program.html#5477" class="Bound">t</a> <a id="5479" class="Symbol">=</a> <a id="5481" class="Keyword">do</a>
  <a id="5486" class="Symbol">(</a><a id="5487" href="Evaluator.Program.html#5487" class="Bound">A</a> <a id="5489" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="5492" href="Evaluator.Program.html#5492" class="Bound">t</a><a id="5493" class="Symbol">)</a> <a id="5495" href="Utils.html#2941" class="Field Operator">←</a> <a id="5497" href="Utils.html#3700" class="Function">withE</a> <a id="5503" class="Symbol">(λ</a> <a id="5506" href="Evaluator.Program.html#5506" class="Bound">e</a> <a id="5508" class="Symbol">→</a> <a id="5510" href="Evaluator.Base.html#1262" class="InductiveConstructor">typeError</a> <a id="5520" class="Symbol">(</a><a id="5521" href="Evaluator.Base.html#1463" class="Function">uglyTypeError</a> <a id="5535" href="Evaluator.Program.html#5506" class="Bound">e</a><a id="5536" class="Symbol">))</a> <a id="5539" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5541" href="Evaluator.Program.html#4590" class="Function">typeCheckPLC</a> <a id="5554" href="Evaluator.Program.html#5477" class="Bound">t</a>
  <a id="5558" href="Evaluator.Program.html#5558" class="Bound">t&#39;</a> <a id="5561" href="Utils.html#2941" class="Field Operator">←</a> <a id="5563" class="Symbol">(</a><a id="5564" href="Utils.html#3700" class="Function">withE</a> <a id="5570" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="5583" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5585" href="Algorithmic.Evaluation.html#2114" class="Function">L.stepper</a> <a id="5595" href="Evaluator.Program.html#5492" class="Bound">t</a> <a id="5597" href="Evaluator.Base.html#3063" class="Function">maxsteps</a><a id="5605" class="Symbol">)</a> <a id="5607" href="Utils.html#2941" class="Field Operator">&gt;&gt;=</a> <a id="5611" href="Evaluator.Program.html#4835" class="Function">checkError</a>
  <a id="5624" href="Utils.html#2913" class="Field">return</a> <a id="5631" class="Symbol">(</a><a id="5632" href="Evaluator.Base.html#735" class="Postulate">prettyPrintTm</a> <a id="5646" class="Symbol">(</a><a id="5647" href="Scoped.html#6020" class="Function">unshifter</a> <a id="5657" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="5659" class="Symbol">(</a><a id="5660" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="5675" class="Symbol">(</a><a id="5676" href="Scoped.Extrication.html#3032" class="Function">extricate</a> <a id="5686" href="Evaluator.Program.html#5558" class="Bound">t&#39;</a><a id="5688" class="Symbol">))))</a>
<a id="5693" href="Evaluator.Program.html#4971" class="Function">executePLC</a> <a id="5704" href="Evaluator.Program.html#3995" class="InductiveConstructor">TCK</a> <a id="5708" href="Evaluator.Program.html#5708" class="Bound">t</a> <a id="5710" class="Symbol">=</a> <a id="5712" class="Keyword">do</a>
  <a id="5717" class="Symbol">(</a><a id="5718" href="Evaluator.Program.html#5718" class="Bound">A</a> <a id="5720" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="5723" href="Evaluator.Program.html#5723" class="Bound">t</a><a id="5724" class="Symbol">)</a> <a id="5726" href="Utils.html#2941" class="Field Operator">←</a> <a id="5728" href="Utils.html#3700" class="Function">withE</a> <a id="5734" class="Symbol">(λ</a> <a id="5737" href="Evaluator.Program.html#5737" class="Bound">e</a> <a id="5739" class="Symbol">→</a> <a id="5741" href="Evaluator.Base.html#1262" class="InductiveConstructor">typeError</a> <a id="5751" class="Symbol">(</a><a id="5752" href="Evaluator.Base.html#1463" class="Function">uglyTypeError</a> <a id="5766" href="Evaluator.Program.html#5737" class="Bound">e</a><a id="5767" class="Symbol">))</a> <a id="5770" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5772" href="Evaluator.Program.html#4590" class="Function">typeCheckPLC</a> <a id="5785" href="Evaluator.Program.html#5708" class="Bound">t</a>
  <a id="5789" href="Algorithmic.CK.html#1471" class="InductiveConstructor">□</a> <a id="5791" class="Symbol">{</a><a id="5792" class="Argument">t</a> <a id="5794" class="Symbol">=</a> <a id="5796" href="Evaluator.Program.html#5796" class="Bound">t</a><a id="5797" class="Symbol">}</a> <a id="5799" href="Evaluator.Program.html#5799" class="Bound">v</a> <a id="5801" href="Utils.html#2941" class="Field Operator">←</a> <a id="5803" href="Utils.html#3700" class="Function">withE</a> <a id="5809" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="5822" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="5824" href="Algorithmic.CK.html#4621" class="Function">Algorithmic.CK.stepper</a> <a id="5847" href="Evaluator.Base.html#3063" class="Function">maxsteps</a> <a id="5856" class="Symbol">(</a><a id="5857" href="Algorithmic.CK.html#1178" class="InductiveConstructor">ε</a> <a id="5859" href="Algorithmic.CK.html#1349" class="InductiveConstructor Operator">▻</a> <a id="5861" href="Evaluator.Program.html#5723" class="Bound">t</a><a id="5862" class="Symbol">)</a>
    <a id="5868" class="Keyword">where</a> <a id="5874" href="Algorithmic.CK.html#1511" class="InductiveConstructor">◆</a> <a id="5876" class="Symbol">_</a>  <a id="5879" class="Symbol">→</a> <a id="5881" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="5886" class="Symbol">(</a><a id="5887" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="5900" href="Utils.html#4415" class="InductiveConstructor">userError</a><a id="5909" class="Symbol">)</a>
          <a id="5921" class="CatchallClause Symbol">_</a>    <a id="5926" class="Symbol">→</a> <a id="5928" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="5933" class="Symbol">(</a><a id="5934" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="5947" href="Utils.html#4389" class="InductiveConstructor">gasError</a><a id="5955" class="Symbol">)</a>
  <a id="5959" href="Utils.html#2913" class="Field">return</a> <a id="5966" class="Symbol">(</a><a id="5967" href="Evaluator.Base.html#735" class="Postulate">prettyPrintTm</a> <a id="5981" class="Symbol">(</a><a id="5982" href="Scoped.html#6020" class="Function">unshifter</a> <a id="5992" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="5994" class="Symbol">(</a><a id="5995" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="6010" class="Symbol">(</a><a id="6011" href="Scoped.Extrication.html#3032" class="Function">extricate</a> <a id="6021" href="Evaluator.Program.html#5796" class="Bound">t</a><a id="6022" class="Symbol">))))</a>
<a id="6027" href="Evaluator.Program.html#4971" class="Function">executePLC</a> <a id="6038" href="Evaluator.Program.html#3999" class="InductiveConstructor">TCEK</a> <a id="6043" href="Evaluator.Program.html#6043" class="Bound">t</a> <a id="6045" class="Symbol">=</a> <a id="6047" class="Keyword">do</a>
  <a id="6052" class="Symbol">(</a><a id="6053" href="Evaluator.Program.html#6053" class="Bound">A</a> <a id="6055" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="6058" href="Evaluator.Program.html#6058" class="Bound">t</a><a id="6059" class="Symbol">)</a> <a id="6061" href="Utils.html#2941" class="Field Operator">←</a> <a id="6063" href="Utils.html#3700" class="Function">withE</a> <a id="6069" class="Symbol">(λ</a> <a id="6072" href="Evaluator.Program.html#6072" class="Bound">e</a> <a id="6074" class="Symbol">→</a> <a id="6076" href="Evaluator.Base.html#1262" class="InductiveConstructor">typeError</a> <a id="6086" class="Symbol">(</a><a id="6087" href="Evaluator.Base.html#1463" class="Function">uglyTypeError</a> <a id="6101" href="Evaluator.Program.html#6072" class="Bound">e</a><a id="6102" class="Symbol">))</a> <a id="6105" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="6107" href="Evaluator.Program.html#4590" class="Function">typeCheckPLC</a> <a id="6120" href="Evaluator.Program.html#6043" class="Bound">t</a>
  <a id="6124" href="Algorithmic.CEK.html#17488" class="InductiveConstructor">□</a> <a id="6126" href="Evaluator.Program.html#6126" class="Bound">V</a> <a id="6128" href="Utils.html#2941" class="Field Operator">←</a> <a id="6130" href="Utils.html#3700" class="Function">withE</a> <a id="6136" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="6149" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="6151" href="Algorithmic.CEK.html#19732" class="Function">Algorithmic.CEK.stepper</a> <a id="6175" href="Evaluator.Base.html#3063" class="Function">maxsteps</a> <a id="6184" class="Symbol">(</a><a id="6185" href="Algorithmic.CEK.html#17252" class="InductiveConstructor">ε</a> <a id="6187" href="Algorithmic.CEK.html#17366" class="InductiveConstructor Operator">;</a> <a id="6189" href="Algorithmic.CEK.html#3849" class="InductiveConstructor">[]</a> <a id="6192" href="Algorithmic.CEK.html#17366" class="InductiveConstructor Operator">▻</a> <a id="6194" href="Evaluator.Program.html#6058" class="Bound">t</a><a id="6195" class="Symbol">)</a>
    <a id="6201" class="Keyword">where</a> <a id="6207" href="Algorithmic.CEK.html#17516" class="InductiveConstructor">◆</a> <a id="6209" class="Symbol">_</a>  <a id="6212" class="Symbol">→</a> <a id="6214" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="6219" class="Symbol">(</a><a id="6220" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="6233" href="Utils.html#4415" class="InductiveConstructor">userError</a><a id="6242" class="Symbol">)</a>
          <a id="6254" class="CatchallClause Symbol">_</a>    <a id="6259" class="Symbol">→</a> <a id="6261" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="6266" class="Symbol">(</a><a id="6267" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="6280" href="Utils.html#4389" class="InductiveConstructor">gasError</a><a id="6288" class="Symbol">)</a>
  <a id="6292" href="Utils.html#2913" class="Field">return</a> <a id="6299" class="Symbol">(</a><a id="6300" href="Evaluator.Base.html#735" class="Postulate">prettyPrintTm</a> <a id="6314" class="Symbol">(</a><a id="6315" href="Scoped.html#6020" class="Function">unshifter</a> <a id="6325" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="6327" class="Symbol">(</a><a id="6328" href="Scoped.html#11954" class="Function">extricateScope</a> <a id="6343" class="Symbol">(</a><a id="6344" href="Scoped.Extrication.html#3032" class="Function">extricate</a> <a id="6354" class="Symbol">(</a><a id="6355" href="Algorithmic.CEK.html#4052" class="Function">Algorithmic.CEK.discharge</a> <a id="6381" href="Evaluator.Program.html#6126" class="Bound">V</a><a id="6382" class="Symbol">)))))</a>

<a id="showUPLCResult"></a><a id="6389" href="Evaluator.Program.html#6389" class="Function">showUPLCResult</a> <a id="6404" class="Symbol">:</a> <a id="6406" href="Untyped.CEK.html#3540" class="Datatype">U.State</a> <a id="6414" class="Symbol">→</a> <a id="6416" href="Utils.html#1126" class="Datatype">Either</a> <a id="6423" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="6429" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="6436" href="Evaluator.Program.html#6389" class="Function">showUPLCResult</a> <a id="6451" class="Symbol">(</a><a id="6452" href="Untyped.CEK.html#3654" class="InductiveConstructor">□</a> <a id="6454" href="Evaluator.Program.html#6454" class="Bound">V</a><a id="6455" class="Symbol">)</a> <a id="6457" class="Symbol">=</a> <a id="6459" href="Utils.html#2913" class="Field">return</a> <a id="6466" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="6468" href="Evaluator.Base.html#802" class="Postulate">prettyPrintUTm</a> <a id="6483" class="Symbol">(</a><a id="6484" href="Untyped.html#4512" class="Function">U.extricateU0</a> <a id="6498" class="Symbol">(</a><a id="6499" href="Untyped.CEK.html#2447" class="Function">U.discharge</a> <a id="6511" href="Evaluator.Program.html#6454" class="Bound">V</a><a id="6512" class="Symbol">))</a>
<a id="6515" href="Evaluator.Program.html#6389" class="Function">showUPLCResult</a> <a id="6530" href="Untyped.CEK.html#3674" class="InductiveConstructor">◆</a>     <a id="6536" class="Symbol">=</a> <a id="6538" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="6543" class="Symbol">(</a><a id="6544" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="6557" href="Utils.html#4415" class="InductiveConstructor">userError</a><a id="6566" class="Symbol">)</a>
<a id="6568" href="Evaluator.Program.html#6389" class="CatchallClause Function">showUPLCResult</a><a id="6582" class="CatchallClause"> </a><a id="6583" class="CatchallClause Symbol">_</a>     <a id="6589" class="Symbol">=</a> <a id="6591" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="6596" class="Symbol">(</a><a id="6597" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="6610" href="Utils.html#4389" class="InductiveConstructor">gasError</a><a id="6618" class="Symbol">)</a>

<a id="executeUPLCwithMP"></a><a id="6621" href="Evaluator.Program.html#6621" class="Function">executeUPLCwithMP</a> <a id="6639" class="Symbol">:</a> <a id="6641" class="Symbol">∀{</a><a id="6643" href="Evaluator.Program.html#6643" class="Bound">A</a><a id="6644" class="Symbol">}</a> <a id="6646" class="Symbol">→</a> <a id="6648" href="Cost.Raw.html#5784" class="Function">RawCostModel</a> <a id="6661" class="Symbol">→</a> <a id="6663" class="Symbol">(</a><a id="6664" href="Cost.html#3611" class="Function">CostModel</a> <a id="6674" class="Symbol">→</a> <a id="6676" href="Cost.Base.html#2070" class="Record">MachineParameters</a> <a id="6694" href="Evaluator.Program.html#6643" class="Bound">A</a><a id="6695" class="Symbol">)</a> <a id="6697" class="Symbol">→</a> <a id="6699" class="Symbol">(</a><a id="6700" href="Evaluator.Program.html#6643" class="Bound">A</a> <a id="6702" class="Symbol">→</a> <a id="6704" href="Agda.Builtin.String.html#335" class="Postulate">String</a><a id="6710" class="Symbol">)</a> <a id="6712" class="Symbol">→</a> <a id="6714" href="Data.Empty.html#535" class="Datatype">⊥</a> <a id="6716" href="Untyped.html#1295" class="Datatype Operator">U.⊢</a> <a id="6720" class="Symbol">→</a> <a id="6722" href="Utils.html#1126" class="Datatype">Either</a> <a id="6729" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="6735" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="6742" href="Evaluator.Program.html#6621" class="Function">executeUPLCwithMP</a> <a id="6760" class="Symbol">(</a><a id="6761" href="Evaluator.Program.html#6761" class="Bound">cekMachineCosts</a> <a id="6777" href="Utils.html#4786" class="InductiveConstructor Operator">,</a> <a id="6779" href="Evaluator.Program.html#6779" class="Bound">rawmodel</a><a id="6787" class="Symbol">)</a> <a id="6789" href="Evaluator.Program.html#6789" class="Bound">mkMP</a> <a id="6794" href="Evaluator.Program.html#6794" class="Bound">report</a> <a id="6801" href="Evaluator.Program.html#6801" class="Bound">t</a> <a id="6803" class="Keyword">with</a> <a id="6808" href="Cost.Model.html#9634" class="Function">createMap</a> <a id="6818" href="Evaluator.Program.html#6779" class="Bound">rawmodel</a> 
<a id="6828" class="Symbol">...</a> <a id="6832" class="Symbol">|</a> <a id="6834" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="6839" href="Evaluator.Program.html#6839" class="Bound">model</a> <a id="6845" class="Symbol">=</a> <a id="6847" class="Keyword">do</a> 
    <a id="6855" class="Keyword">let</a> <a id="6859" href="Evaluator.Program.html#6859" class="Bound">machineparam</a> <a id="6872" class="Symbol">=</a> <a id="6874" class="Bound">mkMP</a> <a id="6879" class="Symbol">(</a><a id="6880" class="Bound">cekMachineCosts</a> <a id="6896" href="Utils.html#4786" class="InductiveConstructor Operator">,</a> <a id="6898" href="Evaluator.Program.html#6839" class="Bound">model</a><a id="6903" class="Symbol">)</a>
    <a id="6909" class="Keyword">let</a> <a id="6913" class="Symbol">(</a><a id="6914" href="Evaluator.Program.html#6914" class="Bound">ev</a> <a id="6917" href="Utils.html#4005" class="InductiveConstructor Operator">,</a> <a id="6919" href="Evaluator.Program.html#6919" class="Bound">exBudget</a><a id="6927" class="Symbol">)</a> <a id="6929" class="Symbol">=</a> <a id="6931" href="Untyped.CEKWithCost.html#6629" class="Function">U.stepperC</a> <a id="6942" href="Evaluator.Program.html#6859" class="Bound">machineparam</a> <a id="6955" href="Evaluator.Base.html#3063" class="Function">maxsteps</a> <a id="6964" class="Symbol">(</a><a id="6965" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a> <a id="6967" href="Untyped.CEK.html#3560" class="InductiveConstructor Operator">;</a> <a id="6969" href="Untyped.CEK.html#1305" class="InductiveConstructor">[]</a> <a id="6972" href="Untyped.CEK.html#3560" class="InductiveConstructor Operator">▻</a> <a id="6974" class="Bound">t</a><a id="6975" class="Symbol">)</a>
    <a id="6981" href="Evaluator.Program.html#6981" class="Bound">x</a> <a id="6983" href="Utils.html#2941" class="Field Operator">←</a> <a id="6985" href="Utils.html#3700" class="Function">withE</a> <a id="6991" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="7004" href="Evaluator.Program.html#6914" class="Bound">ev</a>
    <a id="7011" href="Evaluator.Program.html#7011" class="Bound">r</a> <a id="7013" href="Utils.html#2941" class="Field Operator">←</a> <a id="7015" href="Evaluator.Program.html#6389" class="Function">showUPLCResult</a> <a id="7030" href="Evaluator.Program.html#6981" class="Bound">x</a>
    <a id="7036" href="Utils.html#2913" class="Field">return</a> <a id="7043" class="Symbol">(</a><a id="7044" href="Evaluator.Program.html#7011" class="Bound">r</a> <a id="7046" href="Data.String.Base.html#2375" class="Function Operator">++</a> <a id="7049" class="Bound">report</a> <a id="7056" href="Evaluator.Program.html#6919" class="Bound">exBudget</a><a id="7064" class="Symbol">)</a> 
<a id="7067" class="Symbol">...</a> <a id="7071" class="Symbol">|</a> <a id="7073" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="7081" class="Symbol">=</a> <a id="7083" href="Utils.html#1159" class="InductiveConstructor">inj₁</a> <a id="7088" class="Symbol">(</a><a id="7089" href="Evaluator.Base.html#1397" class="InductiveConstructor">jsonError</a> <a id="7099" class="String">&quot;while processing parameters.&quot;</a><a id="7129" class="Symbol">)</a>

<a id="executeUPLC"></a><a id="7132" href="Evaluator.Program.html#7132" class="Function">executeUPLC</a> <a id="7144" class="Symbol">:</a> <a id="7146" href="Evaluator.Program.html#3760" class="Datatype">BudgetMode</a> <a id="7157" href="Cost.Raw.html#5784" class="Function">RawCostModel</a> <a id="7170" class="Symbol">→</a> <a id="7172" href="Data.Empty.html#535" class="Datatype">⊥</a> <a id="7174" href="Untyped.html#1295" class="Datatype Operator">U.⊢</a> <a id="7178" class="Symbol">→</a> <a id="7180" href="Utils.html#1126" class="Datatype">Either</a> <a id="7187" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="7193" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="7200" href="Evaluator.Program.html#7132" class="Function">executeUPLC</a> <a id="7212" href="Evaluator.Program.html#3796" class="InductiveConstructor">Silent</a> <a id="7219" href="Evaluator.Program.html#7219" class="Bound">t</a> <a id="7221" class="Symbol">=</a> <a id="7223" class="Symbol">(</a><a id="7224" href="Utils.html#3700" class="Function">withE</a> <a id="7230" href="Evaluator.Base.html#1359" class="InductiveConstructor">runtimeError</a> <a id="7243" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="7245" href="Untyped.CEK.html#23095" class="Function">U.stepper</a> <a id="7255" href="Evaluator.Base.html#3063" class="Function">maxsteps</a> <a id="7264" class="Symbol">(</a><a id="7265" href="Untyped.CEK.html#1208" class="InductiveConstructor">ε</a> <a id="7267" href="Untyped.CEK.html#3560" class="InductiveConstructor Operator">;</a> <a id="7269" href="Untyped.CEK.html#1305" class="InductiveConstructor">[]</a> <a id="7272" href="Untyped.CEK.html#3560" class="InductiveConstructor Operator">▻</a> <a id="7274" href="Evaluator.Program.html#7219" class="Bound">t</a><a id="7275" class="Symbol">))</a> <a id="7278" href="Utils.html#2941" class="Field Operator">&gt;&gt;=</a> <a id="7282" href="Evaluator.Program.html#6389" class="Function">showUPLCResult</a>
<a id="7297" href="Evaluator.Program.html#7132" class="Function">executeUPLC</a> <a id="7309" class="Symbol">(</a><a id="7310" href="Evaluator.Program.html#3822" class="InductiveConstructor">Counting</a> <a id="7319" href="Evaluator.Program.html#7319" class="Bound">rcm</a><a id="7322" class="Symbol">)</a> <a id="7324" href="Evaluator.Program.html#7324" class="Bound">t</a> <a id="7326" class="Symbol">=</a> <a id="7328" href="Evaluator.Program.html#6621" class="Function">executeUPLCwithMP</a> <a id="7346" href="Evaluator.Program.html#7319" class="Bound">rcm</a> <a id="7350" href="Cost.html#4652" class="Function">machineParameters</a> <a id="7368" href="Cost.html#4867" class="Function">countingReport</a> <a id="7383" href="Evaluator.Program.html#7324" class="Bound">t</a> 
<a id="7386" href="Evaluator.Program.html#7132" class="Function">executeUPLC</a> <a id="7398" class="Symbol">(</a><a id="7399" href="Evaluator.Program.html#3852" class="InductiveConstructor">Tallying</a> <a id="7408" href="Evaluator.Program.html#7408" class="Bound">rcm</a><a id="7411" class="Symbol">)</a> <a id="7413" href="Evaluator.Program.html#7413" class="Bound">t</a> <a id="7415" class="Symbol">=</a> <a id="7417" href="Evaluator.Program.html#6621" class="Function">executeUPLCwithMP</a> <a id="7435" href="Evaluator.Program.html#7408" class="Bound">rcm</a> <a id="7439" href="Cost.html#6864" class="Function">tallyingMachineParameters</a> <a id="7465" href="Cost.html#7117" class="Function">tallyingReport</a> <a id="7480" href="Evaluator.Program.html#7413" class="Bound">t</a>

<a id="evalProgramNU"></a><a id="7483" href="Evaluator.Program.html#7483" class="Function">evalProgramNU</a> <a id="7497" class="Symbol">:</a> <a id="7499" href="Evaluator.Program.html#3760" class="Datatype">BudgetMode</a> <a id="7510" href="Cost.Raw.html#5784" class="Function">RawCostModel</a> <a id="7523" class="Symbol">→</a> <a id="7525" href="Evaluator.Program.html#2382" class="Postulate">ProgramNU</a> <a id="7535" class="Symbol">→</a> <a id="7537" href="Utils.html#1126" class="Datatype">Either</a> <a id="7544" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="7550" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="7557" href="Evaluator.Program.html#7483" class="Function">evalProgramNU</a> <a id="7571" href="Evaluator.Program.html#7571" class="Bound">bm</a> <a id="7574" href="Evaluator.Program.html#7574" class="Bound">namedprog</a> <a id="7584" class="Symbol">=</a> <a id="7586" class="Keyword">do</a>
  <a id="7591" href="Evaluator.Program.html#7591" class="Bound">t</a> <a id="7593" href="Utils.html#2941" class="Field Operator">←</a> <a id="7595" href="Evaluator.Program.html#4390" class="Function">parseUPLC</a> <a id="7605" href="Evaluator.Program.html#7574" class="Bound">namedprog</a>
  <a id="7617" href="Evaluator.Program.html#7132" class="Function">executeUPLC</a> <a id="7629" href="Evaluator.Program.html#7571" class="Bound">bm</a> <a id="7632" href="Evaluator.Program.html#7591" class="Bound">t</a>

<a id="evalProgramN"></a><a id="7635" href="Evaluator.Program.html#7635" class="Function">evalProgramN</a> <a id="7648" class="Symbol">:</a> <a id="7650" href="Evaluator.Program.html#3967" class="Datatype">EvalMode</a> <a id="7659" class="Symbol">→</a> <a id="7661" href="Evaluator.Program.html#2262" class="Postulate">ProgramN</a> <a id="7670" class="Symbol">→</a> <a id="7672" href="Utils.html#1126" class="Datatype">Either</a> <a id="7679" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="7685" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="7692" href="Evaluator.Program.html#7635" class="Function">evalProgramN</a> <a id="7705" href="Evaluator.Program.html#7705" class="Bound">m</a> <a id="7707" href="Evaluator.Program.html#7707" class="Bound">namedprog</a> <a id="7717" class="Symbol">=</a> <a id="7719" class="Keyword">do</a>
  <a id="7724" class="Comment">{-
  -- some debugging code
  prog ← withE (ERROR.scopeError ∘ freeVariableError) $ deBruijnify namedprog
  let shiftedprog = shifter Z (convP prog)
  scopedprog ← withE scopeError $ scopeCheckTm {0}{Z} shiftedprog
  let extricatedprog = extricateScope scopedprog
  let unshiftedprog = unshifter Z extricatedprog
  return (&quot;orginal: &quot; ++ rawPrinter (convP prog) ++ &quot;\n&quot; ++
          &quot;shifted: &quot; ++ rawPrinter shiftedprog ++ &quot;\n&quot; ++
          &quot;instrinsically scoped: &quot; ++ Scoped.ugly scopedprog ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawPrinter extricatedprog ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawPrinter unshiftedprog ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTm unshiftedprog ++ &quot;\n&quot;)
   -}</a>
   <a id="8429" href="Evaluator.Program.html#8429" class="Bound">t</a> <a id="8431" href="Utils.html#2941" class="Field Operator">←</a> <a id="8433" href="Evaluator.Program.html#4084" class="Function">parsePLC</a> <a id="8442" href="Evaluator.Program.html#7707" class="Bound">namedprog</a>
   <a id="8455" href="Evaluator.Program.html#4971" class="Function">executePLC</a> <a id="8466" href="Evaluator.Program.html#7705" class="Bound">m</a> <a id="8468" href="Evaluator.Program.html#8429" class="Bound">t</a>

<a id="typeCheckProgramN"></a><a id="8471" href="Evaluator.Program.html#8471" class="Function">typeCheckProgramN</a> <a id="8489" class="Symbol">:</a> <a id="8491" href="Evaluator.Program.html#2262" class="Postulate">ProgramN</a> <a id="8500" class="Symbol">→</a> <a id="8502" href="Utils.html#1126" class="Datatype">Either</a> <a id="8509" href="Evaluator.Base.html#1242" class="Datatype">ERROR</a> <a id="8515" href="Agda.Builtin.String.html#335" class="Postulate">String</a>
<a id="8522" href="Evaluator.Program.html#8471" class="Function">typeCheckProgramN</a> <a id="8540" href="Evaluator.Program.html#8540" class="Bound">namedprog</a> <a id="8550" class="Symbol">=</a> <a id="8552" class="Keyword">do</a>
  <a id="8557" href="Evaluator.Program.html#8557" class="Bound">t</a> <a id="8559" href="Utils.html#2941" class="Field Operator">←</a> <a id="8561" href="Evaluator.Program.html#4084" class="Function">parsePLC</a> <a id="8570" href="Evaluator.Program.html#8540" class="Bound">namedprog</a>
  <a id="8582" class="Symbol">(</a><a id="8583" href="Evaluator.Program.html#8583" class="Bound">A</a> <a id="8585" href="Evaluator.Program.html#293" class="InductiveConstructor Operator">,,</a> <a id="8588" class="Symbol">_)</a> <a id="8591" href="Utils.html#2941" class="Field Operator">←</a> <a id="8593" href="Utils.html#3700" class="Function">withE</a> <a id="8599" class="Symbol">(λ</a> <a id="8602" href="Evaluator.Program.html#8602" class="Bound">e</a> <a id="8604" class="Symbol">→</a> <a id="8606" href="Evaluator.Base.html#1262" class="InductiveConstructor">typeError</a> <a id="8616" class="Symbol">(</a><a id="8617" href="Evaluator.Base.html#1463" class="Function">uglyTypeError</a> <a id="8631" href="Evaluator.Program.html#8602" class="Bound">e</a><a id="8632" class="Symbol">)</a> <a id="8634" class="Symbol">)</a> <a id="8636" href="Function.Base.html#1928" class="Function Operator">$</a> <a id="8638" href="Evaluator.Program.html#4590" class="Function">typeCheckPLC</a> <a id="8651" href="Evaluator.Program.html#8557" class="Bound">t</a>
<a id="8653" class="Comment">{-
  -- some debugging code
  let extricatedtype = extricateScopeTy (extricateNf⋆ A)
  let unshiftedtype = unshifterTy Z extricatedtype
  return (&quot;original: &quot; ++ &quot;???&quot; ++ &quot;\n&quot; ++
          &quot;extricated: &quot; ++ rawTyPrinter extricatedtype ++ &quot;\n&quot; ++
          &quot;unshifted: &quot; ++ rawTyPrinter unshiftedtype ++ &quot;\n&quot; ++
          &quot;unconved: &quot; ++ prettyPrintTy unshiftedtype ++ &quot;\n&quot;)
 -}</a>
  <a id="9033" href="Utils.html#2913" class="Field">return</a> <a id="9040" class="Symbol">(</a><a id="9041" href="Evaluator.Base.html#768" class="Postulate">prettyPrintTy</a> <a id="9055" class="Symbol">(</a><a id="9056" href="Scoped.html#5195" class="Function">unshifterTy</a> <a id="9068" href="Scoped.html#1441" class="InductiveConstructor">Z</a> <a id="9070" class="Symbol">(</a><a id="9071" href="Scoped.html#10975" class="Function">extricateScopeTy</a> <a id="9088" class="Symbol">(</a><a id="9089" href="Scoped.Extrication.html#1317" class="Function">extricateNf⋆</a> <a id="9102" href="Evaluator.Program.html#8583" class="Bound">A</a><a id="9103" class="Symbol">))))</a>
</pre>

    </section>
  </body>
</html>